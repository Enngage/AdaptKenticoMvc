[{"body":"<h2>Welcome to the Kentico MVC Developer course!</h2>\n<p>The <strong>Kentico MVC for Developers</strong> course is divided into modules, each of which covers different topics.&nbsp;</p>\n<p>The first <strong>Kentico MVC -</strong> <strong>Essentials</strong> module teaches the basics of Kentico MVC development.</p>\n<p>In this course module, you will:</p>\n<ul>\n  <li>Learn the basics of developing websites in Kentico MVC</li>\n  <li>Find out how to define the content structure of your Kentico MVC website&nbsp;</li>\n  <li>Use content-only pages and media libraries to store the content of the website</li>\n  <li>Build a training website using the Kentico API and the repository development pattern</li>\n  <li>Display the content from the database on the live site through the repositories</li>\n  <li>Learn about Kentico recommended practices for optimizing website performance</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":false},"_isOptional":false,"_classes":"","_id":"ca7512b2-58b6-4ff5-a1d5-ff799a669469","_parentId":"b891fa36-aae7-41cd-9d70-ace6d78a0e6b","_type":"component","title":"Introduction to course","displayTitle":"Introduction to course"},{"body":"<h2>About the module</h2>\n<p>Each topic in the module is discussed on a separate page which is split into different parts. You can use&nbsp;<strong>the menu on the right&nbsp;</strong>to navigate on the page.</p>\n<h3>Theory</h3>\n<p>The&nbsp;<strong>top section of the page explains the theory</strong>&nbsp;and&nbsp;<strong>recommends the approach you should take</strong>&nbsp;and&nbsp;<strong>the best practices to follow&nbsp;</strong>when developing your Kentico website. The theory part is closed by a detailed<strong>&nbsp;description of how the Medio Clinic implements&nbsp;</strong>the feature covered<strong>&nbsp;</strong>in the topic. The hyperlinks in the course styled in<em>&nbsp;</em><a href=\"https://github.com/Kentico/training-kentico-k12\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>italics</em></a>&nbsp;point to the sample implementation.</p>\n<h3>Tasks</h3>\n<p>You can get your hands dirty and build your version of the Medio Clinic website using the MVC development pattern by completing&nbsp;<strong>tasks specified in the midsection.</strong></p>\n<h3><strong>Demos</strong></h3>\n<p>If you need to get some guidance,<strong>&nbsp;you can follow the demos&nbsp;</strong>which break Medio Clinic sample code into more manageable chunks and show you&nbsp;<strong>how the feature was implemented.</strong>&nbsp;However, in most cases, you won't be able to just copy-paste the sample snippets into your solution, and you'll have to do some thinking and coding by yourself.</p>\n<h3>Progress-checks</h3>\n<p>The bottom part of the page gives you a chance to<strong>&nbsp;check your understanding of the topics in a few quick quiz questions</strong>.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"c2301f4d-b208-43ac-83a6-c507fcffec80","_parentId":"e0b71ff4-de41-4aaa-8cf4-dcfff0cfaf16","_type":"component","title":"About the module","displayTitle":"About the module"},{"body":"<h2>The Medio Clinic sample website</h2>\n<p>Throughout the course, you will have a chance to practice on a training website. The training website promotes a made-up&nbsp;<em>Medio Clinic</em>.</p>\n<p>The Kentico MVC - Essentials module challenges you to build the basic infrastructure to hold the content of the website and several essential pages - the&nbsp;<em>Home</em>&nbsp;page,&nbsp;<em>Doctors</em>&nbsp;listing and&nbsp;<em>Doctor profile</em>&nbsp;pages, the&nbsp;<em>Contact us</em>&nbsp;page, and a user-friendly&nbsp;<em>error page</em>.</p>\n<p>You can download resources for the website, such as HTML and CSS files, in <a data-asset-id=\"f69142d8-536d-41df-a663-af88a135f911\" href=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/4919d766-ede7-4d49-99b5-fb747f8daa43/MedioClinicStaticAssets.zip\">MedioClinicStaticAssets.zip</a> package. The code of the sample&nbsp;<strong>Medio Clinic</strong>&nbsp;<strong>website&nbsp;</strong>is available on&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>GitHub</em></a>. Feel free to browse through the classes on GitHub or - better - clone the repository and use all the goodies and help that is available in Visual Studio.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"37603b4e-7732-4036-a051-3d222076b946","_parentId":"cea13069-9bf4-4710-8a07-5a4e6abaac2c","_type":"component","title":"Medio Clinic sample website","displayTitle":"Medio Clinic sample website"},{"body":"<h2>Course navigation</h2>\n<p>The course module opens in a separate browser window. To:</p>\n<ul>\n  <li>get to <strong>another part of the page</strong>, use the navigation menu in the top-right corner of each page.</li>\n  <li>return to the&nbsp;<strong>module's home page</strong>, use the&nbsp;<strong>&lt;</strong><em>&nbsp;(back)</em>&nbsp;chevron in the top-left corner of each page.</li>\n  <li>navigate <strong>back to the course material in the browser window</strong>, use keyboard shortcut to go back.</li>\n</ul>\n<p>The module <strong>tracks your progress</strong>, so feel free to close the separate window and come back whenever you have time. You will be able to <strong>continue where you left off</strong>.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"730de684-a838-4248-9324-3fc42453f30b","_parentId":"0659d896-e874-487f-b36f-6a5d0174c332","_type":"component","title":"Navigation","displayTitle":"Navigation"},{"body":"<h2>Certification of completion</h2>\n<p>Only the&nbsp;<strong>Kentico MVC - Essentials module</strong>&nbsp;is compulsory. After completing this module and submitting the survey, you will automatically receive a&nbsp;<strong>certificate of training completion</strong>&nbsp;which you can download to your computer. Additional modules in the course are optional, so feel free to go through them anytime you want.</p>\n<h2>Questions</h2>\n<p>If you have any questions about the course or its contents, contact us at&nbsp;<strong>elearning@kentico.com</strong>.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"27423037-2504-4d1c-b560-865d9aa38f7c","_parentId":"0de900c0-fef4-435b-9531-270b4d0cea3c","_type":"component","title":"Additional information","displayTitle":"Additional information"},{"body":"<p>What you will learn in this section:</p>\n<ul>\n  <li>What <strong>developing websites using the Kentico MVC development model </strong>looks like and how it works in general</li>\n  <li>Which options for <strong>storing data </strong>Kentico provides</li>\n  <li>Which options website managers can use <strong>to edit the content </strong>of their website</li>\n  <li>What the <strong>requirements</strong> are for <strong>Kentico MVC installation</strong></li>\n  <li>Which actions Kentico Installer performs</li>\n  <li>About the <strong>Medio Clinic website</strong> you are going to build in the course</li>\n</ul>\n<p>You will work on:</p>\n<ul>\n  <li>Getting your development machine ready</li>\n  <li>Installing the Medio Clinic training website using the Kentico MVC development model</li>\n  <li>Configuring the website's presentation properties</li>\n  <li>Adding a license key</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":false},"_isOptional":false,"_classes":"","_id":"8ce46903-e420-4e29-8599-c430371c49bb","_parentId":"a7385982-95f7-4824-96a6-bf93ab61e3c7","_type":"component","title":"Introduction","displayTitle":"Introduction"},{"_setCompletionOn":"play","_useClosedCaptions":true,"_allowFullScreen":true,"_media":{"mp4":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/f7cda524-d687-4cc0-a574-c3ae070cd26b/mvc-overview-of-kentico-architecture.mp4","poster":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/ff85ae81-5800-4a86-bd2f-5bbe025a7c7b/mvc-vid-overview-of-mvc-development.png","cc":{"srclang":"en","src":null}},"_transcript":{"_setCompletionOnView":true,"_inlineTranscript":true,"_externalTranscript":false,"inlineTranscriptButton":"Transcript","InlineTranscriptCloseButton":"Close Transcript","inlineTranscriptBody":"<h1>Overview of Kentico MVC Architecture</h1>\n<p>Hello and welcome to a short overview of how the development of MVC websites work in Kentico.</p>\n<p>Kentico MVC websites use two separate web applications.&nbsp;</p>\n<p>The MVC application displays the live site and the Kentico application provides the administration interface.</p>\n<p>The MVC application runs on the standard ASP.NET MVC 5 framework.&nbsp;</p>\n<p>Kentico serves as a content repository and provides a simple and easy to understand administration interface that empowers content editors and online marketers with a long list of functionality for editing content or running online marketing activities.</p>\n<p>The administration interface of the Kentico application is built on ASP.NET Web Forms, and can be widely customized and made to fit almost any user scenario.</p>\n<p>Both applications run on their own URLs and but they share the same database.&nbsp;</p>\n<p>Website editors create and manage the content in the Kentico application which is displayed on the live site through the Kentico API.&nbsp;</p>\n<p>The Kentico API is integrated into the MVC application as NuGet packages and its libraries provide an extensive functionality for a large number of client scenarios.</p>\n<p>Ranging from small, single-purpose microsites for marketing campaigns over medium-size business websites with e-stores all the way up to large-scale portals with large teams of editors working on different continents and with millions of website visitors from different cultures.</p>\n<p>Any change to the live site or in the admin interface is automatically synchronized, as both applications are running in a web farm.</p>\n<p>It is the shared database and the Kentico API that allow both applications to work as a web farm and ensure that changes in one of the applications are immediately reflected in the other.</p>\n<p>The synchronization options cover various types of data, including cached database content, settings of the site or individual objects, or uploaded files.</p>\n<p>When a web editor changes the text of a page in the admin interface, the data is stored in the database.</p>\n<p>Then the Kentico application initiates a synchronization task and triggers a task for the MVC application.</p>\n<p>The MVC application runs the task and invalidates the matching data in its cache.</p>\n<p>When a website's visitor requests the content that has been updated the MVC application retrieves the updated content from the database and serves it on the live site.</p>\n<p>As editing of the content takes place in a separate application, the content which an editor updates doesn't need to be immediately promoted to the live site.</p>\n<p>It can pass through complex content workflows which help large editor teams to ensure that only approved content is displayed to the website's audience.</p>\n<p>In summary, when developers build a website in Kentico MVC solution, they prepare two applications the front-facing MVC application and the administration interface, which both share the same database.</p>"},"_playerOptions":{"features":["playpause","progress","current","duration","speed","volume","fullscreen"]},"instruction":"","_layout":"full","_component":"media","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"a36a840a-e901-46e8-ae04-28cdb5734639","_parentId":"5b9b499e-2d19-4405-9d3c-4606736fede6","_type":"component","title":"Overview of Kentico MVC Development","displayTitle":"Overview of Kentico MVC Development"},{"_setCompletionOn":"play","_useClosedCaptions":true,"_allowFullScreen":true,"_media":{"mp4":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/61fcc34e-3cbb-4a23-ab6b-3456bbf2875c/Ways%20to%20store%20data.mp4","poster":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/86b910ee-fa88-46d5-b87c-789a0fe6b4ad/mvc-ways-to-store-data-loading-image.png","cc":{"srclang":"en","src":null}},"_transcript":{"_setCompletionOnView":true,"_inlineTranscript":true,"_externalTranscript":false,"inlineTranscriptButton":"Transcript","InlineTranscriptCloseButton":"Close Transcript","inlineTranscriptBody":"<h1>Ways to store data in Kentico</h1>\n<p>Hi there. In this video, we are going to look at ways you can use to store content in Kentico. The content editors add the content in the administration interface which stores the data in a shared database. The data is then retrieved via the Kentico API to the live site running as a separate MVC application.&nbsp;</p>\n<p>However, pages are only one of the approaches you can use.&nbsp;Before you start defining your website architecture,&nbsp;let's see what options Kentico provides for storing the website's data.</p>\n<p>Besides already mentioned pages, you can use module classes, custom tables, and media libraries.</p>\n<p>Pages are the most common way to store data on websites.&nbsp;Editors&nbsp;can also add files to pages as attachments. One of the benefits of storing data in pages is that you can display them in a visual hierarchy in the content tree.</p>\n<p>Seeing pages in hierarchy helps content editors, as they can quickly navigate around and easily pick the content they want to manage.&nbsp;</p>\n<p>Storing content in pages also allows you to configure access permissions for editors down to individual pages, and define detailed reviewing and approval processes using workflows. Lastly, you can use pages to store content in different languages and manage translations.&nbsp;</p>\n<p>The second option is to use custom module classes.&nbsp;Custom module classes allow you to store large amounts of content. They are extremely helpful when you need to access the stored data in the admin interface, but don't want to display it in the visual hierarchy of the content tree.</p>\n<p>For example, you can use custom module classes&nbsp;when you want to create a specialized interface within the admin UI through which the editors will add and manage data.</p>\n<p>Custom module classes also provide the best options if you need to model relationships between different types of data or integrate advanced custom functionality. So, that's custom module classes.</p>\n<p>The third option to store a large amount of data is to use custom tables. Custom tables allow you to create your custom database tables and manage their content directly from the administration interface without using any specialized database management tool. They come in handy when you need to store a large amount of data in a flat structure.&nbsp;</p>\n<p>Content editors can access the data stored in custom tables from the administration interface,&nbsp;but this data will not be displayed in a visual hierarchy as pages in the content tree.&nbsp;</p>\n<p>So when to use custom module classes, and when the custom tables? Well,&nbsp;it depends on the use case.&nbsp;</p>\n<p>If you need editors to add records&nbsp;through a custom-built user interface within Kentico, use custom module classes.&nbsp;</p>\n<p>And if your editors just need to add or update the data in a simple, table-like interface, use custom tables.&nbsp;</p>\n<p>The last available option for storing data are media libraries. Media libraries are designed to store large files, such as images, videos or packaged files. You can also use them to store your files externally and distribute them through CDNs. You will learn about media libraries and how to work with them later in the course.</p>\n<p>These are the four options you can use to store data in Kentico.&nbsp;Analyze your project requirements and decide which option fits best your client's needs.</p>\n<p>Either you decide to use the hierarchy of pages, store large files in media libraries, extend functionality with custom module classes&nbsp;or store a flat data structure in custom tables, make certain you understand how and when you can use them. This will make sure you pick the best option for your client's needs.</p>"},"_playerOptions":{"features":["playpause","progress","current","duration","speed","volume","fullscreen"]},"instruction":"","_layout":"full","_component":"media","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"17834fc6-9471-40ba-ae3e-9eb6947a09f4","_parentId":"fcf91950-497b-4de8-bb25-d43df578392c","_type":"component","title":"Ways to store data in Kentico","displayTitle":"Ways to store data in Kentico"},{"_setCompletionOn":"play","_useClosedCaptions":true,"_allowFullScreen":true,"_media":{"mp4":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/99d3b344-ffcf-418b-b817-b41948b36fb8/mvc-editing-content-in-kentico-mvc.mp4","poster":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/810fe2b7-367a-4754-addd-a980801e352a/mvc-editing-content-loading-page.png","cc":{"srclang":"en","src":null}},"_transcript":{"_setCompletionOnView":true,"_inlineTranscript":true,"_externalTranscript":false,"inlineTranscriptButton":"Transcript","InlineTranscriptCloseButton":"Close Transcript","inlineTranscriptBody":"<h1>Editing content in Kentico</h1>\n<p>Hello there. In this video, we'll look at two approaches editors can use to add and manage the content on Kentico MVC websites.</p>\n<p>As a developer, you need to build the website so it continues to appeal to the audience, and at the same time, provides a consistent look and predictable experience.</p>\n<p>This is can be easily achieved by strictly limiting editors so that they can work only with content without any option to influence how the content looks on the live site.</p>\n<p>On the other hand, there are situations in which you'd want to empower the editor with more control over the content and the layout of the website.</p>\n<p>The question is, how can you provide an experience to fit both? With Kentico MVC, editors can manage content in the Administration interface as highly structured content, and through the Kentico page builder.</p>\n<p>Structured content allows editors to focus only on the quality of their content. Developers prepare the structure for collecting the content. They define exactly what type of content, like headlines, body copy, images or file attachments each page will store and create the markup which displays the content in the live site application in a unified way.</p>\n<p>Structured content works best for pages with a repeated layout across the website, where the focus is on the provided information rather than on first grabbing attention and then providing information later.</p>\n<p>Typically, you will use structured content with articles, product pages or pages which don't personalize their content depending on who is viewing them, like the About page or Contact page.</p>\n<p>In some situations, content editors need to personalize the page experience to fit the audience, and that's when the Kentico page builder comes in handy.</p>\n<p>The page builder provides a user-friendly interface which allows even non-technical users to create and adjust the position of the content.</p>\n<p>A developer prepares pages which contain editable areas, as well as the components that can be added and content editors select the look they want their page to have, adjust it a bit if needed and populate it with exactly the types of content in exactly the locations on the page they have identified to achieve their goals.</p>\n<p>Typically, you will use the page builder on pages where you want to adjust the layout and content elements to fit the message, such as campaign landing pages.</p>\n<p>It's also great for pages that receive the highest amount of traffic, such as the Homepage where editors or marketers want to frequently adjust messaging to fit the company's current marketing goals.&nbsp;</p>\n<p>Both options have their place on MVC websites. As always, define your website architecture so that it best meets your client needs.</p>"},"_playerOptions":{"features":["playpause","progress","current","duration","speed","volume","fullscreen"]},"instruction":"","_layout":"full","_component":"media","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"d36d0a0d-97ba-45d0-8a74-ef93f6d67fdc","_parentId":"6cc0bfda-9601-46d3-a402-e1c9a4ab48d0","_type":"component","title":"Editing content in Kentico MVC","displayTitle":"Editing content in Kentico MVC"},{"body":"<p><strong>Kentico Installer</strong>&nbsp;performs a number of operations. Here is a list of the most important ones that you as a developer should be aware of.</p>","_items":[{"body":"<p>The installer installs any of the features from the <a href=\"https://docs.kentico.com/k12/installation/system-requirements\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">requirements</a>&nbsp;missing on the machine, e.g., the required version of the .NET Framework.</p>","title":"Installs missing features","_graphic":null},{"body":"<p>The installer creates&nbsp;<strong>project</strong>&nbsp;<strong>files</strong>&nbsp;for the&nbsp;<strong>MVC live site</strong>&nbsp;and&nbsp;<strong>Kentico administration</strong>, and configures their&nbsp;<strong>shared features</strong>:</p>\n<ul>\n  <li>Sets their&nbsp;<em>connection strings</em>&nbsp;to target the shared database.</li>\n  <li>Sets the same&nbsp;<em>hash salt&nbsp;</em>value, so both apps generate matching hashes for various security functions. This is important for features like the&nbsp;<em>Preview</em>&nbsp;mode or macros within the administration application.</li>\n</ul>","title":"Creates project files","_graphic":null},{"body":"<h3>Kentico.AspNet.Mvc</h3>\n<p>The package contains all items that your MVC application needs to work with the connected Kentico application. Installation adds various assemblies which allow you to use features, such as:</p>\n<ul>\n  <li>Retrieving content from pages or media libraries, or setting the system to allow your editors to preview pages in the administration interface (<em>Kentico.Content.Web.Mvc</em>).</li>\n  <li>Creating on-line forms or working with the page builder (<em>Kentico.FormBuilder.Mvc</em> and <em>Kentico.PageBuilder.Mvc</em>)</li>\n  <li>Working with users on the live site (<em>Kentico.Membership</em>)</li>\n</ul>\n<div class=\"infobox note\"><p>Make sure that the version of the installed Kentico.AspNet.Mvc package matches the exact version of your Kentico installation. For example, if you are using hotfixed Kentico 12.0.5, you need to use version 12.0.5 of the Kentico.AspNet.Mvc package.</p></div>\n<h3>Kentico.Libraries</h3>\n<p>The package contains all assemblies that you need to work with Kentico in an external application. The installer also installs other third-party libraries that are required by the Kentico API.</p>\n<h3>Kentico.LanguagePack.English</h3>\n<p>The package contains files necessary for the English localization that are required by the Kentico application and API</p>","title":"Prepares required NuGet packages","_graphic":null},{"body":"<p>The installed MVC project automatically contains the&nbsp;<em>routes.Kentico().MapRoutes()</em>&nbsp;method in the&nbsp;<em>RouteConfig.cs</em>&nbsp;file. The extension method maps routes for Kentico HTTP handlers (e.g. used to serve image URLs) and various other features that can optionally be enabled (such as the page builder or activity tracking).</p>\n<p>MVC projects created by the installer also contain the <em>ApplicationConfig</em> class, whose <em>RegisterFeatures</em> method is called in the <em>Application_Start</em> method of the <em>Global.asax</em> file. &nbsp;You can use this class to encapsulate code that enables and configures Kentico MVC features (via an instance of the <em>ApplicationBuilder</em> class).</p>\n<p>You need to enable optional MVC features before you call the <em>Kentico().MapRoutes()</em>&nbsp;method, because it adds required routes based on the currently enabled feature set. That's why the default code in the <em>Application_Start</em> method calls <em>ApplicationConfig.RegisterFeatures</em> before <em>RouteConfig.RegisterRoutes</em>.</p>","title":"Prepares routes for Kentico HTTP handlers and features","_graphic":null},{"body":"<p>The MVC project's <em>AssemblyInfo.cs</em> file contains the <strong>[assembly: AssemblyDiscoverable]</strong> attribute, which allows the Kentico application code to detect various types of registered classes during initialization.</p>","title":"Enables class discovery","_graphic":null},{"body":"<h3>Creates a content-only site</h3>\n<p>Setting the site as content-only influences the site's behavior on a system level.&nbsp;For example, the Kentico application automatically hides some features in the admin interface that editors of content-only pages aren't able to use. E.g., in the&nbsp;<em>Pages</em>&nbsp;application, the editors will not see Portal Engine features, such as the&nbsp;<em>Design</em>&nbsp;tab or the&nbsp;<em>Page templates</em>&nbsp;tab in the page properties.&nbsp;</p>\n<p>Note: If you want to run multiple sites on one Kentico instance, we do&nbsp;<strong>not recommend mixing Portal Engine sites</strong>&nbsp;which are based on&nbsp;<em>ASP.NET Web Forms</em>&nbsp;and<strong>&nbsp;content-only sites</strong>&nbsp;based on the&nbsp;<em>ASP.NET MVC</em>&nbsp;development model.</p>\n<h3>Enables automatic web farm mode in the instance's settings</h3>\n<p>This allows for automatic, two-way synchronization of content, cache, and settings between the live site and the Kentico application.</p>","title":"Installs the database shared by both applications","_graphic":null},{"body":"<p>If you decide to register the applications during installation, the installer creates&nbsp;<em>two separate virtual applications</em>&nbsp;and&nbsp;<em>sets their aliases</em>. The naming conventions follow a simple pattern:</p>\n<ul>\n  <li><em>Live site MVC application:</em>&nbsp;&lt;project folder&gt;_&lt;site name&gt;, e.g.,&nbsp;<em>MedioClinic_MedioClinic</em></li>\n  <li><em>Kentico application:</em>&nbsp;&lt;project folder&gt;_Admin, e.g.,&nbsp;<em>MedioClinic_Admin</em></li>\n</ul>\n<div class=\"infobox note\"><p>During development, we recommend that you keep the applications running in two separate virtual directories on the same domain. When deploying the website live, you can choose the hosting approach depending on your company's deployment preference.</p></div>","title":"(Optional) Registers both applications to IIS","_graphic":null},{"body":"<p>The installer automatically sets the&nbsp;<strong>Presentation URL</strong>&nbsp;of the site in Kentico according to the alias of the MVC live site application in IIS, e.g.,&nbsp;<a href=\"http://localhost/Kentico12_MedioClinic/\"><em>http://localhost/Kentico12_MedioClinic/</em></a><em>. </em>This allows website editors to access the live site directly in the <em>Pages </em>application, create hyperlinks in the text editor, or preview what the content of their pages will look like when it's published.</p>","title":"Sets the Presentation URL","_graphic":null}],"instruction":"","_layout":"full","_component":"accordion","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"120304da-d130-4058-9c8b-45a73ce3cac5","_parentId":"787ae0d7-4412-4184-8831-5253df8f1497","_type":"component","title":"What happens during the Kentico MVC installation","displayTitle":"What happens during the Kentico MVC installation?"},{"body":"<p>Kentico MVC uses two separate applications to present and administer a single website. The applications can either run on a single domain or on different domains.&nbsp;In both cases, the applications need to have valid licenses. When using different domains, you need to purchase only one license for the MVC application. The additional license for the administration interface comes for free.</p>\n<p>Let's have a look at some licensing scenarios using the MEDIO Clinic website.</p>\n<table><tbody>\n  <tr><td>IIS Server setup</td><td>URLs</td><td>License explained</td></tr>\n  <tr><td>2 IIS websites on different domains</td><td>Medio Clinic administration: https://admin.medioclinic.com<br>\nMedio Clinic live site: https://medioclinic.com</td><td>You run your applications on different domains, but you need to only purchase 1 license for the MEDIO Clinic live site, the license for the administration domain is provided for free.</td></tr>\n  <tr><td>1 IIS web site on a single domain. MVC application running in the site root, administration application running in a virtual directory.</td><td>Medio Clinic administration: https://medioclinic.com/admin<br>\nMedio Clinic live site: https://medioclinic.com</td><td>You purchase 1 license for the shared domain.</td></tr>\n</tbody></table>\n<h2>How does licensing work for web farm servers?</h2>\n<p>Kentico synchronizes the applications using a web farm, and this implementation is covered by the licensing automatically. Every Kentico MVC license also covers one additional web farm server. The automatic web farm licensing will suffice for standard scenarios. You only need a license with additional web farm servers if you need to run multiple load-balanced instances of the same MVC site.</p>\n<p>See <a href=\"https://docs.kentico.com/k12/configuring-kentico/managing-sites/managing-site-licenses/kentico-licensing-for-mvc-applications\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico MVC licensing</a> in our documentation for other scenarios and additional web farm purchase options. You can also find more information about <a href=\"https://docs.kentico.com/k12/configuring-kentico/setting-up-web-farms\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">how web farms work</a> in Kentico documentation.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"0aa3adcf-0477-40e4-9a12-6bfce54c8c0a","_parentId":"bc4e863d-800c-4175-b940-b550be61eae0","_type":"component","title":"MVC Licensing","displayTitle":"MVC Licensing"},{"body":"<p>Kentico provides an API that allows you to retrieve data from the system, as well as create or modify pages, users, workflows, and any other entities. In the case of MVC projects, the API is integrated through NuGet packages. Understanding the Kentico API is crucial when developing MVC websites, because you will need to use it in your site's code when implementing even the most basic scenarios.</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"Info classes","body":"<p>All entities in Kentico are represented as objects, which have a corresponding <em>Info</em> class in the Kentico API. Info classes define the properties of specific types of objects in the system, and reflect the columns of the database table used to store the given objects. A single instance of an Info class holds the data of one specific object and represents exactly one row in the database table.</p>\n<p>For most Kentico objects, such as contacts, cultures, consents or workflows, the naming convention for the corresponding Info class is <strong>&lt;object name&gt;</strong><em>Info</em>. For example <em>ContactInfo</em>, <em>CultureInfo</em>, <em>ConsentInfo</em>, <em>WorkflowInfo</em>, etc.&nbsp;</p>\n<p>Pages are a special case and are represented by the <em>TreeNode</em> class instead. When working with pages of a specific type, you will often use a custom generated class that inherits from <em>TreeNode</em>, such as <em>Home</em> or <em>Article</em>.</p>","code":{"src":"// Gets the current contact\nContactInfo currentContact = ContactManagementContext.GetCurrentContact();\n \n// Gets values from the contact's properties\nstring contactName = currentContact.ContactLastName;\nstring contactJobTitle = currentContact.ContactJobTitle;","lang":"csharp"},"strapline":"Info classes"},{"title":"InfoProvider classes","body":"<p>To work with data, the Kentico API supplies <em>InfoProvider</em> classes. An InfoProvider class usually serves as a counterpart to an object's Info class and provides methods for managing objects of the given type. This includes basic operations such as reading, inserting, updating and deleting, or more advanced actions that are relevant for the given object type.&nbsp;</p>\n<p>For most Kentico objects, the naming convention for the provider classes is <strong>&lt;object name&gt;</strong><em>InfoProvider</em>. For example <em>ContactInfoProvider</em>, <em>CultureInfoProvider</em>, <em>WorkflowInfoProvider</em>, etc.</p>\n<p>Again, pages are an exception and management is provided by the <em>DocumentHelper</em> or <em>TreeProvider</em> classes. For pages of a specific type, you will typically work with generated provider classes that return strongly-type data, such as <em>HomeProvider</em> or <em>ArticleProvider</em>.</p>","code":{"src":"// Gets a collection of objects representing article pages using a generated provider\nIEnumerable<Article> articles = ArticleProvider.GetArticles()\n    .OnSite(\"MySite\")\n    .Culture(\"en-US\")\n    .Path(\"/Articles/\", PathTypeEnum.Children);","lang":"csharp"},"strapline":"InfoProvider classes"},{"title":"Services","body":"<p>In addition to providers, certain operations in the Kentico API are performed using a service model. Typically, services are used for higher-level business scenarios, such as logging activities, handling newsletter subscriptions, managing shopping cart content, working with consent agreements, and more.</p>\n<p>Each service is represented by an interface, for which the Kentico API provides a default implementation. You work with the service by getting an instance of the service class and calling its methods.</p>\n<p>An advantage of the service model is that you can register the services into dependency injection containers that you use within your project. Services can also easily be integrated into automated tests, and provide customization options by allowing you to register your own implementations of the available interfaces.</p>","code":{"src":"// Gets an instance of the shopping service used to manage the current shopping cart\nIShoppingService shoppingService = Service.Resolve<IShoppingService>();\n \n// Removes all products from the current shopping cart\nshoppingService.RemoveAllItemsFromCart();","lang":"csharp"},"strapline":"Services"}],"instruction":"","_layout":"full","_component":"narrativeCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"794cb438-0eff-4dba-83df-973fdd23fef7","_parentId":"0b70bacc-eaa5-450e-9540-8f09a28ccc8f","_type":"component","title":"Kentico API Basics","displayTitle":"Kentico API Basics"},{"body":"<p>The Kentico database structure is easy to grasp. Tables, views, and other database objects use a naming convention that consists of a <strong>prefix</strong>, followed by the name of the <strong>object</strong> (User, Culture, Contact, Customer, etc.). The prefix represents the general type of functionality to which the data is related, such as CMS, OM or COM. Examples of full table names are <em>CMS_User</em>, <em>OM_Contact </em>or <em>COM_Customer</em>.</p>\n<div class=\"infobox note\"><p>We recommend that you use your own naming convention for any custom database tables or objects. For example, this is relevant when naming the database table used to store the data of your site's page types. Avoid the default Kentico prefixes and instead add a unique prefix based on your project or company name, e.g., <em>KNTC_&lt;table_name&gt;</em>.</p>\n<p>Keeping the default Kentico objects separate from your custom objects will help prevent system collisions when hotfxing or upgrading your instance to newer versions.&nbsp;Find out about our other <a href=\"https://docs.kentico.com/k12/custom-development/best-practices-for-customization\">best practices for customization</a> in the Kentico documentation.</p></div>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"662e2314-4fe8-4002-b049-759aa88cafd9","_parentId":"0b70bacc-eaa5-450e-9540-8f09a28ccc8f","_type":"component","title":"Underlying data structure","displayTitle":"Underlying data structure"},{"body":"<p>Medio Clinic is a training website with&nbsp;only a small amount of content and data. However, to make tasks in the course and your work with the website as useful as possible, we built the sample implementation using patterns suitable for a much larger, enterprise-level website. Therefore, the training site attempts to demo logic and functionality you'd need for a website which stores, manipulates and displays a much larger volume and variety of data.</p>\n<p>The MVC model, as well as web development in general, provide almost an unlimited set of options you can use to solve problems. Keep in mind that the approach we took with the Medio Clinic is one of many, and most of the functionality may be implemented in a different way. On the other hand, the examples follow best practices held in the MVC community.</p>\n<p>The website consists of two Visual Studio solutions:</p>\n<ul>\n  <li><em>WebApp.sln</em> includes the files of the Kentico administration project, stored in&nbsp;<em>/CMS</em>&nbsp;folder and using assemblies from the <em>/Lib</em> folder,</li>\n  <li><em>MedioClinic.sln</em> includes files used in the implementation of the Medio Clinic website, stored in the <em>/MedioClinic</em> and <em>/Business</em> folders.</li>\n</ul>\n<p>When building MVC websites, you will not need to work with the administration solution unless you wish to customize or extend the default functionality or interface (this subject is covered in the <strong>Advanced Developer</strong>&nbsp;course). The current course focuses on the Medio Clinic solution, which contains the implementation of the MVC website.</p>\n<h2>Medio Clinic</h2>\n<p>We recommend getting familiar with the general patterns used to build the sample Medio Clinic website. This will help you understand and complete tasks in later parts of the course, which will focus on implementing specific features and content on the website.</p>\n<p>You can investigate the training website's code files in this&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12\">GitHub repository</a>.</p>\n<p>Here is a short overview:</p>\n<ul>\n  <li>The website's code is split into two projects (assemblies): the MVC web application itself (<strong>MedioClinic</strong>) and an assembly containing business logic (<strong>Business</strong>).&nbsp;</li>\n  <li>The code uses a layer of custom <strong>repositories</strong> and <strong>services</strong> that encapsulate the Kentico API. This abstraction is useful for multiple reasons, such as better support for automated testing and the overall maintenance of code. It also limits the number of locations that directly call the Kentico API and makes it easier to deal with changes in the API when upgrading to newer versions.</li>\n  <li>The <a href=\"https://autofaccn.readthedocs.io/en/latest/integration/mvc.html\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Autofac dependency injection container</a> is used to instantiate services, repositories and other interface implementations (both for the custom-built classes and ones from the Kentico API).</li>\n</ul>\n<h3>MedioClinic project</h3>\n<p>The project is a standard MVC web application.</p>\n<ul>\n  <li>Project follows the standard MVC best practices and structures the classes into controllers, models, views, configuration files, startup logic, etc.</li>\n  <li>Contains all front-end design files and content items required for the website (stylesheets, scripts, images, resource files).</li>\n  <li>Integration with the Kentico API is provided by the installed <strong>Kentico.AspNet.Mvc</strong> NuGet package.</li>\n</ul>\n<h3>Business project</h3>\n<p>Enterprise-level applications usually require separation of business logic from the web application code. This makes it easier to maintain, distribute, and potentially reuse your code.</p>\n<ul>\n  <li>Contains custom&nbsp;<strong>Services</strong>&nbsp;and&nbsp;<strong>Repositories</strong>, which use the Kentico API to retrieve data and perform other required actions.</li>\n  <li>The <strong>Dto</strong> folder stores <a href=\"https://en.wikipedia.org/wiki/Data_transfer_object\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">data transfer objects</a> used within the project. The Dto classes represent Kentico pages and objects, but carry only the minimum required data. For example, they are used within the properties of model classes that transfer data to the website's views.</li>\n  <li>The <strong>Extensions</strong>&nbsp;and&nbsp;<strong>Models</strong>&nbsp;folders store custom extension methods and classes that wrap the Kentico API. For example, instead of directly calling the Kentico API to localize resource strings, you call the custom <em>Localize</em> method within views. If the Kentico API changes in future versions, you just need to update your custom <em>Localize</em> method, not all occurrences of code that localize resource strings.</li>\n  <li>The <strong>DependencyInjection</strong>&nbsp;folder contains classes that register services into the Autofac dependency injection container (these are used in the startup logic of the MVC web application). For detailed information about registering services from the Kentico API, see our <a href=\"https://docs.kentico.com/k12/developing-websites/initializing-kentico-services-with-dependency-injection\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">documentation</a>.</li>\n  <li>The <strong>Generated</strong> folder contains generated classes for managing the Page types used on the website.</li>\n  <li>The Kentico API is integrated through the <strong>Kentico.Libraries</strong> NuGet package (this project is only a code library, so the full <em>Kentico.AspNet.Mvc</em> package is not required).</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"f27815a9-a0be-47c2-bf87-d9cd2eab7e82","_parentId":"eb346380-3f46-4518-bc3e-a2d522fbf60c","_type":"component","title":"Medio Clinic implementation overview","displayTitle":"Medio Clinic implementation overview"},{"body":"<p>To get the most from the course, you will be building a simple website for our imaginary Medio clinic. You need to get your dev machine ready and install your local copy of Kentico.</p>\n<p>Make sure the following statements are true for your dev machine:</p>\n<ul>\n  <li>Kentico 12 Administration application and Kentico MVC live site project run on your dev machine</li>\n  <li>The Admin app's codename is set to&nbsp;MedioClinic</li>\n  <li>The Kentico installation contains correct licenses.</li>\n  <li>The URL of the Medio clinic live site is set to&nbsp;<a href=\"http://localhost/MedioClinic,\">http://localhost/Kentico12_MedioClinic,</a>&nbsp;</li>\n  <li>The URL for the administration application is set to&nbsp;<a href=\"http://localhost/admin.MedioClinic\">http://localhost/Kentico12_Admin</a></li>\n  <li>You have installed Visual Studio 2017</li>\n</ul>\n<p>Feel free to download the Kentico Installer <a href=\"http://download.kentico.com/Kentico_12_0.exe\">Kentico_12_0.exe</a> and the <a data-asset-id=\"664e04d2-5c85-4a21-a490-5b4bb0297d18\" href=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/5f15fd92-0a10-4fa3-b346-918bd42c8574/K12CourseLicense.zip\">course license</a>.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"c95dc549-0ea6-48c6-ad6f-1668c90c4348","_parentId":"ea7c29fd-839c-4ed3-a77e-7e0794c48428","_type":"component","title":"Task: Getting your machine ready for the course","displayTitle":"Task: Getting your machine ready for the course"},{"body":"<p>Before starting the course, make sure your machine matches&nbsp;<a href=\"https://docs.kentico.com/k12/installation/system-requirements\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">requirements</a>&nbsp;to develop MVC websites in Kentico. <em>Kentico Installer</em> is capable of downloading and installing required components, however, we recommend that you have the following installed and set before you run Kentico Installer.</p>\n<ul>\n  <li>IIS. See our documentation for the IIS&nbsp;<a href=\"https://docs.kentico.com/k12/installation/system-requirements\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">requirements</a>&nbsp;depending on your dev machine system and additional&nbsp;<a href=\"https://docs.kentico.com/k12/installation/system-requirements/configuring-iis-for-the-installation-of-kentico\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">configuration</a>.</li>\n  <li><a href=\"https://www.visualstudio.com/downloads/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Visual Studio 2017</a>&nbsp;(or similar IDE that supports ASP.NET MVC 5 development, such as JetBrains&nbsp;<a href=\"https://www.jetbrains.com/rider\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Rider</a>)&nbsp;with the&nbsp;<a href=\"https://github.com/dotnet/roslyn\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Roslyn&nbsp;</a>.NET compiler.</li>\n  <li>Microsoft SQL Server (2017) or the free&nbsp;<a href=\"https://www.microsoft.com/en-us/sql-server/sql-server-editions-express\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">SQL Server Express Edition</a>, with a&nbsp;<strong>case-insensitive&nbsp;</strong><a href=\"https://docs.microsoft.com/en-us/sql/relational-databases/collations/collation-and-unicode-support?view=sql-server-2017\">collation</a>. (The 2017 version is required if you want to restore the database of the demo website and use it for reference.)</li>\n  <li><a href=\"https://docs.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-2017\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">SQL Server Management Studio</a></li>\n  <li><a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=49981\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">.NET Framework 4.6.1</a>&nbsp;(or newer)</li>\n</ul>\n<p>When you have set your system, <a href=\"http://download.kentico.com/Kentico_12_0.exe\">download</a> and run the <em>Kentico12_0.exe</em> file which opens&nbsp;<strong>Kentico Installer</strong>.</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"Welcome to Kentico Installer","body":"<p>Click Next in the Welcome to Kentico Installer window. In the second step, select your country, and accept the license conditions.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/5b534a16-f176-40f9-9253-af1fcaee35ff/K12-KenticoInstaller1.png","alt":"K12-KenticoInstaller1.png"},"strapline":"Welcome to Kentico Installer"},{"title":"Selecting installation type","body":"<p>In the Installation step, select the&nbsp;<strong>Custom</strong>&nbsp;<strong>installation&nbsp;</strong>option<strong>.</strong>&nbsp;</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/71fb99f4-0124-43d4-91a6-21a11c70c3ba/K12-KenticoInstaller2.png","alt":"K12-KenticoInstaller2.png"},"strapline":"Selecting installation type"},{"title":"Program files","body":"<p>In the following step, confirm the location where your setup files will be installed. If you have already installed Kentico 12, e.g., for evaluation purposes, this step will not appear.&nbsp;</p>\n<p>For the purpose of this course, we recommend using the default option, e.g, <em>C:\\Program Files\\Kentico\\12.0\\</em></p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/1dd6e85d-3dd9-4c86-b4fa-18726b31db23/K12-KenticoInstaller3.png","alt":"K12-KenticoInstaller3.png"},"strapline":"Program files"},{"title":"Development model","body":"<p>In the <strong>Development model </strong>step, leave the selected <strong>MVC </strong>option.&nbsp;This will install two projects on your machine -&nbsp;an MVC project you will use to develop the live site application and a Kentico project that provides an interface for editing content and website administration. This is the configuration we recommend for developing MVC websites in Kentico.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/9a80c7d5-0236-4a80-bbe9-d87eaa8a42c9/K12-KenticoInstaller4.png","alt":"K12-KenticoInstaller4.png"},"strapline":"Development model"},{"title":"Installation type","body":"<p>In the Installation type, we recommend using the following configuration for the training course:</p>\n<ul>\n  <li><strong>Target location:</strong>\n    <ul>\n      <li><strong>Register to IIS</strong>: enabled</li>\n      <li><strong>Location of project files</strong>: Leave the default value of installation, e.g., <em>C:\\inetpub\\wwwroot\\Kentico12</em>.</li>\n    </ul>\n  </li>\n  <li><strong>Site</strong>\n    <ul>\n      <li><strong>New Site</strong></li>\n      <li><strong>Name</strong>: MedioClinic</li>\n    </ul>\n  </li>\n</ul>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/c4003738-64d6-409a-90c2-e410f2c76e95/K12-KenticoInstaller.png","alt":"K12-KenticoInstaller.png"},"strapline":"Installation type"},{"title":"Database step","body":"<p>In the Database step, install the project with the database and confirm you have access to SQL server.</p>\n<p>Specify the following values according to your SQL server's name and authentication options, e.g.,&nbsp;</p>\n<ul>\n  <li><strong>SQL Server</strong> name: To find the name of your SQL server installation, open the SQL Server Management Studio. Select the root folder, click Properties. The name displays in the first row.</li>\n  <li><strong>Database</strong> name: Fill in the name for the new database, e.g., MedioClinic</li>\n</ul>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/3a4e965e-3cfb-4ff7-b145-4664461f4453/K12-KenticoInstaller6.png","alt":"K12-KenticoInstaller6.png"},"strapline":"Database step"},{"title":"Completing the installation","body":"<p>In the next step, do not select any of the health monitoring or Windows service options, and click Next to get to the last tab, where you can decide to become a part of Kentico Improvement program.</p>\n<p>When you click the <strong>Install</strong> button, Kentico Installer creates project files for the MVC project and Kentico application.</p>\n<p>Depending on your browser settings, Kentico Installer opens a browser tab or a window with <strong>Kentico Tutorial</strong>, a quick, step-by-step <a href=\"https://docs.kentico.com/k12tutorial\">start guide</a> that introduces Kentico Portal Engine and MVC development models. This course covers the topic of MVC development in more depth and introduces a much more complex development scenario.</p>\n<p>The installer also opens a browser window which shows <strong>an MVC application error</strong> <em>(</em>e.g., <em>\"Server Error in '/Kentico12_MedioClinic' Aplication. The resource cannot be found.\") </em>You will get the same error message when you try to Preview the live site application in the admin interface. This is the expected behavior - your MVC application which the Kentico installer installed is just an empty project at the moment. During the training course, you will be building the MVC artifacts, such as controllers, views, etc.</p>\n<p>If you run into any issues during installation, see the documentation for <a href=\"https://docs.kentico.com/k12/installation/troubleshooting-installation-issues\">Troubleshooting installation issues</a>.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/9f4148ab-6bfc-4401-ad18-7b6079717118/K12-KenticoInstaller7.png","alt":"K12-KenticoInstaller7.png"},"strapline":"Completing the installation"}],"instruction":"","_layout":"full","_component":"narrative","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"8f40873d-da45-4861-a033-7683441621a2","_parentId":"d9e86ffa-3fd8-446a-a282-18114e49b9eb","_type":"component","title":"Demo: Installing Kentico","displayTitle":"Demo: Installing Kentico"},{"body":"<div class=\"infobox note\"><p>The default username is <strong>administrator</strong>, and there is no password.</p>\n<p>If you are new to Kentico, you might want to familiarize yourself with the <strong>Kentico interface</strong>. For example, you can <a href=\"https://docs.kentico.com/k12tutorial/using-the-kentico-interface\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">learn about the Kentico interface and Kentico documentation</a> in two short videos in Kentico tutorial. (The Kentico tutorial opened when you installed Kentico.)</p></div>\n<h3>Kentico licenses</h3>\n<p>Kentico manages the website licenses in the <strong>Licenses</strong> application in the administration interface. When you install Kentico, your installation will by default contain two-week trial licenses, e.g., for <em>localhost</em> domain and <em>127.0.0.1</em> loopback address.</p>\n<p>A domain can only have one license key attached, so you need to first delete the existing licenses for&nbsp;<em>localhost</em> domain and any&nbsp;<em>127.x.x.x</em> addresses), and then add the license you have downloaded from the course.</p>\n<figure data-asset-id=\"9588cdb2-7a8e-413b-9334-cb23cade6461\" data-image-id=\"9588cdb2-7a8e-413b-9334-cb23cade6461\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/8f6d0c39-0de2-4967-8e0f-d681f8fcf051/mvc-adding-course-license.gif\" data-asset-id=\"9588cdb2-7a8e-413b-9334-cb23cade6461\" data-image-id=\"9588cdb2-7a8e-413b-9334-cb23cade6461\" alt=\"\"></figure>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"d944b6b8-daa0-41e4-806b-593a8bc1bb05","_parentId":"d9e86ffa-3fd8-446a-a282-18114e49b9eb","_type":"component","title":"Demo: Adding the course license","displayTitle":"Adding the course license"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Which of the following statements is true for the Kentico MVC development model?</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p>The installer creates project files for the live site and Kentico application.</p>","_shouldBeSelected":true,"feedback":""},{"text":"<p>The MVC project's files are based on the \"MVC with user authentication\" project template from Visual Studio.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. Kentico uses its own custom project files, and some of the default classes already contain Kentico code.</p>"},{"text":"<p>You cannot change the presentation URL of your Kentico live site.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. You can change the presentation URL in the Sites application in the Kentico administration interface.</p>"},{"text":"<p>You&nbsp;cannot change your Kentico application's virtual alias path.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. You can add your own virtual application and specify a custom Alias and Physical paths&nbsp;in IIS.</p>"}],"_feedback":{"title":"Feedback","correct":"<p>You got it! Kentico creates two solutions and two sets of project files in one folder.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"73211e10-802f-4a3f-ad01-5f34faad8825","_parentId":"5365516e-bdcc-4214-b99f-d4cbef90c6f9","_type":"component","title":"Progress-check: MVC Development Basics Review","displayTitle":"Progress-check: MVC Development Basics Review"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Which actions does Kentico 12 Installer perform during the installation of MVC projects?</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p>Sets the connection string to the shared database for both the live site and Kentico applications.</p>","_shouldBeSelected":true,"feedback":""},{"text":"<p>Creates an&nbsp;<em>ApplicationConfig.cs</em>&nbsp;class in the live site's project files, which calls methods that enable Kentico MVC features, such as&nbsp;<em>builder.UsePreview().</em></p>","_shouldBeSelected":false,"feedback":"<p>Wrong. Sorry, that's what happened when installing the MVC NuGet package in versions prior to Kentico 12. You need to decide yourself which optional MVC features you want to enable.</p>"},{"text":"<p>Points you to the Settings application, where you need to set the automatic web farm mode.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. The web farm mode is set automatically when you install a new MVC project.</p>"},{"text":"<p>Installs all available Kentico NuGet packages, such as <em>Kentico.Libraries.Tests</em>.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. Sorry, installing Kentico.Libraries.Tests is something you need to do yourself.</p>"}],"_feedback":{"title":"","correct":"<p>You got it! Kentico Installer sets the connection strings to one shared database.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"1287f174-c42e-4fb8-a4f0-43802c715207","_parentId":"5365516e-bdcc-4214-b99f-d4cbef90c6f9","_type":"component","title":"MVC Kentico Installer","displayTitle":"MVC Kentico Installer"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>For which types of pages do we recommend using the Kentico page builder?</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p>Article pages</p>","_shouldBeSelected":false,"feedback":"<p>Wrong, Article pages are a great example of structured content with a unified rendering for all articles. How about going back and reviewing the Editing content in Kentico video?</p>"},{"text":"<p>Contact us page</p>","_shouldBeSelected":false,"feedback":"<p>Wrong, the content of the Contact us page usually doesn't change a lot on the live site.&nbsp;How about going back and reviewing the Editing content in Kentico video?</p>"},{"text":"<p>Campaign landing pages</p>","_shouldBeSelected":true,"feedback":""},{"text":"<p>Product pages</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. Product pages typically look alike across the whole website store section. Therefore, it's more useful to take the structured approach to hold content and create a unified markup. How about going back and reviewing the Editing content in Kentico video?</p>"}],"_feedback":{"title":"","correct":"<p>You got it! We recommend using Kentico page builder on pages with a short lifetime, such as campaign landing pages, or on pages where editors need to dynamically adjust specific areas, such as home pages.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"65fa7f03-64cc-44e1-8f27-0714b3b6adb4","_parentId":"5365516e-bdcc-4214-b99f-d4cbef90c6f9","_type":"component","title":"MVC Page builder overview","displayTitle":"MVC Page builder overview"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Why does the&nbsp;<em>Kentico().MapRoutes()</em>&nbsp;method need to be called before other route mappings?</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p>Because the method overrides the standard .NET routing process for all other mapped routes.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. The&nbsp;<em>Kentico().MapRoutes()</em>&nbsp;extension method only maps routes for Kentico HTTP handlers, and does not modify the overall routing process in any way.</p>"},{"text":"<p>To avoid collisions with other more general routes, which could otherwise match the URLs used by Kentico HTTP handlers.</p>","_shouldBeSelected":true,"feedback":""},{"text":"<p>The question is wrong. It's actually not important where you call the&nbsp;<em>Kentico().MapRoutes()</em>&nbsp;method, it just needs to be called anywhere for your application's&nbsp;<em>RouteCollection</em>.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong.&nbsp;The&nbsp;<em>Kentico().MapRoutes()</em>&nbsp;extension method needs to be called before you map other more general routes.</p>"},{"text":"<p>The question is wrong. There is no such method as&nbsp;<em>Kentico().MapRoutes().</em></p>","_shouldBeSelected":false,"feedback":"<p>Wrong. The <em>Kentico().MapRoutes()</em> extension method exists and is pretty important. How about going back and reviewing the material? (The text \"What happens during the Kentico MVC installation?\" may come in handy.)</p>"}],"_feedback":{"title":"","correct":"<p>You got it! You need to map the routes of Kentico HTTP handlers first to avoid route collisions, which can lead to issues like images not displaying correctly.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"dfc62188-9ddd-47eb-aa06-7659f3b2ea1f","_parentId":"5365516e-bdcc-4214-b99f-d4cbef90c6f9","_type":"component","title":"Kentico.MapRoutes extension method","displayTitle":"Kentico.MapRoutes extension method"},{"body":"<p>Congratulations on completing the first section of the course! You now know about the very basics of what it's like to develop websites using the Kentico MVC development model.</p>\n<p>You have learned:</p>\n<ul>\n  <li>About the Kentico MVC development model in general</li>\n  <li>How the Kentico Installer creates MVC projects and which features it configures</li>\n  <li>A little bit about Kentico API</li>\n</ul>\n<p>Ready to go to the next section and learn about how to work with content in the Kentico application?<strong> Click the back button </strong>(<strong>&lt;</strong>)<strong> in the top left, and continue with the course!</strong></p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"590d005b-40df-40a7-9329-bfa363a183ca","_parentId":"f14fe5e2-934c-4e18-90b6-553172cd129f","_type":"component","title":"Conclusion","displayTitle":"Conclusion"},{"body":"<p>What you will learn in this section:</p>\n<ul>\n  <li>What <strong>page types</strong> are and how to create them</li>\n  <li>How <strong>URL patterns </strong>work</li>\n  <li>How <strong>page</strong> <strong>data</strong> <strong>is</strong> <strong>stored</strong> in Kentico</li>\n  <li>What options for <strong>page</strong> <strong>attachments</strong> the Kentico MVC development model provides</li>\n</ul>\n<p>You will work on:</p>\n<ul>\n  <li>Creating page types for Medio Clinic Home, Contact, Doctors and Doctor's profile pages</li>\n  <li>Adding new pages and content based on the page types you define</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"016c6ede-619d-4695-aa81-3ea552a7f268","_parentId":"63fa12af-3f89-4a7f-887e-e2ecadc2a83d","_type":"component","title":"Intro: Creating page types","displayTitle":"Intro: Creating page types"},{"_setCompletionOn":"play","_useClosedCaptions":true,"_allowFullScreen":true,"_media":{"mp4":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/b21a170c-5dc1-4afb-8156-757a150a8aa6/working-with-page-types.mp4","poster":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/468e71ca-f4a5-4094-afb0-3682401839bc/mvc-how-page-types-work.png","cc":{"srclang":"en","src":null}},"_transcript":{"_setCompletionOnView":true,"_inlineTranscript":true,"_externalTranscript":false,"inlineTranscriptButton":"Transcript","InlineTranscriptCloseButton":"Close Transcript","inlineTranscriptBody":"<p>Hi there, in this video we will look at how page types work. Page types serve as structures for storing content in Kentico.</p>\n<p>When developers identify what type of content the website editors intend to create,&nbsp;they need to figure out the structure of individual pages that will hold this content.</p>\n<p>You already know that editors can edit pages on the website as structured content or use the Kentico page builder. You also know that the&nbsp;data is stored in the database, and then displayed on the live site via the Kentico API.</p>\n<p>The page data needs to be stored in a way that allows developers to create flexible logic for retrieving and displaying content.</p>\n<p>And page types are here to help with that.</p>\n<p>With the MVC development model, every page is based on a content-only page type.</p>\n<p>Each page type consists of fields, which define the content structure for pages of the given type, as well as the columns of the underlying database table.</p>\n<p>The editing interface through which editors input data in Kentico is provided by form controls, which can be assigned to individual fields.</p>\n<p>A form control displays a certain element, such as a text box or area, a drop-down-selector, or a group of radio buttons.&nbsp;</p>\n<p>Regardless of the input element's type, each form control saves its value into a single field in the database.</p>\n<p>Fields can also have additional settings, such as tooltips for the editing interface, or conditions under which the field will be visible to specific users.</p>\n<p>For pages with structured content, the fields automatically define a simple editing interface.</p>\n<p>The field editing interface allows editors to focus on optimizing the content, and leave worries about the final live site appearance of pages to the developers.</p>\n<p>If developers decide to give editors more control over both the content and design of a page through the page builder, they need to define editable areas on the page, as well as the MVC widgets the editors will use.</p>\n<p>Even though the visual experience of the page builder is different from structured content editing via form controls, pages that use the page builder still need to be based on a page type.</p>\n<p>As content-only pages just store data, they don't need to be organized in any special hierarchy. However, a content tree without any visual hierarchy or structure can soon become highly confusing.</p>\n<p>It's the developers who can help and define page types in a way that makes creating new pages easier and more intuitive.</p>\n<p>How? They can either set lists of allowed child and parent page types, or create page type scopes. While the allowed child and parent types define limits for individual page types, the scopes narrow down the number of page types that editors can create under specified paths within the content tree.</p>\n<p>With either of these boundaries, keep in mind that the hierarchy of the content tree will be just a visual representation for editors, because content-only pages do not define actual pages on the live site.</p>\n<p>Content-only page types don't have a presentation URL by default.</p>\n<p>This means that the Kentico application&nbsp;does not automatically know the live URLs under which individual pages will be available.</p>\n<p>If you want editors to create hyperlinks or preview the live site appearance of pages in the administration interface, you need to specify a URL pattern for each page type.</p>\n<p>The URL pattern determines the addresses under which the administration interface accesses the pages.&nbsp;</p>\n<p>When an editor creates a page and adds content to its fields, the data is stored in three interconnected database tables.</p>\n<p>CMS_Tree stores information about the page's position in the content tree.</p>\n<p>CMS_Document holds the page's properties, metadata, and content defined by editors through the page builder.</p>\n<p>A third table, referred to as a \"coupled data\" table, holds the page's structured content. Each page type has its own table, with columns that match the page type's fields.</p>\n<p>For websites with multilingual content, say English and Spanish, the CMS_Tree table always contains one record per page, while CMS_Document and the coupled data table store a separate record for each culture variant of a page.</p>\n<p>That's how page types work in Kentico. As a developer, you create the page types that store data in the database and provide editors with means to input data through form controls.</p>\n<p>And by defining the URL pattern for page types, you allow editors to work with pages correctly in the admin interface.</p>"},"_playerOptions":{"features":["playpause","progress","current","duration","speed","volume","fullscreen"]},"instruction":"","_layout":"full","_component":"media","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"1e655b34-22aa-4d6f-9dd1-2cea927840e3","_parentId":"a20c7735-97e2-465c-8eb3-cf8ac2127c0f","_type":"component","title":"Theory: How page types work","displayTitle":"Theory: How page types work"},{"body":"<p>By default, the system does not know the URL under which content-only pages are presented, so content editors cannot access the pages in the <strong>Preview</strong> mode within the administration interface. They also cannot use features that rely on the preview mode, such as the page builder, or create hyperlinks to pages in the content tree using the built-in text editor. To enable editors to fully leverage the power of the Kentico MVC development model, you need to specify a <strong>URL pattern</strong> for your page types.</p>\n<h3>The URL pattern</h3>\n<p>The <strong>URL pattern</strong> specifies how the system resolves the page's URL within the administration interface. The system combines the URL pattern with the site's presentation URL and creates the overall display URL of the page.&nbsp;</p>\n<p>The URL pattern comes in especially&nbsp;handy for pages which are presented separately on the live site. On the other hand, you don't need to set a URL pattern for pages &nbsp;in the content tree that do not represent distinct pages on the live site. In some cases, you may have pages whose content is aggregated in a different page, which then presents a complete page on the live site. For example, you can show all company offices listed on one page on the live site, but store information about each office in a separate page in the content tree. If you don't need to display individual offices on separate pages, you don't need to set a URL pattern for the 'office' page type, but only for the listing 'offices' type.</p>\n<h3>Macros in URL patterns</h3>\n<p>By adding macro expressions representing page properties into the URL pattern, you can set presentation URLs for separate pages based on the same page type, or different language versions of the same page. Using macro variables in your patterns is particularly important on larger sites with multiple cultures.</p>\n<p>Kentico macro expressions use the object-oriented <strong>K# </strong>language, which is very similar to the C# programming language. The system identifies string as a macros when you enclose the expression into curly brackets with a percentage sign: <em>{% MacroExpression %}</em>. To learn more about the K# language, other parameters you can use, and creating advanced macro expressions, visit our <a href=\"https://docs.kentico.com/k12/macro-expressions/macro-syntax\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">documentation</a>.</p>\n<p>To find out what node and page data is available for your URL pattern macro expressions, you can look into the built-in Kentico macro console. Navigate to the <strong>System </strong>application, select the <strong>Macros </strong>&gt; <strong>Console </strong>tab and type, e.g., <em>CurrentDocument.</em> into the console. The macro autocomplete feature will list all the properties that are available in the page and node data.</p>\n<h4>Common macros in URL patterns</h4>\n<p>The most common way to address a page on MVC sites is to use the {% <em>NodeAlias %}</em> macro, which retrieves the <strong>page alias</strong> and helps to create more SEO-friendly URLs.</p>\n<p>Besides the pages aliases, you can also add the {% <em>DocumentCulture %}</em> macro to the URL pattern, which resolves into the <strong>culture code</strong> of the page's currently active content culture.</p>\n<p>For example, when a page type for blog articles has the following URL pattern:</p>\n<p><em>{% DocumentCulture %}/Articles/{% NodeAlias %}</em></p>\n<p>An article, e.g., '<em>The Magical Health Benefits of Being Cold</em>' in the Medio Clinic website's US English culture, has the following live URL:&nbsp;</p>\n<p><em>http://medioclinic.com/en-US/Articles/The-Magical-Health-Benefits-of-Being-Cold</em></p>\n<p>where '<em>en-US</em>' is the culture code and '<em>The-Magical-Health-Benefits-of-Being-Cold</em>' is the article's page alias.</p>\n<div class=\"infobox note\"><p>We do not recommend using query string parameters in URL patterns. When the system generates the <em>Preview</em> <em>URLs</em> for pages based on the specified pattern, it removes any parameters.</p></div>\n<p>Macro expressions in the URL pattern help you create more robust system logic, which is ready to serve when you need to start scaling up your application.&nbsp;</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"c6509777-b455-4f56-83db-cbd333015b07","_parentId":"51a2c7c1-bb28-4085-ad2e-b697e9091e5f","_type":"component","title":"Theory: URL Pattern","displayTitle":"URL pattern"},{"body":"<p>Kentico provides options to website editors who want to attach files to pages in the content tree. Typical examples of uploaded attachments are PDF files or images.</p>\n<p>Unlike files stored in media libraries, which are covered later in the course, attached files are associated with the pages they have been uploaded to. If editors move or copy the page with the associated files in the content tree, the attachments are moved or copied together with the page.</p>\n<p>Developers can prepare page types to store attachments by adding fields with the following data types:</p>\n<ul>\n  <li><strong>File</strong> fields allow editors to upload a single attachment file. Editors use the <em>Direct uploader</em> form control on the <strong>Content</strong> tab in the <strong>Pages</strong> application to add, update or remove the file. If you want to use the <em>File</em> data type for multiple attachments on a single page, you need to create a separate field for each file you want editors to upload.</li>\n  <li><strong>Attachments</strong> fields provide a way to manage multiple attachments through a single page type field. Content editors add the attachments on the <strong>Content</strong> tab&nbsp;in the <strong>Pages</strong> application, where the given field provides an uploader built on the <em>Attachments</em> form control.</li>\n</ul>\n<p>For both <em>File </em>and <em>Attachments </em>fields, website editors can perform additional operations like updating the file or changing its name. If the attached file is an image, they can also use the Kentico built-in image editor to perform basic operations, such as resizing or cropping of the file.</p>\n<div class=\"infobox note\"><p><strong>Attachment database storage</strong></p>\n<p>Attachment page type fields do not directly store the binary data and other properties of the uploaded files. Instead, the system saves attachments separately in the <strong>CMS_Attachment</strong> database table.&nbsp;</p>\n<ul>\n  <li><em>File</em> page type fields store a GUID value, which identifies the corresponding attachment in the <em>CMS_Attachment</em> table.&nbsp;</li>\n  <li>For <em>Attachments</em> fields, the value in the database is always empty. Instead, the given records in the <em>CMS_Attachment</em> table store an identifier of the related page (<em>AttachmentDocumentID</em> column) and a GUID value that identifies the specific field in the page type's form definition (<em>AttachmentGroupGUID</em> column).</li>\n</ul>\n<p>The relationships between page fields and attachments are all handled automatically by the system, both by the used form controls in the administration interface, and when working with attachments in the Kentico API.</p></div>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":false},"_isOptional":false,"_classes":"","_id":"f21ea491-cb36-4b33-9ef1-9b29f3580f2f","_parentId":"2d638e07-b2cd-463f-8f50-a55db9008d99","_type":"component","title":"Page attachments in MVC sites","displayTitle":"Page attachments in MVC sites"},{"body":"<p>Editors add content to the website in the <strong>Pages </strong>application. You already know that editors work with pages as <em>structured content</em> or through the <em>page builder</em>. You also know what the benefits of each of the approaches are and when to use them.</p>\n<h2>The Pages application UI</h2>\n<p>The application's interface for MVC sites is lean and helps editors to effectively work with their content.&nbsp;</p>\n<figure data-asset-id=\"445eaf8d-8cb8-4dd1-bb0e-c96ed7e7cde4\" data-image-id=\"445eaf8d-8cb8-4dd1-bb0e-c96ed7e7cde4\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/30e5facb-7a95-4c65-85f3-bfae24ea9c89/mvc-pages-application-ui.png\" data-asset-id=\"445eaf8d-8cb8-4dd1-bb0e-c96ed7e7cde4\" data-image-id=\"445eaf8d-8cb8-4dd1-bb0e-c96ed7e7cde4\" alt=\"\"></figure>\n<p>The interface of the Pages application is split into two parts:</p>\n<ul>\n  <li>A <strong>Content tree</strong> providing an overview of all pages on the website in a hierarchy</li>\n  <li>An area where editors <strong>manage </strong>and <strong>view </strong>the content, or <strong>perform bulk operations</strong> on pages, depending on the selected <strong>view mode</strong>.</li>\n</ul>\n<h2>View modes</h2>\n<p>The <strong>Pages </strong>application offers three view modes:</p>\n<ul>\n  <li><strong>Edit</strong> - the default mode which allows editing of page content. For pages using <em>structured content</em>, editors work in the simple interface of the <strong>Content </strong>tab. And they work on the <strong>Page </strong>tab on pages which use the <em>page builder</em>.</li>\n  <li><strong>Preview </strong>- displays the latest version of the page, which means that its content doesn't have to be promoted to the live site. &nbsp;The <em>Preview </em>mode helps editors see what their page will look like on the live site when it is published. They can send links to users outside of the system to these not-yet published pages or approve changes before they are presented to the live site audience. <br>\n</li>\n</ul>\n<div class=\"infobox note\"><p>If you want to use the&nbsp;<em>Preview&nbsp;</em>functionality, you need to configure URL patterns for your page types in the Kentico administration, and implement the presentation of the pages and URL routing in the MVC live site application (which is covered later in the course).</p></div>\n<ul>\n  <li><strong>Listing </strong>- provides an overview of all pages in the content tree, and allows editors to move, copy, delete, publish or translate pages in bulk.</li>\n</ul>\n<p>Find out more about the differences between the view modes in our <a href=\"https://docs.kentico.com/k12/managing-website-content/working-with-pages\">documentation</a>.&nbsp;</p>\n<h2>Page statuses</h2>\n<p>The page status icons help editors quickly find out the current state of pages. Primarily whether pages are published on the live site or not. You can learn about the page statuses in Kentico <a href=\"http:// https://docs.kentico.com/k12/managing-website-content/working-with-pages\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">documentation</a>.</p>\n<p>If you want to find out more about the <strong>Pages </strong>application, feel free to go through the <a href=\"https://docs.kentico.com/k12/managing-website-content/working-with-pages\">Working with pages</a> chapter in our documentation or take our <a href=\"https://www.kentico.com/services/training/content-admin-essentials\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Content Admin</a> course aimed at business users using the Portal Engine.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"ed56b7c0-250d-45bd-8bfb-a29e5b5db571","_parentId":"e17d9977-b8c9-4c6b-9abd-f7c816103a3f","_type":"component","title":"Theory: Pages application","displayTitle":"Theory: Pages application"},{"body":"<h3>1. Create the page types</h3>\n<p>Before you start adding content in the administration interface, you need to first define the page types you will use to create pages. To get your system ready for content editing, create the following content-only page types.&nbsp;</p>\n<p>Use the <em>MedioClinic</em> custom namespace in the code names of all page types, and define fields and other configuration according to the information below. Note that the system automatically generates identifier fields like <em>HomeSectionID</em>&nbsp;for all page types.&nbsp;</p>\n<p>When adding the <strong>URL pattern</strong>, make sure there is no extra white space after the pattern you add. The extra white space may cause that the URL pattern isn't resolved correctly, and as a result, the preview mode might not work.</p>\n<p>To help editors easily identify the page type they want to edit in the content tree, you can use different icons which will represent them in the content tree. Start typing in the icon box to see all the available icons. Similarly, you may want to allow editors to see their content on the <strong>Page</strong> tab in the <strong>Pages</strong> application. To enable use of the <em>Page</em> tab, dont forget to select the <strong>Use Page tab</strong> checkbox when creating the page types.</p>\n<p>The following image shows the structure of allowed page types on the website (the parent-child relationships between individual page types).</p>\n<figure data-asset-id=\"ba34a6dd-74e0-40e4-971e-61f0ff3cced0\" data-image-id=\"ba34a6dd-74e0-40e4-971e-61f0ff3cced0\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/fb20b9e4-2bad-4cf1-b003-511c5941aeb7/mvc-page-types-structure-medio-clinic.png\" data-asset-id=\"ba34a6dd-74e0-40e4-971e-61f0ff3cced0\" data-image-id=\"ba34a6dd-74e0-40e4-971e-61f0ff3cced0\" alt=\"\"></figure>\n<h4>Home Section</h4>\n<ul>\n  <li><strong>Title </strong>(TEXT data type with size 100, <strong>required</strong>, <em>Title </em>caption)</li>\n  <li><strong>Text </strong>(LONG TEXT data type, <strong>required</strong>, <em>Text </em>caption, <em>Rich text editor</em> form control)</li>\n  <li><strong>Button</strong> (TEXT data type with size 1000, \"<em>Link </em><em>button text\"</em> caption)</li>\n</ul>\n<p>The page name source field uses an extra field, and this page type is only allowed under the <em>Root</em> page type. The <strong>URL pattern </strong>is<em> /{%DocumentCulture%}/Home </em>and the <strong>Use Page tab</strong> checkbox is enabled. Optionally, the page type is decorated with <em>icon-home</em> in the content tree. (Or you can start typing into the<em> icon path</em> field and select any other icon.)</p>\n<h4>Company Service</h4>\n<ul>\n  <li><strong>Header </strong>(TEXT data type with size 200, <strong>required</strong>, <em>Header </em>caption)</li>\n  <li><strong>Icon </strong>(FILE data type, <strong>required</strong>, <em>Icon</em> caption, <em>Direct</em> <em>uploader </em>form control)</li>\n  <li><strong>Text </strong>(LONG TEXT data type, <strong>required</strong>, <em>Text</em> caption, <em>Rich text editor </em>form control)</li>\n</ul>\n<p>The page name source is the <em>Header </em>field, the source for the page alias is the page name &nbsp;(this is the default configuration). This page type is only allowed under the <em>Home Section</em> page type, and its <strong>URL pattern</strong> is empty.</p>\n<h4>Doctor Section</h4>\n<ul>\n  <li><strong>Title </strong>(TEXT data type with size 200, <strong>required</strong>, <em>Title</em> caption)</li>\n</ul>\n<p>The page name source is the <em>Title </em>field, and this page type is only allowed under the <em>Root</em> page type. Its <strong>URL pattern </strong>is <em>/{%DocumentCulture%}/Doctors</em> and the <strong>Use Page tab</strong> checkbox is enabled. Optionally, the page type is decorated with <em>icon-box</em> in the content tree.</p>\n<h4>Doctor</h4>\n<ul>\n  <li><strong>FirstName </strong>(TEXT data type with size 200, <strong>required</strong>, <em>First name</em>&nbsp;caption)</li>\n  <li><strong>LastName </strong>(TEXT data type with size 200, <strong>required</strong>, <em>Last name</em>&nbsp;caption)</li>\n  <li><strong>Degree </strong>(TEXT data type with size 100, <strong>required</strong>, <em>Doctor degree</em>&nbsp;caption)</li>\n  <li><strong>Photo </strong>(FILE data type, <strong>required</strong>, <em>Photo</em>&nbsp;caption, <em>Direct uploader</em> form control)</li>\n  <li><strong>Specialty </strong>(TEXT data type with size 200, <strong>required</strong>, <em>Doctor specialty</em>&nbsp;caption)</li>\n  <li><strong>Bio </strong>(LONG TEXT data type, <em>Bio</em> caption)</li>\n  <li><strong>EmergencyShift </strong>(INTEGER NUMBER data type, <strong>required</strong>, <em>Emergency shift</em> caption. The field's form control is <em>Drop-down list </em>with days of the week in the <strong>List of options </strong>data source. The <em>Data source </em>textbox contains values for the list in the following format: <em>number;day of the week</em>, e.g., <em>1;Monday. </em>Each pair is listed on a separate line.)</li>\n</ul>\n<div class=\"infobox note\"><p>Depending on your site's requirements, you could also create custom tables that allow dynamic editing of available values for the <em>Degree </em>and <em>Specialty </em>fields. The fields would then use the <em>Custom table item selector</em> form control, which would allow selection of the defined values.</p></div>\n<p>The page name source is the <em>LastName </em>field. This page type is only allowed under the <em>Doctor Section </em>page type, its <strong>URL pattern </strong>is <em>/{%DocumentCulture%}/Doctors/Detail/{%NodeGUID%}/{%NodeAlias%}</em>. Optionally, the page type is decorated with <em>icon-user-frame</em>&nbsp;in the content tree.</p>\n<h4>Contact Section</h4>\n<ul>\n  <li><strong>Title </strong>(TEXT data type with size 200,&nbsp;<strong>required</strong>,&nbsp;<em>Title </em>caption)</li>\n  <li><strong>Subtitle&nbsp;</strong>(TEXT data type with size 200,&nbsp;<strong>required</strong>,&nbsp;<em>Subtitle&nbsp;</em>caption)</li>\n  <li><strong>Text</strong>&nbsp;(LONG TEXT data type,&nbsp;<strong>required</strong>,&nbsp;<em>Text&nbsp;</em>caption,&nbsp;<em>Text area</em>&nbsp;form control)</li>\n</ul>\n<p>The page name source is the <em>Title </em>field, and this page type is only allowed under the&nbsp;<em>Root </em>page type. Its <strong>URL pattern&nbsp;</strong>is <em>/{%DocumentCulture%}/Contact</em>. Optionally, the page type is decorated with <em>id-card</em>&nbsp;in the content tree.</p>\n<h4>Company</h4>\n<ul>\n  <li><strong>CompanyName </strong>(TEXT data type with size 200, <strong>required</strong>, <em>Company name</em> caption)</li>\n  <li><strong>Street</strong> (TEXT data type with size 200, <strong>required</strong>, <em>Street</em>&nbsp;caption)</li>\n  <li><strong>City</strong> (TEXT data type with size 200, <strong>required</strong>, <em>City</em>&nbsp;caption)</li>\n  <li><strong>Country</strong> (TEXT data type with size 200, <strong>required</strong>, <em>Country</em> caption, <em>Country selector</em> form control)</li>\n  <li><strong>ZipCode</strong> (TEXT data type with size 200, <strong>required</strong>, <em>Zip code</em>&nbsp;caption)</li>\n  <li><strong>PhoneNumber</strong> (TEXT data type with size 200, <strong>required</strong>, <em>Phone number</em>&nbsp;caption)</li>\n  <li><strong>Email</strong> (TEXT data type with size 200, <strong>required</strong>, <em>Email</em> caption, <em>Email</em> form control)</li>\n</ul>\n<div class=\"infobox idea\"><p>The <em>Email </em>form control automatically validates whether values added by content editors are in the correct email address format.</p></div>\n<p>The page name source is the <em>CompanyName </em>field. This page type is allowed under the <em>Contact Section </em>page types, and its <strong>URL pattern </strong>is empty.</p>\n<h4>Social links folder</h4>\n<ul>\n  <li><strong>FolderName </strong>(TEXT data type with size 100,&nbsp;<strong>required</strong>,&nbsp;<em>Folder name</em>&nbsp;caption)</li>\n</ul>\n<p>The page name source is the <em>FolderName </em>field. This page type is only allowed under the&nbsp;<em>Contact Section</em>&nbsp;page type, and its&nbsp;<strong>URL pattern&nbsp;</strong>is empty. Optionally, the page type is decorated with&nbsp;<em>icon-doc-o</em>&nbsp;in the content tree.</p>\n<h4>Social Link</h4>\n<ul>\n  <li><strong>Title</strong> (TEXT data type with size 200, <strong>required</strong>, <em>Link title </em>caption)</li>\n  <li><strong>Url </strong>(TEXT data type with size 2000, <strong>required</strong>, <em>Link Url</em> caption, <em>URL selector</em> form control)</li>\n  <li><strong>Icon </strong>(FILE data type, <strong>required</strong>, <em>Icon</em> caption, <em>Direct file uploader</em> form control)</li>\n</ul>\n<p>The page name source uses an extra field. This page type is only allowed under the <em>Social links folder</em> page type, and its <strong>URL pattern </strong>is empty. Optionally, the page type is decorated with <em>icon-arrow-right-top-square</em>&nbsp;in the content tree.</p>\n<h4>Office location folder</h4>\n<ul>\n  <li><strong>FolderName </strong>(TEXT data type with size 100, <strong>required</strong>, <em>Folder name</em> caption)</li>\n</ul>\n<p>The page name source uses <em>FolderName</em> field for its name. This page type is only allowed under the <em>Contact Section </em>page type, and its <strong>URL pattern </strong>is empty. Optionally, the page type is decorated with <em>icon-map</em>&nbsp;in the content tree.</p>\n<h4>Map Location</h4>\n<ul>\n  <li><strong>Latitude </strong>(FLOATING-POINT NUMBER data type, default value 0, <strong>required</strong>, <em>Latitude </em>caption)</li>\n  <li><strong>Longitude </strong>(FLOATING-POINT NUMBER data type, default value 0,&nbsp;<strong>required</strong>,&nbsp;<em>Longitude </em>caption)</li>\n  <li><strong>Tooltip</strong> (TEXT data type with size 300, <strong>required</strong>, <em>Tooltip text</em>&nbsp;caption)</li>\n</ul>\n<p>This page type uses an extra field as its page name source field, and it is only allowed under the <em>Office location folder</em>&nbsp;page type. The <strong>URL pattern </strong>field is empty. Optionally, the page type is decorated with <em>icon-map-marker</em>&nbsp;in the content tree.</p>\n<h3>2. Generate the code files of the page types</h3>\n<p>After you have created all these page types, you can generate their code in bulk on the <strong>Code</strong> tab. &nbsp;You will use these code files to retrieve content from pages of these types in your <em>Medio Clinic</em> MVC application.&nbsp;</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"51765e0c-4fb4-4e15-8393-9c821a758fd2","_parentId":"fd332bba-d0c2-4991-80ea-14e5dacba923","_type":"component","title":"Task: Create page types to hold your content","displayTitle":"Task: Create page types to hold your content"},{"body":"<p>You'll need to add some content to the website so you have some data to work with during the remainder of the course. Create the pages described below in your site's content tree. To get the text and images used by the training site's pages, download and unpack the <a data-asset-id=\"978188eb-3819-44f0-9a1a-5c36b01f29cc\" href=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/741bdbed-c049-4527-9dbe-b04355ce1388/MedioClinicContent.zip\">MedioClinicContent.zip</a> file.</p>\n<p>In later parts of the course, you will learn how to display this data on the website using best practices for Kentico MVC development.</p>\n<div class=\"infobox note\"><p>Please note that the content tree in the screenshots also contains the <em>Menu items </em>section of pages. You will add menu functionality and the related pages later in this course.</p></div>\n<h2>Home</h2>\n<p>When complete, your Home<strong> </strong>page (<em>Home Section</em> page type) could look like this:</p>\n<figure data-asset-id=\"8fcb6ace-63cc-455a-adfb-2dc30027d694\" data-image-id=\"8fcb6ace-63cc-455a-adfb-2dc30027d694\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/d1b265c6-d244-4b4b-b645-cb32c06ab459/mvc-adding-content-to-pages2.png\" data-asset-id=\"8fcb6ace-63cc-455a-adfb-2dc30027d694\" data-image-id=\"8fcb6ace-63cc-455a-adfb-2dc30027d694\" alt=\"\"></figure>\n<h3>Company service pages</h3>\n<p>Add the following service pages (<em>Company Service</em> page type) under the <em>Home</em> page: Cardio Therapy, Emergency Services, Medical Consultancy.</p>\n<p>When complete, the service pages could look like this:</p>\n<figure data-asset-id=\"85812be0-7e6b-4a9b-9937-2ae2bf2dd245\" data-image-id=\"85812be0-7e6b-4a9b-9937-2ae2bf2dd245\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/e1e86220-dd5a-4297-8d84-5192647fd3de/mvc-adding-content-to-pages3.png\" data-asset-id=\"85812be0-7e6b-4a9b-9937-2ae2bf2dd245\" data-image-id=\"85812be0-7e6b-4a9b-9937-2ae2bf2dd245\" alt=\"\"></figure>\n<h2>Doctors&nbsp;</h2>\n<p>When complete, the page that lists doctors (<em>Doctor Section</em> page type) could look like this:</p>\n<figure data-asset-id=\"845839c8-d751-4346-9ffa-582494ba0f9f\" data-image-id=\"845839c8-d751-4346-9ffa-582494ba0f9f\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/4dd2f174-bce1-4d2b-a590-608ff6488074/mvc-adding-content-to-pages4.png\" data-asset-id=\"845839c8-d751-4346-9ffa-582494ba0f9f\" data-image-id=\"845839c8-d751-4346-9ffa-582494ba0f9f\" alt=\"\"></figure>\n<h3>Doctor profile pages</h3>\n<p>Add the following doctor pages (<em>Doctor</em> page type) under the <em>Doctors</em> page: Doe, Joplin, Piaf, Snow, Sparrow, Vick. Later in the course, you will use these doctors to create a listing page in your MVC application.</p>\n<p>When complete, your doctor pages could look like this:</p>\n<figure data-asset-id=\"02447502-a386-4754-9653-6de5bd9b4f37\" data-image-id=\"02447502-a386-4754-9653-6de5bd9b4f37\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/9fe88a64-a540-4256-beb7-99ae2c662801/mvc-adding-content-to-pages5.png\" data-asset-id=\"02447502-a386-4754-9653-6de5bd9b4f37\" data-image-id=\"02447502-a386-4754-9653-6de5bd9b4f37\" alt=\"\"></figure>\n<h2>Contact us</h2>\n<p>When complete,&nbsp;your&nbsp;Contact us page (<em>Contact Section</em> page type) could look like this:</p>\n<figure data-asset-id=\"f29b7ae5-90d9-4feb-b1a2-b54010d03e7c\" data-image-id=\"f29b7ae5-90d9-4feb-b1a2-b54010d03e7c\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/0b21d843-6dec-4b30-839c-e1601e09ccac/mvc-adding-content-to-pages6.png\" data-asset-id=\"f29b7ae5-90d9-4feb-b1a2-b54010d03e7c\" data-image-id=\"f29b7ae5-90d9-4feb-b1a2-b54010d03e7c\" alt=\"\"></figure>\n<h3>Medio Clinic</h3>\n<p>Add a Medio Clinic page (<em>Company</em>&nbsp;page type) under the <em>Contact us</em> page.&nbsp;</p>\n<p>When complete, your&nbsp;Medio Clinic&nbsp;page could look like this:</p>\n<figure data-asset-id=\"1853485c-3c5e-42d7-b556-f51aea846ba9\" data-image-id=\"1853485c-3c5e-42d7-b556-f51aea846ba9\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/f3fab140-74da-4da8-8f58-57dcbd1d0e51/mvc-adding-content-to-pages7.png\" data-asset-id=\"1853485c-3c5e-42d7-b556-f51aea846ba9\" data-image-id=\"1853485c-3c5e-42d7-b556-f51aea846ba9\" alt=\"\"></figure>\n<h3>Office locations</h3>\n<p>Add an Office locations page (<em>Office location folder</em>&nbsp;page type) under the <em>Contact us</em> page.&nbsp;</p>\n<p>When complete, your&nbsp;Office locations&nbsp;page could look like this:</p>\n<figure data-asset-id=\"2d1292c9-432a-4421-b08a-1ce45386c448\" data-image-id=\"2d1292c9-432a-4421-b08a-1ce45386c448\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/f3d3cc8a-7479-41f1-988e-3bee5e3c3a35/mvc-adding-content-to-pages8.png\" data-asset-id=\"2d1292c9-432a-4421-b08a-1ce45386c448\" data-image-id=\"2d1292c9-432a-4421-b08a-1ce45386c448\" alt=\"\"></figure>\n<h4>Office location pages</h4>\n<p>Add the Boston and Bedford office location pages (<em>Map location</em> page type) under the <em>Office locations</em> page.</p>\n<p>When complete, your office location pages could look like this:</p>\n<figure data-asset-id=\"d829d10f-56a1-4c04-a3f1-dbd5597ab253\" data-image-id=\"d829d10f-56a1-4c04-a3f1-dbd5597ab253\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/c92c7e6a-9386-4739-94f8-6eb2c290b35f/mvc-adding-content-to-pages9.png\" data-asset-id=\"d829d10f-56a1-4c04-a3f1-dbd5597ab253\" data-image-id=\"d829d10f-56a1-4c04-a3f1-dbd5597ab253\" alt=\"\"></figure>\n<h3>Social links</h3>\n<p>Add a Social links page (<em>Social links folder</em>&nbsp;page type) under the <em>Contact us</em> page.&nbsp;</p>\n<p>When complete, your&nbsp;Social links page could look like this:</p>\n<figure data-asset-id=\"8629a884-9bdf-45bf-82af-f6962fad393f\" data-image-id=\"8629a884-9bdf-45bf-82af-f6962fad393f\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/1ae038e4-0db0-4687-8452-242d4eba17b2/mvc-adding-content-to-pages10.png\" data-asset-id=\"8629a884-9bdf-45bf-82af-f6962fad393f\" data-image-id=\"8629a884-9bdf-45bf-82af-f6962fad393f\" alt=\"\"></figure>\n<h4>Link pages</h4>\n<p>Add the Facebook and Twitter link pages (<em>Social link</em>&nbsp;page type) under the <em>Social links</em> page.</p>\n<p>When complete, your social link pages could look like this:</p>\n<figure data-asset-id=\"6bf0c836-f84c-4491-8723-2646fdfed76b\" data-image-id=\"6bf0c836-f84c-4491-8723-2646fdfed76b\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/221c4f88-7415-4f3e-8093-7a7c999826ff/mvc-adding-content-to-pages11.png\" data-asset-id=\"6bf0c836-f84c-4491-8723-2646fdfed76b\" data-image-id=\"6bf0c836-f84c-4491-8723-2646fdfed76b\" alt=\"\"></figure>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"dd06634a-3040-476d-9410-451e782f519d","_parentId":"f39b12bb-631c-445b-aee2-849e06511469","_type":"component","title":"Task: Adding content to the website","displayTitle":"Task: Adding content to the website"},{"body":"<p>Your editors will create new pages in the content tree using the available page types. To make the content tree easy to navigate around, it helps to split it into sections. Each page which defines a section parent page needs its page type, which you can create in the&nbsp;<strong>Page types&nbsp;</strong>application.</p>\n<p>The following step-by-step demo demonstrates the creation of the <strong>Doctor Section</strong> page type. Content editors will use it to define the <em>Doctor Section</em> for pages of Medio Clinic doctors. The <em>Doctor Section</em> page type will also define the presentation <strong>URL</strong> for this page and all of the doctor child pages within the administration interface. This short demo shows you how to prepare page types for your sections, and how to set the&nbsp;<strong>URL pattern</strong>.</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>To create a new page type, click the&nbsp;<strong>New page type</strong>&nbsp;button.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/f6aa8915-a914-4881-99f6-40d427853b7d/mvc-creating-doctor-section-1.png","alt":"mvc-creating-doctor-section-1.png"},"strapline":""},{"title":"","body":"<p>In Step 1, fill in the following values:</p>\n<ul>\n  <li><strong>Page type display name</strong>: Doctor Section</li>\n  <li><strong>Namespace</strong>: MedioClinic</li>\n  <li><strong>Name</strong>: DoctorSection</li>\n</ul>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/c6226afc-9f59-4f04-add7-36df8baaf92c/mvc-creating-doctor-section-2.png","alt":"mvc-creating-doctor-section-2.png"},"strapline":""},{"title":"","body":"<p>In Step 2, leave the default values.&nbsp;</p>\n<div class=\"infobox note\"><p>Make sure the <strong>Content-only page type</strong> checkbox is selected. This ensures that any pages based on this page type will be content-only. That means the pages will hold data added by editors, support workflows and versioning, but will not necessarily represent an actual page on the live site. Depending on how you set up the system, editors may also be able to preview the live site page content within the administration interface.</p></div>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/9f0402c0-1200-4934-990f-9dbb0195664f/mvc-creating-doctor-section-3.png","alt":"mvc-creating-doctor-section-3.png"},"strapline":""},{"title":"","body":"<p>In Step 3, click the<strong>&nbsp;New field</strong>&nbsp;button and fill in the following values:</p>\n<ul>\n  <li><strong>Field name</strong>: Title</li>\n  <li><strong>Required</strong>: (enabled)</li>\n  <li><strong>Field caption</strong>: Title</li>\n</ul>\n<p>Leave the default values in the other field settings, and hit&nbsp;<strong>Save</strong>. The wizard creates a new&nbsp;<em>Title </em>text field in your page type.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/4385961e-0360-4d66-9ae6-15340c072abb/MVCCreatingPageTypesDoctorSection4.png","alt":"MVCCreatingPageTypesDoctorSection4.png"},"strapline":""},{"title":"","body":"<p>In Step 4, make sure the default&nbsp;<strong>Page name source</strong>&nbsp;value is set to&nbsp;<em>Title</em>, and click the&nbsp;<strong>Next</strong>&nbsp;button.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/c940e12c-fc01-4eb9-9221-d6079593b8d9/MVCCreatingPageTypesDoctorSection5.png","alt":"MVCCreatingPageTypesDoctorSection5.png"},"strapline":""},{"title":"","body":"<p>In Step 5, leave <em>Root (CMS.Root) </em>as the only allowed parent page type and click <strong>Next</strong>.</p>\n<div class=\"infobox note\"><p>You can later change the allowed parent and child page types on the page type's <strong>Allowed types </strong>tab.</p></div>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/2d25abf7-267a-481b-839b-1df38bffcaa7/MVCCreatingPageTypesDoctorSection6.png","alt":"MVCCreatingPageTypesDoctorSection6.png"},"strapline":""},{"title":"","body":"<p>In Step 7, the wizard informs you of the actions it has performed. Click the&nbsp;<strong>Finish</strong>&nbsp;button to complete the page type wizard.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/8228ec0b-01e7-4758-bbb7-72b2b37b8ddc/CreatingPageTypes12.png","alt":"CreatingPageTypes12.png"},"strapline":""},{"title":"","body":"<p>On the page type's&nbsp;<strong>General</strong>&nbsp;tab, set the following values:</p>\n<ul>\n  <li><strong>URL pattern</strong>: /{%DocumentCulture%}/Doctors</li>\n  <li><strong>Page type icon:</strong><em>&nbsp;icon-box</em></li>\n  <li><strong>Use Page tab: </strong><em>(enabled)</em></li>\n</ul>\n<p>Click&nbsp;<strong>Save</strong>.</p>\n<p>Using this page type, your editors will now be able to create the <em>Doctor</em> section, which will hold all the pages representing individual doctors.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/9ed58a78-a57d-4149-b324-9b2681407833/mvc-creating-doctor-section-7.png","alt":"mvc-creating-doctor-section-7.png"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrative","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"113c2376-4a6d-4141-b4f3-9b0dfb7f3e2c","_parentId":"fec9f756-bf0f-4695-a0ab-d9201071050b","_type":"component","title":"Demo: Creating the Doctor Section","displayTitle":"Demo: Creating the Doctor Section"},{"body":"<p>Your editors will create new pages in the content tree using the available page types. You can create new or adjust existing page types in the <strong>Page types </strong>application.</p>\n<p>The following step-by-step demo demonstrates the creation of the <strong>Doctor</strong> page type, which will hold information about doctors working for the Medio Clinic. The demo shows you how to set various values for fields in the new page type wizard, such as the data type or form control.</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>To create a new page type, click the <strong>New page type</strong> button.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/047207c1-1fa2-419e-af7f-73ccb3df0564/mvc-creating-page-types-1.png","alt":"mvc-creating-page-types-1.png"},"strapline":""},{"title":"","body":"<p>In Step 1, fill in the following values:</p>\n<ul>\n  <li><strong>Page type display name</strong>: Doctor</li>\n  <li><strong>Namespace</strong>: MedioClinic</li>\n  <li><strong>Name</strong>: Doctor</li>\n</ul>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/4ee278f0-6c7b-4bb3-83b6-ff93fc3beeb9/mvc-creating-doctor-page-type-2.png","alt":"mvc-creating-doctor-page-type-2.png"},"strapline":""},{"title":"","body":"<p>In Step 2, leave the default values.&nbsp;</p>\n<div class=\"infobox note\"><p>Make sure the <strong>Content-only page type</strong> checkbox is selected. This ensures that any pages based on this page type will be content-only. That means the pages will hold data added by editors, support workflows and versioning, but will not necessarily represent an actual page on the live site. Depending on how you set up the system, editors may also be able to preview the live site page content within the administration interface.</p></div>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/0e4c308d-18dc-4dc5-aeba-ac09c11ebe63/mvc-creating-doctor-page-type-3.png","alt":"mvc-creating-doctor-page-type-3.png"},"strapline":""},{"title":"","body":"<p>In Step 3, click the<strong> New field</strong> button and fill in the following values:</p>\n<ul>\n  <li><strong>Field name</strong>: FirstName</li>\n  <li><strong>Required</strong>: (enabled)</li>\n  <li><strong>Field caption</strong>: First name</li>\n</ul>\n<p>Leave default values in the other field settings, and hit <strong>Save</strong>. The wizard creates a new <em>FirstName</em> text field in your page type.</p>\n<p>Repeat the same process and create fields which will hold values for the doctor's last name, degree, and specialty.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/557b15fd-125c-4378-aff6-286493ec6cfc/mvc-creating-doctor-page-type-4.png","alt":"mvc-creating-doctor-page-type-4.png"},"strapline":""},{"title":"","body":"<p>To create a field which will hold a doctor's profile image, create a new field with the following values:</p>\n<ul>\n  <li><strong>Field name</strong>: Photo</li>\n  <li><strong>Data type</strong>: File</li>\n  <li><strong>Required</strong>: (enabled)</li>\n  <li><strong>Field caption</strong>: Photo</li>\n</ul>\n<p>Leave default values in the other field settings, and <strong>Save</strong> the field. You can use the <strong>Up </strong>arrow next to the <strong>Delete</strong> button to move the <strong>Photo</strong> field above the <strong>Specialty </strong>field.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/bdc71667-5c4e-4572-a776-79e44a1595f6/mvc-creating-doctor-page-type-5.png","alt":"mvc-creating-doctor-page-type-5.png"},"strapline":""},{"title":"","body":"<p>To add a field which will hold a doctor's biography, click the <strong>New field</strong> button and fill in the following values:</p>\n<ul>\n  <li><strong>Field name</strong>: Bio</li>\n  <li><strong>Data type</strong>: Long text</li>\n  <li><strong>Required</strong>: (disabled)</li>\n  <li><strong>Field caption</strong>: Bio</li>\n</ul>\n<div class=\"infobox note\"><p>The <strong>Long text</strong> data type automatically selects the <strong>Rich text</strong> <strong>editor</strong> form control. This means your website editors will be able to style the text, e.g., use bolding or italics, format text as headings, or create lists and hyperlinks.</p></div>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/99efaa96-c382-428a-8d5e-506178c4d019/mvc-creating-doctor-page-type-6.png","alt":"mvc-creating-doctor-page-type-6.png"},"strapline":""},{"title":"","body":"<p>The field for a doctor's emergency shift will use a drop-down list editing interface. To create it, click <strong>New field</strong> and fill in the following values:</p>\n<ul>\n  <li><strong>Field</strong> <strong>name</strong>: EmergencyShift</li>\n  <li><strong>Data type</strong>: Integer number</li>\n  <li><strong>Required</strong>: (enabled)</li>\n  <li><strong>Field caption</strong>: Emergency shift</li>\n</ul>\n<p><em>(Continues on the next page)</em></p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/d0e2540c-0282-4558-b2cf-54879c4cc10a/mvc-creating-doctor-page-type-7.png","alt":"mvc-creating-doctor-page-type-7.png"},"strapline":""},{"title":"","body":"<p><em>(DoctorEmergencyShift field - continued)</em></p>\n<ul>\n  <li><strong>Form control</strong>: Drop-down list</li>\n  <li><strong>Data source</strong>: select the <em>List of options</em> radio button</li>\n  <li><strong>Data source</strong> text area:&nbsp;<br>\n1;Monday<br>\n2;Tuesday<br>\n3;Wednesday<br>\n4;Thursday<br>\n5;Friday<br>\n6;Saturday<br>\n7;Sunday</li>\n</ul>\n<p>Click <strong>Save</strong>.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/59a9fe32-f00a-47c4-b966-cf0655c0f660/mvc-creating-doctor-page-type-8.png","alt":"mvc-creating-doctor-page-type-8.png"},"strapline":""},{"title":"","body":"<p>In Step 4, change the default <strong>Page name source</strong> value to <em>LastName</em>, and click the <strong>Next</strong> button.</p>\n<div class=\"infobox note\"><p>You can later change the <em>page name </em>and <em>page alias </em>source fields on the page type's <strong>Fields</strong> tab.</p></div>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/be43688b-ca31-401b-8ff8-0aba0b658b28/mvc-creating-doctor-page-type-9.png","alt":"mvc-creating-doctor-page-type-9.png"},"strapline":""},{"title":"","body":"<p>In Step 5, select the <em>Root (CMS.Root)</em> allowed parent page type and click the <strong>Remove selected</strong> button. Then use the <strong>Add page types</strong> button and select <em>Doctor Section</em> <em>(MedioClinic.DoctorSection)</em> from the list of available page types. This will ensure that editors can create pages with the Doctor page type only under the <em>Doctor Section</em> page type.&nbsp;</p>\n<div class=\"infobox note\"><p>You can later change the allowed parent and child page types on the page type's <strong>Allowed types </strong>tab.</p></div>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/88d12c54-2cfb-48cd-a381-eb9c80770fe8/mvc-creating-doctor-page-type-10.png","alt":"mvc-creating-doctor-page-type-10.png"},"strapline":""},{"title":"","body":"<p>In Step 6, leave the default site (<em>MedioClinic</em>) and click the <strong>Next</strong> button.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/564d0f33-13e6-4fac-b5c4-e3779e566b48/CreatingPageTypes11.png","alt":"CreatingPageTypes11.png"},"strapline":""},{"title":"","body":"<p>In Step 7, the wizard informs you of the actions it has performed. Click the&nbsp;<strong>Finish</strong>&nbsp;button to complete the page type wizard.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/8228ec0b-01e7-4758-bbb7-72b2b37b8ddc/CreatingPageTypes12.png","alt":"CreatingPageTypes12.png"},"strapline":""},{"title":"","body":"<p>On the page type's <strong>General</strong> tab, set the following values:</p>\n<ul>\n  <li><strong>URL pattern</strong>: &nbsp;/{%DocumentCulture%}/Doctors/Detail/{%NodeGUID%}/{%NodeAlias%}</li>\n  <li><strong>Page type icon:</strong><em> icon-user-frame</em></li>\n  <li><strong>Use Page tab:</strong><em> (enabled)<br>\n</em></li>\n</ul>\n<figure data-asset-id=\"49c6b791-94ba-4842-904b-a72f54758477\" data-image-id=\"49c6b791-94ba-4842-904b-a72f54758477\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/63b4eaec-acb7-4270-9fd8-88869dcee4f2/usePagetabcheckbox.png\" data-asset-id=\"49c6b791-94ba-4842-904b-a72f54758477\" data-image-id=\"49c6b791-94ba-4842-904b-a72f54758477\" alt=\"\"></figure>\n<p>Click <strong>Save</strong>.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/fd723799-55ab-4f5d-a10c-4029729f70b9/mvc-creating-page-types-13.png","alt":"mvc-creating-page-types-13.png"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrative","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"c5f16856-e5e1-454a-bdc3-7afe75f734ef","_parentId":"fec9f756-bf0f-4695-a0ab-d9201071050b","_type":"component","title":"Demo: Creating Doctor page types","displayTitle":"Demo: Creating Doctor page types"},{"body":"<p>To add some pages based on the page types you have just created, switch to the <strong>Pages </strong>application. You can add pages using the <strong>New </strong>button above the content tree. Clicking the button displays a list of page types that are available for creating pages within your current location (under the selected page in the content tree).</p>\n<p>The following animation shows adding of the <strong>Home </strong>page based on the<em> Home Section </em>page type.</p>\n<figure data-asset-id=\"6404d82c-c851-429a-9ef3-48cc1107d27e\" data-image-id=\"6404d82c-c851-429a-9ef3-48cc1107d27e\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/15ad0929-ca57-46aa-bc1f-fed16d6dbcfa/mvc-adding-content-to-pages.gif\" data-asset-id=\"6404d82c-c851-429a-9ef3-48cc1107d27e\" data-image-id=\"6404d82c-c851-429a-9ef3-48cc1107d27e\" alt=\"\"></figure>\n<p>You can repeat the same process and add the rest of the website's content. If youve cloned the <a href=\"https://github.com/Kentico/training-kentico-k12/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>GitHub</em></a> repository, restored the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Db/MedioClinic.zip\"><em>MedioClinic.bak</em></a> file to your database server and built the <em>WebApp.sln</em> solution, you should also be able to inspect the content of all pages in the <em>Pages</em> application of the Kentico administration application.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":false},"_isOptional":false,"_classes":"","_id":"f452a8d8-480f-4b17-9320-fa7bb2780de2","_parentId":"60f3a18a-c122-4ca0-802a-feff99c9c2d6","_type":"component","title":"Demo: Adding content to pages","displayTitle":"Demo: Adding content to pages"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Select the true statement about content-only page types and pages created from them.</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p>Pages based on content-only page types directly represent individual pages on the live site. That's why they are suitable for MVC sites.</p>","_shouldBeSelected":false,"feedback":"<p>No, content-only pages do not always correspond to pages on the live site. The presentation of the stored content is handled by MVC views on the live site, and that's one of the reasons why they are suitable for MVC sites.</p>"},{"text":"<p>Content-only pages are based on traditional Portal Engine page templates.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. Content-only pages are not based on templates. They provide a simple field-based editing structure for content, and their presentation is handled by corresponding MVC views on the live site.</p>"},{"text":"<p>Content-only page types store data within defined fields and allow editors to create pages in the content tree in the Pages application.</p>","_shouldBeSelected":true,"feedback":""},{"text":"<p>Content-only pages do not support workflow and versioning.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. You can apply workflows and versioning to pages based on content-only page types, and that's one of the reasons they are suitable for storing the content of MVC sites.</p>"}],"_feedback":{"title":"","correct":"<p>Correct! Content-only page types store data within defined fields, and editors use them to create pages in the Pages application.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"2c397d75-743c-4a1f-b77b-cd18a3878809","_parentId":"b1c6ccca-9ad0-4c5a-bdf1-f91c884e5051","_type":"component","title":"Progress-check: Content-only page types","displayTitle":"Progress-check: Content-only page types"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Select which statement about the URL patterns of content-only page types is <strong>NOT </strong>true.</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p>You need to specify the URL pattern to allow editors to create hyperlinks to pages of the given type using the built-in editor.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. This is one of the true statements.</p>"},{"text":"<p>The URL pattern allows editors to preview pages in the content tree.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. This is one of the true statements.</p>"},{"text":"<p>Having a defined URL pattern makes it possible for editors to open specific pages on the live site by clicking the Live site button in the application list of the administration interface.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. This is one of the true statements.</p>"},{"text":"<p>All content-only page types need to have a specified URL pattern.</p>","_shouldBeSelected":true,"feedback":""}],"_feedback":{"title":"","correct":"<p>Correct. Not all content-only page types need to have a URL pattern. For example, you don't need to specify the URL pattern for page types meant to store partial content, which is then aggregated on another page.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"18b94a35-2ff9-42ea-a5fd-868a5aead590","_parentId":"b1c6ccca-9ad0-4c5a-bdf1-f91c884e5051","_type":"component","title":"Progress-check: Url Pattern","displayTitle":"Progress-check: Url Pattern"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Select which statement is <strong>NOT </strong>true about the database tables used to store page content.</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p>The CMS_Document database table stores content defined by editors through the page builder.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. This statement is correct.</p>"},{"text":"<p>The CMS_Tree table stores information about the positions of pages within the content tree.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. This statement is correct.</p>"},{"text":"<p>The system creates a separate CMS_Tree and &nbsp;CMS_Document table for each culture in which the site's content is available, e.g., there are CMS_Tree_EN and CMS_Tree_ES tables to handle English and Spanish cultures.</p>","_shouldBeSelected":true,"feedback":""},{"text":"<p>The data added by content editors into page fields is stored within a different database table for each page type.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. This statement is correct. The values of page fields are stored in a dedicated \"coupled data\" table for each page type.</p>"}],"_feedback":{"title":"","correct":"<p>Correct. Only one CMS_Tree and one CMS_Document table exists in the Kentico database. The CMS_Document table stores a separate record for each culture version of a page, and the CMS_Tree records are not affected by cultures.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"c041e122-5e28-46a7-a875-56e4f71a04ef","_parentId":"b1c6ccca-9ad0-4c5a-bdf1-f91c884e5051","_type":"component","title":"Progress-check: Database tables","displayTitle":"Progress-check: Database tables"},{"body":"<p>Congratulations on completing the second section of the course! You now know how Kentico stores data in the content tree. You have also prepared the content of your training website.</p>\n<p>You have learned:</p>\n<ul>\n  <li>About content-only pages types and their underlying database structure</li>\n  <li>How to create page types with various types of fields and form controls</li>\n  <li>How to add and manage the website's content in the Pages application</li>\n</ul>\n<p>Ready to go to the next section and learn about setting up multilingual content in the administration interface? <strong>Click the back button&nbsp;</strong>(<strong>&lt;</strong>)<strong>&nbsp;in the top left, and continue with the course!</strong></p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"6c7cde2b-afe5-4dde-90aa-7c21bff8387e","_parentId":"2faa3738-5ab3-4575-af69-dc265388b086","_type":"component","title":"Conclusion","displayTitle":"Conclusion"},{"body":"<p>What you will learn in this section:</p>\n<ul>\n  <li>How <strong>localization</strong> and <strong>multilingual content</strong> work in the <strong>administration interface</strong> for the Kentico MVC development model</li>\n  <li>What <strong>options</strong> you can use to <strong>translate website content</strong></li>\n  <li>How editors add <strong>language variants of pages</strong></li>\n</ul>\n<p>You will work on:</p>\n<ul>\n  <li>Assigning a Spanish culture to your website in the administration interface</li>\n  <li>Adding the Medio Clinic <em>Home </em>page in the Spanish culture</li>\n  <li>Adding resource strings to localize short texts displayed on the website</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"fecb5c20-4cd3-40ce-a850-e377f6b76602","_parentId":"d0c5167b-4a92-424b-b997-2b1107a4c6cf","_type":"component","title":"Introduction","displayTitle":"Introduction"},{"body":"<h2>Multicultural MVC websites</h2>\n<p>The Kentico MVC development model allows running of multicultural websites. It provides a rich feature set and makes it easy to manage and serve content in different languages (cultures), both in the administration interface and on the live site. Kentico supports several approaches to localization, from long structured content stored as pages, to short, individual strings which for example serve as captions or title elements displayed in the footer of your website.</p>\n<h2>Localizing content of pages</h2>\n<p>Before website editors can start localizing content, developers or administrators need to assign the required cultures to the site (this can be done in the <strong>Sites</strong> application). By default, the system contains all commonly used cultures, but you can extend the list in the <strong>Localization</strong> application on the <strong>Cultures</strong> tab if necessary. These cultures do not automatically provide any actual translations of text, they only determine which language/culture options are available for the website.</p>\n<p>Multilingual content of pages can be managed in the <strong>Pages</strong> application. A site with multiple cultures stores different language variants of content in separate versions of pages in the content tree. The website editors can translate content themselves, or they can use connectors to translation services and assign translation tasks to get the content in the languages they need.</p>\n<h3>Available translation services</h3>\n<p>The integrated translation services take content prepared in one language and create its variant in another language. To create the multilingual website, the \"translators\" don't need to edit the text in the Kentico administration interface. Kentico automatically ensures data transfer between the website pages and translation providers in the standardized XLIFF format.</p>\n<p>Machine services programmatically convert source text from one language to another (by default, Kentico provides services for <strong>Microsoft Translator</strong> and <strong>Google Translate</strong>). You can also connect your website to human translation services, such as the default <strong>Translations.com</strong> service. However, you are not limited to these three services. Kentico is a highly-customizable solution, and you can develop <a href=\"https://docs.kentico.com/k12/multilingual-websites/developing-custom-translation-services\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">custom translation services</a>.</p>\n<p>The system also provides manual translation services that allow editors to <strong>send content for translation via email</strong>, or <strong>export the translation data</strong> to the file system. In both cases, the export package contains <em>.xlf</em>&nbsp;files.&nbsp;Once the content is translated, the packages need to be imported back to the system manually.</p>\n<p>Find out more about how <a href=\"https://docs.kentico.com/k12/multilingual-websites/configuring-translation-services/human-translation-services-email-translation\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">email</a> and <a href=\"https://docs.kentico.com/k12/multilingual-websites/configuring-translation-services/human-translation-services-manual-translation\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">manual</a> translation services work or how you can <a href=\"https://docs.kentico.com/k12/multilingual-websites/configuring-translation-services\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">configure the translation services</a> in our documentation.</p>\n<h2>Editing multicultural content in the Pages application</h2>\n<p>With a correctly set <strong>URL pattern</strong> for page types, website editors can preview the default and other culture versions of pages in the content tree. Depending on the culture they are editing, website editors can also assign different workflows and submit different culture variants of the pages to culture-specific approval processes.</p>\n<div class=\"infobox note\"><p>In the training website for this course, we use the <em>{%DocumentCulture%}</em> macro in page type URL patterns. This macro resolves into the culture code of the language selected in the Pages application, which ensures that the URL contains a culture prefix and the correct language variant is displayed in the preview.</p></div>\n<h2>Localizing individual strings on the website</h2>\n<p>Not all content on the website needs to be stored in the <strong>Pages </strong>application. Reusable pieces of text, like contact details, captions, titles, or other individual strings on the live site don't need to be added or edited in the website's content tree.</p>\n<p>With the Kentico MVC development model, you can use the standard .NET approach and localize individual pieces of text using resource strings, stored in either <em>.resx</em> files or the database.</p>\n<div class=\"infobox note\"><p>If you are not familiar with the .NET concept of <strong>string resources</strong>, they are simple <em>key/value pairs</em> of string data. Each key can have a different value for a specific culture.</p>\n<p>With Kentico you can add the string keys into your website's content, either by using special expression within text, or by calling the appropriate API in code. The strings then resolve into the correct value based on the relevant culture context.</p></div>\n<h3>Working with resource strings</h3>\n<p>Storing resource strings within resource files has a considerable disadvantage: if you - or even the website editors - want to change anything on a running production site, you need to update the related strings in the files, and then redeploy the website.</p>\n<p>Kentico provides you with a great option - editors can manage resource strings directly in the administration interface. Editors with special permissions (<strong>Localize strings </strong>permission for the <strong>Localization</strong> module) can create the strings in the <strong>Localization </strong>application on the <strong>Resource strings</strong> tab. Kentico stores strings added through the administration interface in the website's database (in the <em>CMS_ResourceString</em> and <em>CMS_ResourceTranslation</em> tables).&nbsp;</p>\n<p>You can combine both approaches and the system loads resource strings from all available sources (by default, strings in the database have priority over strings in resource files).</p>\n<p>Find out more about working with resource strings in the Kentico <a href=\"https://docs.kentico.com/k12/multilingual-websites/setting-up-a-multilingual-user-interface/working-with-resource-strings\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">documentation</a>.</p>\n<h2>Localizing the administration interface</h2>\n<p>Kentico also provides the option to localize the administration interface, so that users feel at home when working with their website. Users can set the culture of the admin UI in their profiles. The interface culture determines not only the language of text in the interface, but also other factors like numeric and date formats.&nbsp;</p>\n<p>By default, the Kentico installation only provides an English (\"en-us\" culture) pack for the user interface texts. However, you can obtain packs for other languages from the Kentico community, or prepare your own translations of the used resource files.</p>\n<p>Kentico allows for managing content in any language, including double-byte (eastern) languages, such as Chinese. All content is stored and published in Unicode.</p>\n<p>Find out more about setting up a multicultural UI in our&nbsp;<a href=\"https://docs.kentico.com/k12/multilingual-websites/setting-up-a-multilingual-user-interface\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">documentation</a>.</p>\n<h2>Serving multicultural content on the live site</h2>\n<p>Adding culture-specific routes, setting the current culture context, and retrieving multicultural page content through the Kentico API will be covered later in the course. So let's just get a basic overview to complete the picture of how Kentico MVC websites handle multicultural content.</p>\n<ul>\n  <li>The MVC development model allows creating of URLs with culture prefixes, which can help your website with SEO.</li>\n  <li>You can develop functionality that allows site visitors to manually switch between languages.</li>\n  <li>You need to ensure that you load the correct culture versions of pages when retrieving content in your website's code.</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"fbe8ccba-374c-4e9f-8b62-3ab667e4e3a6","_parentId":"99c87c4a-fca6-4690-9792-bd2014da7713","_type":"component","title":"Multicultural sites","displayTitle":"Multicultural sites"},{"body":"<h2>1. Adding a culture to the Medio Clinic site</h2>\n<p>Before you start adding language variants of the Medio Clinic website's pages, you need to assign the required culture to the site. For the purposes of this training course, you will be working with the Spanish culture.</p>\n<p>At the end of the first part of this exercise, your <em>Site</em>'s <strong>Cultures</strong> tab should look like the following screenshot:</p>\n<figure data-asset-id=\"81fa3e4b-ac52-4749-9ff6-b3f1e665898a\" data-image-id=\"81fa3e4b-ac52-4749-9ff6-b3f1e665898a\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/5defb21c-239e-4feb-b865-f8e473f129b3/mvc-adding-culture-task-final.png\" data-asset-id=\"81fa3e4b-ac52-4749-9ff6-b3f1e665898a\" data-image-id=\"81fa3e4b-ac52-4749-9ff6-b3f1e665898a\" alt=\"\"></figure>\n<h2>2. Adding the Spanish version of the Home page</h2>\n<p>With the culture assigned to your website, you can start adding language variants to the pages in the content tree. Create a Spanish version of the Home page and the child Medio Clinic service pages, with content based on the sections below. (If you are not sure how to do it, take a look at the demo below.)</p>\n<p>You can download all the text for the Home page, Service pages and the resource strings (following part) in the <a data-asset-id=\"3d840b49-701a-4f6c-9b6b-01cafe097a54\" href=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/3edc9277-7334-4f42-94de-bf00f5bbb7bb/medio-clinic-spanish-texts.zip\">medio-clinic-spanish-texts.zip</a> package.</p>\n<h3>Home page</h3>\n<p><strong>Name</strong>: <em>Inicio</em></p>\n<p><strong>Title</strong>: <em>Bienvenidos a Medio clinic</em></p>\n<p><strong>Text</strong>: <em>El objetivo de nuestra clnica es brindar la mejor atencin mdica. Para una salud integral en todo momento, tambin es necesario mantener un estilo de vida saludable.</em></p>\n<p><strong>Link button text</strong>: <em>Nuestros doctores</em></p>\n<h3>Service pages</h3>\n<h4>Cardio Therapy</h4>\n<p><strong>Header</strong>: <em>Terapia de cardio</em></p>\n<p><strong>Icon</strong>: cardio-therapy.png</p>\n<p><strong>Text</strong>: <em>Nuestros cardilogos expertos le brindan las herramientas que necesita para vivir una vida saludable. Nos comprometemos a ayudar a nuestros pacientes a recuperar el ms alto nivel de salud cardiovascular, rendimiento y bienestar.</em></p>\n<h4>Emergency services</h4>\n<p><strong>Header</strong>: <em>Servicios de emergencia</em></p>\n<p><strong>Icon</strong>: emergency-services.png</p>\n<p><strong>Text</strong>: <em>Abierto todos los das, las 24 horas, ofrecemos una gama completa de servicios mdicos de emergencia para miles de pacientes cada ao. Nuestro galardonado Departamento de Emergencia est dirigido por un equipo de mdicos destacados, enfermeras altamente calificadas y profesionales de la salud que operan en instalaciones de ltima generacin.</em></p>\n<h4>Medical Consultancy</h4>\n<p><strong>Header</strong>: <em>Consultoria Medica</em></p>\n<p><strong>Icon</strong>: medical-consultancy.png</p>\n<p><strong>Text</strong>: <em>Con nuestra amplia gama de expertos en la materia, creemos MEDIO clinic puede proporcionar soluciones innovadoras y economicas, servicios y conocimientos que se requieren para sus necesidades de atencin mdica. Nuestro equipo mdico actualmente consiste de 20 mdicos certificados por la junta con amplia experiencia en sus campos.</em></p>\n<p>At the end of this part of the exercise, the Home page and its child pages should have their Spanish variant. Your content tree should look like the following screenshot:</p>\n<figure data-asset-id=\"ef17da9e-a5ff-4cfc-80a7-1b9c625d7abf\" data-image-id=\"ef17da9e-a5ff-4cfc-80a7-1b9c625d7abf\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/a1fb5cb5-2d8f-4b5f-b6e2-d00ca2b051fc/mvc-adding-language-variant-task-final.png\" data-asset-id=\"ef17da9e-a5ff-4cfc-80a7-1b9c625d7abf\" data-image-id=\"ef17da9e-a5ff-4cfc-80a7-1b9c625d7abf\" alt=\"\"></figure>\n<h2>3. Adding the resource strings</h2>\n<p>To localize short texts used within the site's general layout, add the following resource strings. &nbsp;(If you are not sure how to do it, take a look at the demo below.)</p>\n<h3>Follow Us</h3>\n<p><strong>Key</strong>: Footer.FollowUs<br>\n<strong>English - United States (default)</strong>: Follow Us<br>\n<strong>Spanish - Spain</strong>: Siguenos</p>\n<h3>Contact</h3>\n<p><strong>Key</strong>:&nbsp;Footer.Contact<br>\n<strong>English - United States (default)</strong>: Contact<br>\n<strong>Spanish - Spain</strong>: Contacto</p>\n<h3>Email</h3>\n<p><strong>Key</strong>:&nbsp;Footer.Email<br>\n<strong>English - United States (default)</strong>: E-mail<br>\n<strong>Spanish - Spain</strong>: Correo electronico (e-mail)</p>\n<h3>Navigation</h3>\n<p><strong>Key</strong>:&nbsp;Footer.Navigation<br>\n<strong>English - United States (default)</strong>: Navigation<br>\n<strong>Spanish - Spain</strong>: Navegacion</p>\n<h3>Phone</h3>\n<p><strong>Key</strong>:&nbsp;Footer.Phone<br>\n<strong>English - United States (default)</strong>: Phone number<br>\n<strong>Spanish - Spain</strong>: Numero de telefono</p>\n<h3>Built-with disclaimer</h3>\n<p><strong>Key</strong>:&nbsp;Footer.BuildWithNote&nbsp;</p>\n<p><strong>English - United States (default)</strong>: Built with &lt;a href=\"http://materializecss.com\"&gt;Materialize&lt;/a&gt; for the MVC Developer training.<br>\n<strong>Spanish - Spain</strong>: Construido con &lt;a href=\"http://materializecss.com\"&gt;Materialize&lt;/a&gt; para el entrenamiento de desarrollador MVC.</p>\n<p>At the end of the third part of the exercise, your resource strings in the <strong>Localization </strong>application should like the following:</p>\n<figure data-asset-id=\"1b6d55ca-04df-4a1a-a9bd-b1f193e6db93\" data-image-id=\"1b6d55ca-04df-4a1a-a9bd-b1f193e6db93\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/12b3340b-45f6-4ecf-a12f-c056f8847e56/mvc-adding-resource-strings-task-final.png\" data-asset-id=\"1b6d55ca-04df-4a1a-a9bd-b1f193e6db93\" data-image-id=\"1b6d55ca-04df-4a1a-a9bd-b1f193e6db93\" alt=\"\"></figure>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"641540f9-b2e1-43c3-a5ce-fc3a97ae0df3","_parentId":"c364abe4-3b7f-46ef-beeb-07fd159dd19f","_type":"component","title":"Task: Adding the multilingual content","displayTitle":"Task: Adding the multilingual content"},{"body":"<p>The following animation shows how to add a website culture in the <strong>Sites </strong>application. Alternatively, you can assign cultures to sites in the <strong>Localization</strong> application on the <strong>Cultures </strong>tab.</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>To assign another culture to your website:</p>\n<ol>\n  <li>Open the <strong>Sites</strong> application.</li>\n  <li>Edit your site.</li>\n  <li>Switch to the <strong>Cultures</strong> tab and click the <strong>Add cultures </strong>button.</li>\n  <li>Search for the culture you want to add. You can search for the language name, such as \"<em>Spanish</em>\" or \"<em>English</em>\", or for a specific culture localization, e.g., \"S<em>pain</em>\".</li>\n  <li>Select the culture and click the <strong>Select </strong>button to add the culture to your website.</li>\n</ol>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/3026daf4-9ba9-40aa-8968-88d39358b742/mvc-adding-culture-to-site.gif","alt":"mvc-adding-culture-to-site.gif"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrative","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"fb06cbb9-305b-486c-a4a7-4500d637e97f","_parentId":"4b9953ad-7a7e-4ab1-a95b-2d06ec52a956","_type":"component","title":"Demo: Adding a site culture","displayTitle":"Demo: Adding a site culture"},{"body":"<p>The following demo shows how to add a Spanish version of the <strong>Home</strong> page in the <strong>Pages</strong> application.</p>\n<p><br></p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<ol>\n  <li>In the <strong>Pages</strong> application, select the page you want to translate to another culture, i.e., the <strong>Home </strong>page.</li>\n  <li>Click the <strong>Culture selector</strong> below the content tree and select the <em>Spanish </em>culture in the menu.</li>\n</ol>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/ffbbfb76-13ff-40d8-8f08-eb0a4b910760/mvc-adding-spanish-page-variant1.png","alt":"mvc-adding-spanish-page-variant1.png"},"strapline":""},{"title":"","body":"<p>Select the <em>Create empty page</em> option and click the <strong>Create page</strong> button.&nbsp;</p>\n<div class=\"infobox note\"><p>When creating a culture version of a page, the following options are available:</p>\n<ul>\n  <li><strong>Create empty page</strong> - creates a new page of the same type, but without any content. The system creates the page version only after you save the new content for the first time.</li>\n  <li><strong>Copy content from another language</strong> - creates a copy of the page and populates it with content from the selected language version, e.g., English. If you select the <em>Save the new page before editing</em> check box, Kentico adds the new page immediately with the copied content. Until editors create and publish new content in the desired language, the copied content will be displayed on the live site when visitors request the given culture version of the page.</li>\n  <li><strong>Translate using translation service</strong> - the content of the language version will be provided by an external translation service. See how you can configure translation services for your website in our <a href=\"https://docs.kentico.com/k12/multilingual-websites/configuring-translation-services\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">documentation</a>.</li>\n</ul></div>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/a01cf931-7df3-4bb3-aa7d-29283de93cee/mvc-adding-spanish-page-variant2.png","alt":"mvc-adding-spanish-page-variant2.png"},"strapline":""},{"title":"","body":"<p>Note the <em>status icon</em> next to the page in the content tree which shows that the page doesn't exist yet. Fill in the fields with the following values:</p>\n<p><strong>Name</strong>: <em>Inicio</em></p>\n<p><strong>Title</strong>: <em>Bienvenidos a Medio clinic</em></p>\n<p><strong>Text</strong>: <em>El objetivo de nuestra clnica es brindar la mejor atencin mdica. Para una salud integral en todo momento, tambin es necesario mantener un estilo de vida saludable.</em></p>\n<p><strong>Link button text</strong>: <em>Nuestros doctores</em></p>\n<div class=\"infobox warning\"><p>If you are copying the text to your website from the course, paste the text into the administration interface as plain text, e.g., using <em>Ctrl+Shift+V </em>or using the Source button in the WYSIWYG editor. Otherwise, you will copy the styling from the e-learning course, which may lead to inconsistency on the live site.</p></div>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/e401dd21-597e-4fad-9cce-27c5716aae7e/mvc-adding-spanish-page-variant3.png","alt":"mvc-adding-spanish-page-variant3.png"},"strapline":""},{"title":"","body":"<p>Click the <strong>Save</strong> button.</p>\n<p>The system creates the Spanish version of the <em>Home</em> page in the content tree with <em>Inicio</em>&nbsp;as the page name. The status of the page has changed to <em>published.</em></p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/04176e79-f2ce-4b29-ac0b-d72369d5cf7f/mvc-adding-spanish-page-variant4.png","alt":"mvc-adding-spanish-page-variant4.png"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrative","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"7c5680c5-fbd2-4b72-9e1c-0d03eaab4f4c","_parentId":"4b9953ad-7a7e-4ab1-a95b-2d06ec52a956","_type":"component","title":"Demo: Adding Spanish variant of the Home page","displayTitle":"Demo: Adding Spanish variant of the Home page"},{"body":"<p>The following demo shows how to add a <strong>resource string</strong> (key/value pair). This string will be used to store and translate the text of the \"Address\" caption used in the Medio Clinic site's footer.</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<ol>\n  <li>Navigate to the <strong>Localization </strong>application.&nbsp;</li>\n  <li>On the <strong>Resource strings </strong>tab, click the <strong>New string </strong>button.</li>\n</ol>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/20616efe-6d7c-4579-9592-2074f93e6500/mvc-adding-resource-string1.png","alt":"mvc-adding-resource-string1.png"},"strapline":""},{"title":"","body":"<ol>\n  <li>Fill in the following values:<br>\n<strong>Key</strong>:<em> </em>Footer.Address<em><br>\n</em><strong>English - United States (default)</strong>: Address<em><br>\n</em><strong>Spanish - Spain</strong>: Direccion</li>\n  <li>Click the <strong>Save </strong>button.</li>\n</ol>\n<p>The system creates the resource string and saves it in the database.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/cda38424-af3e-4e12-a284-caa78fbbcd1a/mvc-adding-resource-string2.png","alt":"mvc-adding-resource-string2.png"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrative","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"90ac5339-c456-4baf-bff5-b9acfd1bf303","_parentId":"4b9953ad-7a7e-4ab1-a95b-2d06ec52a956","_type":"component","title":"Demo: Adding resource strings","displayTitle":"Demo: Adding resource strings"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Select the correct option to make the following statement true.</p>\n<p><em>Editors with sufficient permissions can...</em></p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p>choose which cultures are available for the site's content.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong! Only global administrators can assign cultures to sites.</p>"},{"text":"<p>edit resource strings in the admin UI. Strings updated in the UI are saved into resources files within the MVC application's project folder.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong! Resource strings updated in the admin UI are stored in the website's database. Strings stored in resource files cannot be modified from the admin UI (only overridden by adding a string with the same key).</p>"},{"text":"<p>edit resource strings in the admin UI. Resource strings created or updated in the UI are stored in the database.</p>","_shouldBeSelected":true,"feedback":""},{"text":"<p>not edit resource strings used on the website. All strings need to be prepared in resource files before the MVC website is deployed.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong! Kentico allows users to create and edit strings in the admin UI, and stores these strings in the database.</p>"}],"_feedback":{"title":"","correct":"<p>Correct! Editors of websites can work with individual resource strings in the administration interface, and these strings are stored in the database.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"a816a339-e6a9-4198-a810-9d70cd301fab","_parentId":"f6370b4c-ed9c-4b1f-b35c-f03a6f9cd305","_type":"component","title":"Progress check: Resource strings","displayTitle":"Progress check: Resource strings"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Select the correct option to make the following statement true.</p>\n<p><em>To translate their website content, editors...&nbsp;</em></p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p>always need to send the data to an external translation service.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong! Individual language versions of pages can be created and edited directly through the Kentico administration interface in the Pages application.</p>"},{"text":"<p>can use Facebook Translate machine translation by default.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong! To use Facebook Translate machine translation, you need to customize your solution.&nbsp;</p>"},{"text":"<p>can use Google Translate machine translation, which programmatically converts the source text into selected languages.</p>","_shouldBeSelected":true,"feedback":""},{"text":"<p>cannot download the content of pages for manual translation in a standardized format and need to manually convert text, e.g., to XLIFF.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong! Kentico provides an option to download the content of pages for manual translation. The generated .zip file contains the text in standardized .xlif format.</p>"}],"_feedback":{"title":"","correct":"<p>Correct! By default, Kentico provides integration for machine translation via Google Translate and Microsoft Translate services.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"ec93fd20-31d5-412c-a753-41b47186f272","_parentId":"f6370b4c-ed9c-4b1f-b35c-f03a6f9cd305","_type":"component","title":"Progress check: Translation services","displayTitle":"Progress check: Translation services"},{"body":"<p>Congrats! You have learned how to create multicultural sites in Kentico. You also know how the system stores multilingual content, and how you can set up the system to help editors with content translation.</p>\n<p>Hurry up to the next part of the training where you will learn how URL routing works in the Kentico MVC solution.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"68bd7e6c-7f44-488c-a0f6-a8a92ea8a1e3","_parentId":"c061cf2b-a935-419a-a196-359e114648dd","_type":"component","title":"Conclusion","displayTitle":"Conclusion"},{"body":"<p>What you will learn in this section:</p>\n<ul>\n  <li>How routing works for Kentico websites built with the MVC development model</li>\n  <li>The role of page type URL patterns in the Kentico administration (Preview mode and other features)</li>\n  <li>How you can code the site to support multiple cultures</li>\n  <li>What constraints you might want to set for route parameters on Kentico websites</li>\n</ul>\n<p>You will work on:</p>\n<ul>\n  <li>Setting up the site's basic routing</li>\n  <li>Implementing a custom route handler that sets the application's culture context based on the URL</li>\n  <li>Creating constraints on routes so that they accept valid parameters</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"53e96b9d-f9f9-483e-af89-9baaa173da8f","_parentId":"b7febcf7-5510-4635-aad4-a5313cea4850","_type":"component","title":"Intro: Working with URLs and MVC routes","displayTitle":"Intro: Working with URLs and MVC routes"},{"_setCompletionOn":"play","_useClosedCaptions":true,"_allowFullScreen":true,"_media":{"mp4":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/3f3d3a2d-4b6f-4a32-a421-e89ef8132fe8/mvcrouting.mp4","poster":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/6f6ffb02-02b3-4a81-a716-2c4b0f5b7ab0/mvc-routing-thumbnail.png","cc":{"srclang":"en","src":null}},"_transcript":{"_setCompletionOnView":true,"_inlineTranscript":true,"_externalTranscript":false,"inlineTranscriptButton":"Transcript","InlineTranscriptCloseButton":"Close Transcript","inlineTranscriptBody":"<p>Websites built using the Kentico MVC development model run separate applications for the MVC live site and the administration interface. The MVC application uses the Kentico API libraries added through NuGet packages.</p>\n<p>In this video, we will take a high-level look at how URLs and routing work for Kentico MVC websites.</p>\n<p>The live site MVC application responds to incoming requests using standard ASP.NET MVC routing and you can customize it in any way you want.</p>\n<p>For example, you can set the standard LowercaseUrls property of your RouteCollection to ensure consistent and SEO-friendly URLs. Or, you could set a default culture for requests that don't specify one themselves.</p>\n<p>It's likely that your website will contain images which editors upload through the admin interface. Based on the system's settings, the physical files are stored either in the file system or the database, and they can be accessed through HTTP handlers exposed by the Kentico API.</p>\n<p>For example, <em>getmedia</em> and <em>getattachment</em> handlers display images and other file content. To ensure that your MVC application directs incoming file requests to the appropriate handlers, you need to call the Kentico MapRoutes method to register Kentico-specific routes in your MVC application's route table. This will ensure that the images are displayed correctly on the live site. The MapRoutes method also adds routes required by various Kentico MVC features that you enabled for your application.</p>\n<p>Editors working in the admin interface may also want to see what their pages look like, without having to switch to the live site in another browser tab. Remember when I mentioned that both applications run separately? It's the MVC application handles the URLs, and, by default, the&nbsp;admin app doesn't know the live site URLs for pages. Let's take a look at what you can do to help increase the effectiveness of the editors.</p>\n<p>To construct the live site URL of a page in the administration, Kentico needs&nbsp;the hostname of the live site, which is available in the Presentation URL specified in the Sites application, and the URL path which matches the given page's route, as specified in the MVC application's RouteConfig.</p>\n<p>The admin application can't read the MVC application's RouteConfig file, but you can provide the URL path information by setting URL patterns for your page types.</p>\n<p>Let's say that the editor wants to view a page that lists all articles on the live site, which is available under the <em>mylivesite.com/articles</em> URL and served via the <em>articles</em> controller.</p>\n<p>You define the URL pattern of the article's list page type as <em>/Articles.</em> In this case, the pattern matches the controller name, so the resulting URL can be processed by the <em>Default</em> route in the route table.</p>\n<p>When an editor opens the page in the content tree, Kentico combines the site's presentation URL with the URL pattern for the given page, and can then display the resulting live site page in an iframe within the administration interface.</p>\n<p>If you develop a multilingual website and add the&nbsp;<em>DocumentCulture</em>&nbsp;macro into the URL pattern, the system resolves the value into a culture code for each page and returns a culture-specific URL.</p>\n<p>Similarly, if an editor creates a hyperlink to one of the site's pages in the administration interface, the same process is used to get the target page's live URL.</p>\n<p>So now editors can see their pages in the admin interface. However, the preview mode in Kentico should display the latest version of the page&nbsp; which doesn't&nbsp;necessarily have to be published on the live site just yet.</p>\n<p>This can be useful for large editor teams or situations where content needs to be approved across or outside the company before it goes live. For example, if your legal team needs to approve the site first. So, how does the preview mode work?</p>\n<p>As a developer, you need to know in advance that the editors want to use this feature so you can implement it in the MVC application.&nbsp;</p>\n<p>The admin interface builds the preview URLs using the presentation URL and the URL pattern and appends some additional data, namely the culture variant and a hash.</p>\n<p>In the MVC application, code added by the Kentico.AspNet.Mvc integration package validates the attached hash, and updates the Kentico HTTP context with information about the enabled status of preview mode and the name of the requested culture. The URL is then sent down the standard routing process.</p>\n<p>Based on the preview mode status, you can adjust your implementation to either retrieve the latest edited version of pages, or the version published on the live site.</p>\n<p>You already know that URLs in the MVC website are independent of the content structure of pages created in the administration interface. And you also know that editors love to optimize their site's SEO ranking, and tweaking URLs is a big part of that.</p>\n<p>In Kentico, you can implement the site's URLs and routing in a way that gives editors control over a part of the URL. Simply add macros into your URL patterns to include inputs from specific page fields, for example, using the default <em>page alias</em> or a dedicated custom URL field.</p>\n<p>If you need to build the live URLs of pages in your MVC application's code, your implementation can retrieve the appropriate page values from the database.</p>\n<p>What're the key takeaways here?&nbsp;</p>\n<p>The Kentico integration package provides an API that helps you route certain types of URLs to suitable handlers.</p>\n<p>The live site MVC application handles incoming requests through standard MVC routing.</p>\n<p>Be sure to call Kentico routing method before registering more general routes in your RouteConfig. Otherwise, system requests could be directed to your own controllers, which would lead to incorrectly displayed content.</p>\n<p>You can develop websites so editors can influence what the URLs will look like, and are able to</p>\n<p>preview content changes before they publish them to the live site.</p>\n<p>Just make sure you have identified everything your editors want to do with their site&nbsp; and you will build a website they will be more than happy to work with.</p>"},"_playerOptions":{"features":["playpause","progress","current","duration","speed","volume","fullscreen"]},"instruction":"","_layout":"full","_component":"media","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"b62a96f7-27cf-4d9b-92b1-1381a99d737a","_parentId":"cf8e0224-025f-4246-b8b0-fbe5e33af335","_type":"component","title":"Video: Routes and URLs on MVC sites","displayTitle":"Video: Routes and URLs on MVC sites"},{"body":"<p>ASP.NET websites offer you many ways to determine which culture a visitor requests.</p>\n<p>For example, you can identify the culture from a URL language prefix or the site's domain, or store each user's preferred language in their browser. You can also let the ASP.NET framework detect the culture and locale automatically based on the environment of the user's client.</p>\n<p>For websites built using the Kentico MVC development model, we recommend determining the culture using a language prefix in the URLs of incoming requests.</p>\n<p>As a refresher, the ASP.NET framework keeps track of two culture-related values - the <em>Culture</em> and <em>UICulture</em> - which determine things like date formats or currency symbols. The cultures are applied to the current request's active thread and remain active for its lifetime.</p>\n<p>With this information in mind, you can implement functionality which detects and sets the culture properties according to a route parameter.</p>\n<p>Let's review what needs to be covered. First, your solution needs to find the request's culture through a parameter defined in your route templates. Then, you need to use the value to configure the current thread's <em>CurrentCulture</em> property (using an object of the &nbsp;<em>System.Globalization.CultureInfo</em> type).</p>\n<p>The Kentico localization API then automatically works with the given culture, for example when resolving resource strings. You also need to use the culture value to load the correct language version of pages in code that retrieves your website's content (this topic will be covered later in the course).</p>\n<p>Here is a sample implementation from the Dancing Goat sample site. The following is a custom route handler class, which can then be assigned to individual routes in the <em>RouteConfig</em>.</p>\n<pre><code class=\"language-csharp\">using System.Globalization;\nusing System.Threading;\nusing System.Web;\nusing System.Web.Mvc;\nusing System.Web.Routing;\n\nnamespace DancingGoat.Infrastructure\n{\n    /// &lt;summary&gt;\n    /// Creates an object that implements the &lt;see cref=\"IHttpHandler\"/&gt; interface and passes the request context to it.\n    /// Configures the current thread to use the culture specified by the 'culture' URL parameter.\n    /// &lt;/summary&gt;\n    public class MultiCultureMvcRouteHandler : MvcRouteHandler\n    {\n        private readonly CultureInfo defaultCulture;\n\n\n        /// &lt;summary&gt;\n        /// Creates a new instance of the &lt;see cref=\"MultiCultureMvcRouteHandler\"/&gt; class.\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"defaultCulture\"&gt;Culture used when the requested culture does not exist.&lt;/param&gt;\n        public MultiCultureMvcRouteHandler(CultureInfo defaultCulture)\n        {\n            this.defaultCulture = defaultCulture;\n        }\n\n        /// &lt;summary&gt;\n        /// Returns the HTTP handler based on the specified HTTP context. \n        /// &lt;see cref=\"Thread.CurrentCulture\"/&gt; and &lt;see cref=\"Thread.CurrentUICulture\"/&gt; of the current thread are set to the culture specified by the 'culture' URL parameter.\n        /// &lt;/summary&gt;\n        protected override IHttpHandler GetHttpHandler(RequestContext requestContext)\n        {\n            // Gets the requested culture from the route\n            var cultureName = requestContext.RouteData.Values[\"culture\"].ToString();\n\n            CultureInfo culture;\n            try\n            {\n                culture = new CultureInfo(cultureName);\n            }\n            catch\n            {\n                culture = defaultCulture;\n            }\n\n            // Sets the culture\n            Thread.CurrentThread.CurrentUICulture = culture;\n            Thread.CurrentThread.CurrentCulture = culture;\n\n            return base.GetHttpHandler(requestContext);\n        }\n    }\n}</code></pre>\n<p>For larger websites that handle content in several cultures or different locales, you can break down the functionality into even smaller chunks.</p>\n<p>For example, you can implement another custom class which provides the currently active culture, e.g., <em>SiteContextService</em>, and use dependency injection to make it available wherever you need, for example to filter Kentico API calls that retrieve page content. You can find an example of this implementation in the <strong>Demo: Implementing multiple cultures </strong>section on this page.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"6d9957e5-f78d-43d4-b3f8-0fcbc76afcb8","_parentId":"9808c161-0bb2-4327-9c4d-260674b23317","_type":"component","title":"Handling URLs on a multicultural website","displayTitle":"Handling URLs on a multicultural website"},{"body":"<p>The URL routing engine in the MVC application maps incoming requests to a specific controller action. To ensure that only valid URLs match your routes, you can set up some constraints and specify which types of URL parameters are valid. Let's take a look at some of the most common types of route constraints you might want to use on your Kentico MVC website.</p>\n<div class=\"infobox note\"><p>The MVC runtime works in a way that it first tries to match the request to a route just by the URL address. The first route with a matching URL pattern is then further processed and applied. The MVC route constraints are classes that allow you to eventually cancel the application of an already matched route. After the processing of the current route is canceled, the MVC runtime will continue in trying to match other routes. In your route constraint class, youll be able to compare the URL address of the request with the database data and decide whether a given route is suitable for handling the current request.</p></div>\n<h2>Culture constraint</h2>\n<p>Your website will likely support only a limited number of cultures, and your route templates should reflect that. There are a number of possible approaches you can take when defining your site's routing.</p>\n<p>For example, the Kentico API provides you with the <a href=\"http://devnet.kentico.com/docs/12_0/api/html/T_CMS_SiteProvider_CultureSiteInfoProvider.htm\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">CultureSiteInfoProvider</a> class (in the <em>CMS.SiteProvider</em> namespace), and you can call its <em>GetSiteCultures()</em> method to load the cultures assigned to the site in Kentico. This allows you to create a constraint that compares the retrieved culture codes with the culture parameter in the request URL. In cases where the URL does not match the constraint's requirements, you can fall back to a default culture or return a 404 response. To see an example of a culture constraint, view the code of the MedioClinic's <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Utils/SiteCultureConstraint.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>SiteCultureConstraint</em></a> class.</p>\n<h2>Constraints on editor inputs</h2>\n<p>For some types of pages, you may want to give website editors control over a part of the URL. This gives them the option to create human-readable keywords in the URL.</p>\n<p>If you use the default Kentico page alias (<em>NodeAlias</em> field) for this purpose, the administration interface automatically ensures that the value is a valid URL string (without spaces or unsafe characters like ? or #).</p>\n<p>However, if you directly add custom fields into your URL patterns, you may wish to use route constraints to limit which types of inputs are valid. For example, you can use the <em>System.Web.Mvc.Routing.Constraints.AlphaRouteConstraint</em> class to allow only letter characters.</p>\n<h2>Constraint on the {nodeGuid} parameter</h2>\n<p>Using the page alias in your route templates introduces a possible challenge. Internally, the page alias is stored in the <em>NodeAlias</em> column of each page, and you can supply it into your URL patterns through the <em>{%NodeAlias%}</em> macro.</p>\n<div class=\"infobox note\"><p>Kentico only ensures that page aliases are unique within a given level of the website's content tree (under the same parent page).&nbsp;</p>\n<p>For example, pages stored directly in the&nbsp;<em>/Doctors</em>&nbsp;section will always have a unique page alias among each other. However, if one page is stored under&nbsp;<em>/Doctors/Surgeons</em>&nbsp;and another page under&nbsp;<em>/Doctors/Dentists</em>, they can both have the same page alias.</p></div>\n<p>When you give editors control over the page alias, it's possible that two or more pages could be created with the same page alias in different sections of the website. If you only use the <em>NodeAlias</em> to identify pages in your URLs and code, your website could behave incorrectly.&nbsp;</p>\n<p>We recommend that you use route templates that combine the unique <em>NodeGuid</em> value together with the page alias, for example <em>\"{culture}/Doctors/{nodeGuid}/{pageAlias}\"</em>. The Guid provides a unique identifier for the page, while the page alias adds the human-readable part of the URL.</p>\n<p>When you include the {nodeGuid} parameter in a route template, it can be useful to define a constraint. For example, you can use the <em>System.Web.Mvc.Routing.Constraints.GuidRouteConstraint</em> class to constrain the parameter to allow only values convertible to the <em>System.Guid</em> type. You can see an example in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/RouteConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>implementation of the constraint</em></a> in the <em>Medio Clinic </em>project for pages that display doctor profiles.</p>\n<p>These three types of constraints don't exhaust all the possibilities you'd want to define on your MVC website. They are here just to give you an idea of what you should consider when defining the behavior of your website's routes.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"4fcff2ce-b88e-4ca6-9361-79eccf5c933a","_parentId":"e1af5624-704d-4a18-99ff-c3f83d2e71c9","_type":"component","title":"Setting up URL constraints","displayTitle":"Setting up URL constraints"},{"body":"<p>The following text highlights in short how the Medio Clinic project implements URLs and handles multicultural content. To find examples of the specific implementation, scroll down to the demo section of this page, or view the whole project implementation on <a href=\"https://github.com/Kentico/training-kentico-k12\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>GitHub</em></a>.</p>\n<ul>\n  <li>Medio Clinic's default culture is \"en-US\". The site stores content in <em>\"en-US\"</em> and <em>\"es-ES\"</em> culture variants. The <em>URL pattern</em> of the page types able to display content in multiple languages contains the <em>{% DocumentCulture %}</em> macro expression which resolves into the culture of the requested page.</li>\n  <li>The application converts all URLs to lower case for consistency.</li>\n  <li>Kentico system routes are mapped first, so incoming requests have a chance to match them before being passed to the site's more general routes.</li>\n  <li>At the end of the \"essentials\" part of the course, the <em>RouteConfig</em> class will have three routes defined for the site (listed from top to bottom):\n    <ul>\n      <li><em>\"NotFound\"</em> route to handle 404 errors. You will implement the 404 logic later in the course.</li>\n      <li><em>\"DoctorWithAlias\"</em> route which will resolve into pages showing detailed information about the doctors. The route maps the URL to the <em>Doctors</em> controller and invokes the <em>Detail</em> action that you will implement in the next part of the training.</li>\n      <li><em>\"DefaultWithCulture\"</em> route which handles all other requests. You will implement the functionality in this part of the course.</li>\n    </ul>\n  </li>\n  <li>Routes on the Medio Clinic live site accept a <em>{culture} </em>parameter&nbsp;. A custom-made route handler gets the \"culture\" value from the URL parameter and configures the current request's thread by setting its <em>CurrentCulture</em> and <em>CurrentUICulture</em> properties.</li>\n  <li>Parameters of routes are further restricted by constraints to accept only valid cultures and correct data types. You will build the custom constraint used for the culture parameter later in this part of the course.</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":false},"_isOptional":false,"_classes":"","_id":"ff63f1a8-6d83-494e-8d03-1ab3c087eb76","_parentId":"8fed451a-1452-440b-b3b1-2a09e6f90115","_type":"component","title":"URLs and routing on the Medio Clinic website","displayTitle":"URLs and routing on the Medio Clinic website"},{"body":"<p>The Medio Clinic website uses custom services and repositories initialized through dependency injection to deal with data stored in Kentico. You will learn about the details of the business logic (and have the opportunity to build it on your training website) in the next part of this course.</p>\n<p>For now, let's see how the site determines and processes the culture of individual requests. However, if you first want to see the big picture, feel free to jump ahead, learn about the overall approach to working with data in the MVC application in the following part, and then come back to investigate how the custom handler and other services work.</p>\n<h2>How does Medio Clinic handle cultures?</h2>\n<p>Medio Clinic uses a custom&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Utils/MultiCultureMvcRouteHandler.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>MultiCultureMvcRouteHandler</em></a>, which retrieves the <em>{culture}</em> parameter from the URL, and sets the culture via the thread's <em>CurrentCulture</em> and <em>CurrentUICulture</em> properties. <em>MultiCultureMvcRouteHandler</em> is assigned to individual routes in the project's&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/RouteConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>RouteConfig</em></a>. &nbsp;</p>\n<p>The project uses a custom <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Utils/SiteContextService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>SiteContextService</em></a> to make the culture accessible in other parts of the code. The service holds the information about the thread culture and is passed around the various parts of the app through the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/AutofacConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Autofac IoC container</em></a>. &nbsp;For example, the service is then used to filter page API calls in the&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/Query/DocumentQueryService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DocumentQueryService</em></a>.</p>\n<p>To get an overview of the whole implementation, see the following classes:</p>\n<ul>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/RouteConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>RouteConfig</em></a><em>,</em></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Utils/MultiCultureMvcRouteHandler.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>MultiCultureMvcRouteHandler</em></a>,</li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Utils/SiteContextService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>SiteContextService</em></a>&nbsp;and the&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/Context/ISiteContextService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ISiteContextService</em></a>&nbsp;interface the class implements,</li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/AutofacConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>AutofacConfig</em></a> (initializes the <em>SiteContextService</em> and registers it into the project's DI container),</li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/Query/DocumentQueryService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DocumentQueryService</em></a>.</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"c057d6a6-bd31-4672-8f71-99c3b0e4498d","_parentId":"8fed451a-1452-440b-b3b1-2a09e6f90115","_type":"component","title":"Custom multi-culture handler","displayTitle":"Custom multi-culture handler"},{"body":"<p>In this task, you will extend your <em>MedioClinic</em> training website so that it processes requests correctly, and is able to serve content in multiple cultures.</p>\n<p>You will use the <em>MedioClinic</em> project which you've installed with Kentico Installer. In the next part of this course module, you will build the <em>Business</em> project to keep the business logic separated from the MVC application <em>MedioClinic</em> project, and add controllers and views to display Kentico data for the <em>Home</em> page and <em>Doctors</em> pages on the live site. In this task, focus only on updating the applications routing functionality.</p>\n<p>Start by doing the following in the project's <em>RouteConfig</em> class:</p>\n<ul>\n  <li>Prepare a default <em>CultureInfo</em> object that will be used to set \"en-us\" as the default culture,</li>\n  <li>Ensure that URLs are converted to lower case,</li>\n  <li>Map Kentico system routes (before any other routes),</li>\n  <li>Add a<em> {culture}</em> segment to the default route, with the appropriate default value.</li>\n</ul>\n<p>Next, create a custom constraint that restricts allowed values according to the cultures assigned to the site in Kentico. Add the constraint to the <em>culture</em> parameters (segments) of the default route in <em>RouteConfig</em>.</p>\n<p>Finally, create a custom route handler that:</p>\n<ul>\n  <li>Reads the requested culture from the URL,</li>\n  <li>Sets the culture properties of the current thread based on the culture string found in the URL of the requests,</li>\n  <li>Falls back to a 404 response if the culture parameter's value is not valid (the 404 error page will be implemented later in the course),</li>\n  <li>Is assigned to the default route in the <em>RouteConfig </em>class.</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"b3897328-f112-45ac-be73-a67128a74444","_parentId":"8fb4bf5f-105d-4d8a-9558-c06a8b2b1c1a","_type":"component","title":"Task: Setting your site's routes and URLs","displayTitle":"Task: Setting your site's routes and URLs"},{"body":"<p>The following demo shows how you can set up your site's default routing, and extend it to handle content in multiple cultures.</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>Edit your project's <strong>RouteConfig.cs</strong> file and perform the following:</p>\n<ol>\n  <li>Declare a variable of the <em>System.Globalization.CultureInfo</em> type to represent the website's default culture, and assign an instance using the <em>\"en-US\"</em> culture.</li>\n  <li>Set the <em>LowercaseUrls</em> property of your <em>RouteCollection</em> to <em>true</em> to ensure that URLs are converted to lower case.</li>\n</ol>\n<p>Make sure you set the <em>LowercaseUrls</em> property before you call the <em>Kentico().MapRoutes()</em> extension method.</p>","code":{"src":"using System.Globalization;\nusing System.Web.Mvc;\nusing System.Web.Routing;\n\nusing Kentico.Web.Mvc;\n\n(...)\nnamespace MedioClinic\n{\n    public class RouteConfig\n    {\n        public static void RegisterRoutes(RouteCollection routes)\n        {\n            var defaultCulture = CultureInfo.GetCultureInfo(\"en-US\");\n\n            routes.IgnoreRoute(\"{resource}.axd/{*pathInfo}\");\n\n            // Uses lowercase URLs for consistency and SEO-optimization\n            routes.LowercaseUrls = true;\n(...)","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Prepare code that will allow you to easily access the name of your Kentico site:</p>\n<ol>\n  <li>Create a simple static class named <em>AppConfig</em> (you can store it in a new folder under the <em>MedioClinic</em> project root, e.g., <em>Config</em>).</li>\n  <li>Prepare a string constant variable named <em>Sitename</em> and set its value to <em>\"MedioClinic\"</em> (the code name of your site in Kentico).</li>\n</ol>\n<p>You will later use the site's name when creating a constraint for the culture route parameter.</p>","code":{"src":"namespace MedioClinic.Config\n{\n    public static class AppConfig\n    {\n        public const string Sitename = \"MedioClinic\";\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Prepare a custom constraint that you will use for your culture route parameter:</p>\n<ol>\n  <li>Create a new public class named <em>SiteCultureContstraint</em> (you can store it in a new folder under the <em>MedioClinic</em> project root e.g., <em>Utils</em>).</li>\n  <li>Make the class implement the <em>IRouteConstraint</em> interface.</li>\n  <li>Define a private readonly <em>HashSet&lt;string&gt; </em>variable&nbsp;named &nbsp;<em>_allowedCultureNames </em>that will store allowed culture code values.</li>\n  <li>Use the Kentico <em>CultureSiteInfoProvider</em> class to get the culture codes that you assigned to the Medio Clinic site in a previous part of the training.</li>\n  <li>Implement the <em>Match</em> method and return a bool result - evaluate whether the HashSet of allowed cultures contains the value of the constrained route parameter.</li>\n</ol>","code":{"src":"using System;\nusing System.Collections.Generic;\nusing System.Web;\nusing System.Web.Routing;\nusing CMS.SiteProvider;\n\nnamespace MedioClinic.Utils\n{\n    /// <summary>\n    /// Route constraint restricting the culture parameter to cultures allowed by the site.\n    /// </summary>\n    public class SiteCultureConstraint : IRouteConstraint\n    {\n        private readonly HashSet<string> _allowedCultureNames;\n\n\n        /// <summary>\n        /// Creates a new instance of the culture route constraint for a specific site.\n        /// </summary>\n        /// <param name=\"siteName\">Code name of the site.</param>\n        public SiteCultureConstraint(string siteName)\n        {\n            var siteCultureNames = CultureSiteInfoProvider.GetSiteCultureCodes(siteName);\n\n            // Ignores letter case when comparing cultures\n            _allowedCultureNames = new HashSet<string>(siteCultureNames, StringComparer.InvariantCultureIgnoreCase);\n        }\n\n        /// <summary>\n        /// Determines whether the URL parameter contains an allowed culture name for this constraint.\n        /// </summary>\n        /// <param name=\"httpContext\">Object that encapsulates information about the HTTP request.</param>\n        /// <param name=\"route\">Route that this constraint belongs to.</param>\n        /// <param name=\"parameterName\">Name of the route parameter that is being checked.</param>\n        /// <param name=\"values\">Object that contains the parameters for the URL.</param>\n        /// <param name=\"routeDirection\">Object that indicates whether the constraint check is being performed when an incoming request is being handled or when a URL is being generated.</param>\n        /// <returns>True if the URL parameter contains an allowed culture name; otherwise, false.</returns>\n        public bool Match(HttpContextBase httpContext, Route route, string parameterName, RouteValueDictionary values, RouteDirection routeDirection)\n        {\n            var cultureName = values[parameterName].ToString();\n\n            return _allowedCultureNames.Contains(cultureName);\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Return to the <em>RouteConfig.cs</em> file and extend the default route by adding a <em>{culture}</em> parameter. Set the parameter's default value and apply the <em>SiteCultureConstraint</em> constraint.</p>","code":{"src":"(...)\nusing MvcTrainingMedioClinic.Config;\nusing MvcTrainingMedioClinic.Utils;\n(...)\n// Maps a default route with a culture URL prefix\nvar route = routes.MapRoute(\n    name: \"DefaultWithCulture\",\n    url: \"{culture}/{controller}/{action}/{id}\",\n    defaults: new { culture = defaultCulture.Name, controller = \"Home\", action = \"Index\", id = UrlParameter.Optional },\n    constraints: new { culture = new SiteCultureConstraint(AppConfig.Sitename) }\n);","lang":"csharp"},"strapline":""},{"title":"","body":"<p>To restrict the valid type of the optional {<em>id</em>} parameter in the default route, apply the <em>IntRouteConstraint</em> constraint.</p>","code":{"src":"(...)\nusing System.Web.Mvc.Routing.Constraints;\n(...)\n// Maps a default route with a culture URL prefix\nvar route = routes.MapRoute(\n    name: \"DefaultWithCulture\",\n    url: \"{culture}/{controller}/{action}/{id}\",\n    defaults: new { culture = defaultCulture.Name, controller = \"Home\", action = \"Index\", id = UrlParameter.Optional },\n    constraints: new { culture = new SiteCultureConstraint(AppConfig.Sitename),\n                                          // Constrains the optional id parameter to the integer data type\n                                          id = new OptionalRouteConstraint(new IntRouteConstraint()) }\n);","lang":"csharp"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrativeCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"7b3b1b62-8379-4f26-885c-50049a8d71ae","_parentId":"51bcb895-abe4-4c45-946d-f7730f4befd8","_type":"component","title":"Demo: Setting up the website's default routing","displayTitle":"Demo: Setting up the website's default routing"},{"body":"<p>Create a custom route handler that reads the requested culture from the URL and sets the culture properties of the current thread.</p>\n<p>Add a new public class named <em>MultiCultureMvcRouteHandler&nbsp;</em>(you can store it in the project's <em>Utils</em> folder). You can see the implementation in the following code snippet.&nbsp;(The implementation of the custom handler also deals with exceptions. You will learn about the handling of 404 errors in Kentico MVC later in the course.)</p>\n<pre><code class=\"language-csharp\">using System.Globalization;\nusing System.Threading;\nusing System.Web;\nusing System.Web.Mvc;\nusing System.Web.Routing;\n\nnamespace MedioClinic.Utils\n{\n    /// &lt;summary&gt;\n    /// Creates an object that implements the &lt;see cref=\"IHttpHandler\"/&gt; interface and passes the request context to it.\n    /// Configures the current thread to use the culture specified by the 'culture' URL parameter.\n    /// &lt;/summary&gt;\n    public class MultiCultureMvcRouteHandler : MvcRouteHandler\n    {\n\n        /// &lt;summary&gt;\n        /// Name of the parameter used to identify the requested culture (see RouteConfig.cs for details)\n        /// &lt;/summary&gt;\n        public const string CultureUrlParam = \"culture\";\n\n        /// &lt;summary&gt;\n        /// Returns the HTTP handler using the specified request context. \n        /// Sets the &lt;see cref=\"Thread.CurrentCulture\"/&gt; and &lt;see cref=\"Thread.CurrentUICulture\"/&gt; of the current thread to the culture specified by the 'culture' URL parameter.\n        /// &lt;/summary&gt;\n        protected override IHttpHandler GetHttpHandler(RequestContext requestContext)\n        {\n            try\n            {\n\n                // Gets the requested culture from the route\n                var cultureName = requestContext.RouteData.Values[CultureUrlParam].ToString();\n\n                // Creates a new CultureInfo object for the requested culture\n                var culture = new CultureInfo(cultureName);\n\n                // Sets the culture for the thread\n                Thread.CurrentThread.CurrentUICulture = culture;\n                Thread.CurrentThread.CurrentCulture = culture;\n            }\n            catch\n            {\n                // Returns a 404 response if the culture prefix is invalid\n                requestContext.HttpContext.Response.StatusCode = 404;\n            }\n\n            return base.GetHttpHandler(requestContext);\n        }\n    }\n}</code></pre>\n<p>If you have followed the previous demo and set up your <em>DefaultWithCulture </em>route, you can now assign the new handler in the <em>RouteConfig.cs</em> file.</p>\n<pre><code class=\"language-csharp\">// Maps a default route with a culture URL prefix\nvar route = routes.MapRoute(\n    name: \"DefaultWithCulture\",\n    url: \"{culture}/{controller}/{action}/{id}\",\n    defaults: new { culture = defaultCulture.Name, controller = \"Home\", action = \"Index\", id = UrlParameter.Optional },\n    constraints: new { culture = new SiteCultureConstraint(AppConfig.Sitename), id = new OptionalRouteConstraint(new IntRouteConstraint()) }\n);\n\n// Assigns the custom handler to the route\n// Sets the culture of the current thread based on the 'culture' route parameter\nroute.RouteHandler = new MultiCultureMvcRouteHandler();</code></pre>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"99d1bbc1-82e6-48bd-9728-05ff64f19987","_parentId":"51bcb895-abe4-4c45-946d-f7730f4befd8","_type":"component","title":"Demo: Implementing multiple culture handling","displayTitle":"Demo: Implementing multiple culture handling"},{"body":"<p>At the end of this exercise, your overall <em>RouteConfig </em>code might look like the following snippet.</p>\n<pre><code class=\"language-csharp\">using System.Globalization;\nusing System.Web.Mvc;\nusing System.Web.Mvc.Routing.Constraints;\nusing System.Web.Routing;\nusing Kentico.Web.Mvc;\nusing MvcTrainingMedioClinic.Config;\nusing MvcTrainingMedioClinic.Utils;\n\nnamespace MedioClinic\n{\n    public class RouteConfig\n    {\n        public static void RegisterRoutes(RouteCollection routes)\n        {\n            var defaultCulture = CultureInfo.GetCultureInfo(\"en-US\");\n\n            routes.IgnoreRoute(\"{resource}.axd/{*pathInfo}\");\n\n            // Uses lowercase URLs for consistency and SEO-optimization\n            routes.LowercaseUrls = true;\n\n            // Maps routes to Kentico HTTP handlers and enabled MVC features \n            // Must be called before mapping your other routes, otherwise Kentico system URLs might match them and be processed incorrectly\n            routes.Kentico().MapRoutes();\n\n            // Maps a default route with a culture URL prefix\n            var route = routes.MapRoute(\n                name: \"DefaultWithCulture\",\n                url: \"{culture}/{controller}/{action}/{id}\",\n                defaults: new { culture = defaultCulture.Name, controller = \"Home\", action = \"Index\", id = UrlParameter.Optional },\n                constraints: new { culture = new SiteCultureConstraint(AppConfig.Sitename), id = new OptionalRouteConstraint(new IntRouteConstraint()) }\n            );\n\n            // Assigns a custom handler to the route that sets the culture of the current thread based on the 'culture' route parameter\n            route.RouteHandler = new MultiCultureMvcRouteHandler();\n        }\n    }\n}</code></pre>\n<p>You can further investigate:</p>\n<ul>\n  <li>What the final <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/RouteConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>RouteConfig.cs</em></a> file of the Medio Clinic site looks like,</li>\n  <li>The whole Medio Clinic website's <a href=\"https://github.com/Kentico/training-kentico-k12\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>sample code</em></a> on GitHub. (The <em>RouteConfig</em> file contains other routes that you will implement later.)</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"2ff371ea-848f-4fdb-9653-89ff99c0d46e","_parentId":"51bcb895-abe4-4c45-946d-f7730f4befd8","_type":"component","title":"Demo: RouteConfig review","displayTitle":"Demo: RouteConfig review"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Select the correct statement about the <em>Kentico().MapRoutes()</em> extension method.</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p>The <em>Kentico().MapRoutes()</em> extension method is required and needs to be called first, before mapping your website's other routes. The method maps routes to Kentico HTTP handlers, as well as routes required by enabled Kentico MVC features (such as the Page builder or tracking of marketing emails). Because the method adds routes based on the set of enabled Kentico features, you need to call it after you enable Kentico MVC features using the <em>ApplicationBuilder</em> instance.</p>","_shouldBeSelected":true,"feedback":""},{"text":"<p>The <em>Kentico().MapRoutes()</em> extension method&nbsp;must be called after you map all other routes for your website. This ensures that the registered Kentico system routes cannot be overridden by other routes. &nbsp;As a result, your pages will display images and attachments correctly.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. You need to call <em>Kentico().MapRoutes()</em>&nbsp;as soon as possible, before registering other more general routes for your site's content.&nbsp;Otherwise the Kentico system URLs may match the other routes, which can for example result in pages being displayed without images.</p>"},{"text":"<p><em>Kentico().MapRoutes()</em> is an obsolete method that was used to map routes to Kentico HTTP handlers in previous versions. The Kentico integration packages now automatically add all required routes into your MVC application's routing table without requiring any code.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. The <em>Kentico().MapRoutes() </em>extension method needs to be called manually, typically in your MVC applications <em>RouteConfig</em> file. The method maps routes to Kentico HTTP handlers, as well as routes required by enabled Kentico MVC features.</p>"}],"_feedback":{"title":"","correct":"<p>Correct. The <em>Kentico().MapRoutes()</em> extension method must be called before you map other more general routes for your site's content. You also need to make sure that you enable optional Kentico MVC features (such as the Page builder) before you register routes, because the <em>Kentico().MapRoutes()</em> method automatically adds required routes based on the set of enabled features.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"7de41cfe-fd50-4601-9dc3-06b1e33ddc61","_parentId":"c19f9a43-04ec-4c8b-b91f-0848b0747c1d","_type":"component","title":"Progress-check: Mapping Kentico system routes","displayTitle":"Progress-check: Mapping Kentico system routes"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Which is the best practice for determining the culture in the MVC application?</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p>Do not introduce any custom functionality and let the Kentico integration code determine which culture to serve on the live site.&nbsp;</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. Kentico cannot automatically determine the culture on the MVC live site. You need to identify the visitor's culture and set the application's culture context programmatically.</p>"},{"text":"<p>Store each user's preferred language in their browser using a custom cookie.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. Even though this is a valid approach to handling cultures on MVC sites, Kentico recommends determining the culture using a language prefix in the URLs of incoming requests.</p>"},{"text":"<p>Create a custom route handler that determines the culture using a language prefix in the URLs of incoming requests.</p>","_shouldBeSelected":true,"feedback":""}],"_feedback":{"title":"","correct":"<p>Correct. The recommended approach to determining the culture is to use language URL prefixes and a custom route handler.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"03029c72-5be9-474b-a106-f4d4dc0b33aa","_parentId":"c19f9a43-04ec-4c8b-b91f-0848b0747c1d","_type":"component","title":"Progress-check: Handling cultures","displayTitle":"Progress-check: Handling cultures"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>You have a multicultural website and want to add the option to create article pages. Select a <strong>URL pattern</strong> for the Article page type that allows content editors to add a human-readable URL slug and follows Kentico recommended practices.</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"title":"","code":{"src":"/{%DocumentCulture%}/Articles/{%NodeID%}/{%NodeAlias%}","lang":"csharp"},"feedback":"<p>Wrong. This URL pattern contains a language prefix and a human-readable page alias parameter, but the <em>NodeID</em> parameter doesn't provide a consistent identifier when hosting the website in multiple environments, e.g., when using content staging.&nbsp;</p>","_shouldBeSelected":false},{"title":"","code":{"src":"/{%DocumentCulture%}/Articles/{%NodeGUID%}/{%NodeAlias%}","lang":"csharp"},"feedback":"","_shouldBeSelected":true},{"title":"","code":{"src":"/Articles/{%NodeGUID%}","lang":"csharp"},"feedback":"<p>Wrong. This pattern does not allow editors to set a human-readable part of the URL, and does not provide any way to resolve multicultural content.</p>","_shouldBeSelected":false}],"_feedback":{"title":"","correct":"<p>Correct. This URL pattern contains a language prefix and a human-readable page alias parameter. Additionally, the <em>NodeGUID</em> parameter is unique for each node in the website's content tree, and is consistent between different environments hosting the same website (e.g., when using content staging).</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"cmcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"290216ac-d0d1-4ed5-918b-21dfc137e83c","_parentId":"c19f9a43-04ec-4c8b-b91f-0848b0747c1d","_type":"component","title":"Progress-check: URL patterns","displayTitle":"Progress-check: URL patterns"},{"body":"<p>Congratulations on completing the routing section of the course! You now know how both the website and administration interface approach multilingual websites from the routing perspective.&nbsp;</p>\n<p>You have learned:</p>\n<ul>\n  <li>How routing works for Kentico websites built with the MVC development model</li>\n  <li>What role the URL pattern of page types plays in Preview mode and the Kentico administration in general</li>\n  <li>About page aliases on content-only websites</li>\n  <li>How you can implement the website's localization using a custom handler</li>\n  <li>How to build a simple constraint for site culture route parameters</li>\n</ul>\n<p>Your website is coming along nicely! Ready to go to the next section and find out how to display the content on the live site?&nbsp;<strong>Click the back button&nbsp;</strong>(<strong>&lt;</strong>)<strong>&nbsp;in the top left, and continue with the course!</strong></p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"2118e71c-f6b3-4624-b0c3-72d57248e2ab","_parentId":"3dd4c843-231c-4819-95d5-ea5a10e63bbc","_type":"component","title":"Conclusion: URLs and routes on MVC websites","displayTitle":"Conclusion: URLs and routes on MVC websites"},{"body":"<p>What you will learn in this section:</p>\n<ul>\n  <li>What the <strong>recommended approach is to building websites</strong> in the MVC development model</li>\n  <li>How to <strong>use the Kentico API to retrieve page data</strong></li>\n  <li>How to use <strong>dependency injection</strong> in Kentico MVC projects</li>\n  <li>How you can <strong>set up the preview mode</strong> functionality for your website</li>\n</ul>\n<p>You will work on:</p>\n<ul>\n  <li>Preparing business logic that handles the content loading for the application</li>\n  <li>Building MVC-related classes on a higher-level of abstraction, e.g., <em>BaseController</em> or <em>PageViewModel</em></li>\n  <li>Displaying the <em>Home</em>, <em>Doctors</em> listing, and <em>Doctor</em> profile pages</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"371947a1-2d7c-4dfa-97d6-7466e88241e1","_parentId":"d5b5ee10-6371-4676-b7de-c05d8a764d97","_type":"component","title":"Introduction","displayTitle":"Introduction"},{"body":"<p>Websites built with the MVC development model allow you to retrieve and work with any data from Kentico. The most common types of objects holding page content are: <strong>pages</strong>,&nbsp;<strong>page attachments</strong>,&nbsp;<strong>custom tables</strong>, <strong>custom module classes</strong>,&nbsp;<strong>form records</strong>, and&nbsp;<strong>media libraries</strong>. This part of the course covers only the basics of retrieving&nbsp;<strong>pages&nbsp;</strong>and&nbsp;<strong>page attachments</strong>.</p>\n<p>To retrieve page data from the shared database, Kentico provides you with <em>DocumentQuery API</em>. <em>DocumentQuery</em> is an abstraction layer over the SQL database. It also brings a degree of additional protection against SQL injection attacks.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"78fda027-fe32-41d2-8e97-18c55cbac71b","_parentId":"0924df7e-3718-4312-a143-6208a40f1746","_type":"component","title":"Working with content on MVC websites","displayTitle":"Working with content on MVC websites"},{"body":"<h2>Kentico API</h2>\n<p>When you create a page type, you have an option to generate strongly typed API classes for working with the data, for example,&nbsp;<em>Article&nbsp;</em>and&nbsp;<em>ArticleProvider</em>&nbsp;classes. The generated providers present you with a set of methods you can call to retrieve data from the content-only pages.</p>\n<p>The following example uses generated classes to retrieve a list of articles:</p>\n<pre><code class=\"language-csharp\">IEnumerable&lt;Article&gt; articles = ArticleProvider.GetArticles()\n    .OnSite(\"MyDemoSite\") // Loads articles from the specified site as the instance could host multiple sites with the same page types\n    .Culture(\"en-US\")  // Limits the articles only to the specified cultures\n    .Path(\"/Articles/\", PathTypeEnum.Children); // Loads articles from the /Articles section of the content tree</code></pre>\n<p>The method above retrieves data from all columns the given object has stored in the database. However, you may not need all of the data on your live site and using the default calls may return large data sets. To improve the site's performance, we recommend that you pull only the required data from the relevant columns.</p>\n<pre><code class=\"language-csharp\">IEnumerable&lt;Article&gt; articles = ArticleProvider.GetArticles()\n   .Columns(\"ArticleTitle\", \"ArticleSummary\", \"ArticleTeaser\",\"ArticleText\",\"ArticleImages\") // Loads data only from the specified columns\n   .OnSite(\"MyDemoSite\")\n   .Culture(\"en-US\") \n   .Path(\"/Articles/\", PathTypeEnum.Children);</code></pre>\n<p>Feel free to&nbsp;check examples&nbsp;of the most common query methods available for the&nbsp;<em>DocumentQuery API</em>&nbsp;in the&nbsp;<a href=\"https://docs.kentico.com/k12/custom-development/working-with-pages-in-the-api#WorkingwithpagesintheAPI-DocumentQueryreference\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico documentation</a>.</p>\n<h2>Abstraction from the Kentico API</h2>\n<p>Instead of calling the Kentico API directly in your MVC code, e.g., in controllers, you may want to introduce an additional layer of logic and separate your web application's code from the Kentico API as much as possible.</p>\n<p>Separating the website's code from the Kentico API brings various benefits. For example, you can create custom services that encapsulate the Kentico API. The services can extend the basic API and provide additional functionality tailored towards your specific project. The code separation also makes it easier to deal with potential API changes after you upgrade to a newer Kentico version. It is also always better to write automated tests against separated code. That way, reasons of a failing test can be discovered quickly.</p>\n<p>For a more specific scenario, imagine having a basic query service that provides shared functionality for loading all types of pages on your site (such as filtering based on the current culture and site, specifying a basic set of shared page columns, etc.). Individual page types could then be handled via repositories that use the shared query service and add logic required for the given page type.&nbsp;</p>\n<p>To expand on the column filtering scenario mentioned above, implementations where you have multiple class layers that wrap and extend <em>DocumentQuery</em> or <em>ObjectQuery</em> calls from other classes require you to use the <strong>AddColumns</strong> method instead of <em>Columns</em>. This adds to the list of retrieved columns without overriding the columns specified by the previous call.</p>\n<h2>Working with the retrieved content</h2>\n<p>You can work with the data of retrieved pages using the properties of the generated class (<em>Article</em> in the examples above). The fields which content editors work with on the&nbsp;<em>Content</em>&nbsp;tab can be accessed through the <strong>Fields</strong>&nbsp;property. For example, to retrieve the text of an article's <em>Teaser</em> field into a view model object, you can use the following snippet.<br>\n</p>\n<pre><code class=\"language-csharp\">articleModel.Teaser = article.Fields.Teaser;</code></pre>\n<p>Fields that use the&nbsp;<strong>Rich text editor</strong>&nbsp;form control for editing may contain <em>HTML tags</em> and <em>relative URL links</em>. To ensure that the content is displayed correctly when rendering views, use the&nbsp;<em>Html.Raw()</em>&nbsp;method to process such values, which disables HTML encoding. For example: <em>Html.Raw(Model.Teaser)</em></p>\n<p>To resolve relative URLs to their absolute value (as well as disable the HTML encoding), you can use the <em>Html.Kentico().ResolveUrls() </em>Kentico extension method.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"fd64c2ab-f72f-4b37-abcb-7c40beaf9fe8","_parentId":"0924df7e-3718-4312-a143-6208a40f1746","_type":"component","title":"Theory: Retrieving pages","displayTitle":"Theory: Retrieving pages"},{"body":"<p>Attachments represent files which are associated with a particular page. Page types in Kentico can have fields of the following data types:</p>\n<ul>\n  <li><strong>File</strong><em>&nbsp;</em>- stores a single page attachment. From the database point of view, the value is a GUID identifier of a corresponding attachment record in the <em>CMS_Attachment</em> table.</li>\n  <li><strong>Attachments</strong>&nbsp;- stores multiple attachments in a single page type field. From the database point of view, the field is always empty. Instead, the attachment records in the <em>CMS_Attachment</em> table store identifiers of the related page and the specific field.</li>\n</ul>\n<p>Editors can upload attachments into page fields on the <strong>Content</strong> tab of the <em>Pages</em> application, through form controls assigned to the given page type fields.</p>\n<p>In the API, attachments are represented by the <strong>DocumentAttachment</strong><em> </em>type, available in the <em>CMS.DocumentEngine </em>namespace. The generated classes for page types provide suitable properties that make it easy to work with attachments fields. The <em>File</em> fields are of type <em>DocumentAttachment</em> and the <em>Attachment</em> fields are of type &lt;<em>IEnumerable&lt;DocumentAttachment&gt;.</em></p>\n<div class=\"infobox note\"><p>Attachments can also be added to pages as \"unsorted\", on the <strong>Attachments</strong> tab in the <em>Pages</em> application. However, the approach used to retrieve the <em>DocumentAttachment</em> objects from pages is different in this case, and is not used or covered within this training course.</p></div>\n<h2>Creating page attachment URLs</h2>\n<p>To ensure that attachment URLs work correctly on both your MVC live site and in the administration interface, &nbsp;your system must use the <em>permanent URL format</em> for attachments. This option is controlled through the <em>Settings &gt; URLs and SEO &gt; Use permanent URLs</em> setting in Kentico, which is enabled by default when you install an Kentico MVC site through the installer.</p>\n<p>To generate URLs for&nbsp;<em>DocumentAttachments</em>&nbsp;objects, you need to call the&nbsp;<strong>GetPath</strong>&nbsp;extension method from the&nbsp;<em>Kentico.Content.Web.Mvc</em>&nbsp;namespace.</p>\n<p>For example, Medio Clinic's <em>Doctor</em> page type has an <em>Photo</em> field that stores the doctor's profile image, with the following property in the generated class:</p>\n<pre><code class=\"language-csharp\">public DocumentAttachment Photo</code></pre>\n<p>To get the profile image URL, you can use the following snippet in your code:</p>\n<pre><code class=\"language-csharp\">string attachmentUrl = doctor.Fields.Photo.GetPath();</code></pre>\n<p>The call above returns a <em>relative URL</em> in the following format&nbsp;<em>~/getattachment/&lt;file GUID&gt;/&lt;filename&gt;</em>.</p>\n<div class=\"infobox idea\"><p>As the <em>GetPath</em> extension method resides in the <em>Kentico.Content.Web.Mvc</em> namespace, it is good to avoid calling this method from within the business layer of the project.</p></div>\n<h2>Displaying page attachments</h2>\n<p>Because the returned URL is&nbsp;<strong>relative</strong>, you need to resolve it in views using one of Kentico's extension methods: &nbsp;<em>ImageUrl</em>&nbsp;or&nbsp;<em>FileUrl</em>.</p>\n<p>You can call the methods directly in views, or you can use a custom extension method, such as the custom&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Extensions/UrlExtensions.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>KenticoImageUrl</em></a>&nbsp;method in the Medio Clinic website.</p>\n<h2>Working with attached images</h2>\n<p>Before you display an image in a view, the <em>ImageUrl</em>&nbsp;extension method offers you a set of constraints you can call to modify the image. For example, you can change the image's height:&nbsp;<em>Url.Kentico().ImageUrl(attachmentRelativeUrl, SizeConstraint.Height(200))</em>, or its width:&nbsp;<em>Url.Kentico().ImageUrl(attachmentRelativeUrl, SizeConstraint.Width(200))</em></p>\n<div class=\"infobox note\"><p>Please note that if you want to use the <a href=\"https://docs.kentico.com/k12/developing-websites/managing-responsive-images\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">responsive images</a> feature which lets the system automatically prepare image variants for devices with different screensizes, you need to specify the image variant in the identifier as a parameter of the <em>GetPath()</em> method, e.g., <em>GetPath(\"Tablet\")</em>. You can see an example in <a href=\"https://docs.kentico.com/k12/developing-websites/managing-responsive-images/defining-image-variants\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico documentation</a>.</p></div>\n<p>See the Kentico documentation for&nbsp;<a href=\"https://docs.kentico.com/k12/developing-websites/retrieving-content-in-mvc-applications/displaying-page-attachments\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">additional information about working with page attachments</a>.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"89cc0c29-5f07-468f-b634-a5fd1e41e242","_parentId":"0924df7e-3718-4312-a143-6208a40f1746","_type":"component","title":"Retrieving page attachments","displayTitle":"Retrieving page attachments"},{"body":"<p>When developing enterprise-level MVC applications in Kentico, you may want to distribute the business logic into smaller, manageable chunks, such as services, and inject them into other code dynamically as required.</p>\n<div class=\"infobox idea\"><p>One of the most significant benefits of using dependency injection is that the small chunks of logic can be tested separately, not all at once.</p></div>\n<p><br>\nThe Kentico API itself uses services for various purposes, such as logging activities, handling newsletter subscriptions, etc. We recommend not instantiating services manually. Rather rely on a dependency injection container to do that for you.</p>\n<h2>Dependency injection design pattern</h2>\n<p>Dependency injection (DI) is a common design pattern in many programming languages.&nbsp;</p>\n<div class=\"infobox note\"><p>If you are new to the dependency injection patter, it works in the following way.&nbsp;</p>\n<p>Consider two classes <em>Alpha</em> and <em>Beta</em>. The business requirements dictate that every time <em>Beta</em> is instantiated it needs an instance of <em>Alpha</em>. Also, imagine you wish to test the functionality of Beta and you know that <em>Alpha</em> is a heavyweight object that is really cumbersome to instantiate, just for the sole purpose of testing <em>Beta</em>. You know that a lightweight mocked variant of <em>Alpha</em> would be much better for testing of <em>Beta</em>.&nbsp;</p>\n<p>The solution is to extract an interface out of <em>Alpha</em> and rewrite the constructor of <em>Beta</em> so that it accepts <em>IAlpha</em> instead of <em>Alpha</em>. Then, simply employ an <em>inversion of control</em> (IoC) <em>container library </em>that listens in the background of your app and supplies an instance of <em>Alpha</em> every time <em>IAlpha</em> is required in any constructor call.</p>\n<p>In production, <em>Beta</em> will always get a full fledged <em>Alpha</em> to its constructor. But when you need to just test <em>Beta</em>, you can supply a mocked lightweight <em>Alpha</em> object instead.</p></div>\n<p>You can read more about the dependency injection pattern in the following articles:</p>\n<ul>\n  <li><a href=\"https://docs.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Dependency Injection</a> by Steve Smith</li>\n  <li><a href=\"https://www.mikesdotnetting.com/article/117/dependency-injection-and-inversion-of-control-with-asp-net-mvc\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Dependency Injection and Inversion of Control with ASP.NET MVC</a> by Mike Brind</li>\n</ul>\n<h2>Using dependency injection containers</h2>\n<p>We recommend that you instantiate your custom and Kentico services using <em>a Inversion of Control (IoC) container</em>. The IoC containers map interfaces to concrete types, and make it easier to instantiate different services and resolve dependencies between them.</p>\n<p>The Medio Clinic website uses the <a href=\"https://autofaccn.readthedocs.io/en/latest/integration/mvc.html\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Autofac</a> IoC container, however you can use any other that you prefer. See the Kentico documentation for some <a href=\"https://docs.kentico.com/k12/developing-websites/initializing-kentico-services-with-dependency-injection#InitializingKenticoserviceswithdependencyinjection-Dependencyinjectioncontainers\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">common IoC container examples</a>.&nbsp;</p>\n<p>If you want to use the dependency injection pattern with a container, we recommend that you:</p>\n<ol>\n  <li>Register any custom services or repositories used in your project into your IoC container,&nbsp;</li>\n  <li>Implement on-the-fly registration for all services that are part of the Kentico API (added by the <em>Kentico.Libraries</em> NuGet package). The implementation usually differs from IoC container to another. On the basic level, you can get instances of Kentico services by calling <em>CMS.Core.Service.Resolve(serviceType)</em> method as you can see in <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/DependencyInjection/CmsRegistrationSource.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">this example</a> in the Medio Clinic project.</li>\n</ol>\n<p>See the Kentico documentation for another example of registering <a href=\"https://docs.kentico.com/k12/developing-websites/initializing-kentico-services-with-dependency-injection#InitializingKenticoserviceswithdependencyinjection-Initializingdependencyinjectioncontainers\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico API services in an Autofac DI container</a>, or a particular implementation of registering <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/DependencyInjection/BusinessDependencies.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">custom business dependencies</a> using the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/AutofacConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Autofac IoC container</a> on the Medio Clinic website.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"3c13b7dd-d118-44f9-a51b-e0acc3e2cace","_parentId":"14d7efd5-a054-4138-a71a-8efdfa925880","_type":"component","title":"Overview of dependency injection","displayTitle":"Overview of dependency injection"},{"body":"<p>Preview mode allows editors to view the latest versions of pages before they publish them to the live site (when using the Kentico workflow feature).&nbsp;</p>\n<p>Editors can preview their changes using the <strong>Preview</strong> mode of the <em>Pages</em> application in the administration interface. The preview displays the page from the MVC live site in an&nbsp;<em>&lt;iframe&gt;</em>&nbsp;HTML element inside the administration interface.&nbsp;</p>\n<p>The preview functionality is not limited only to the administration interface. If editors need to share an unpublished page with, e.g., external contractors who don't have access to the admin interface, they can generate a <strong>Preview URL</strong> for specific pages on the <strong>Properties &gt; General</strong> tab. Find out more about <a href=\"https://docs.kentico.com/k12/managing-website-content/working-with-pages/sending-links-to-unpublished-pages\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">sending links to unpublished pages</a> in the Kentico documentation.</p>\n<h2>Loading page content based on preview mode</h2>\n<p>On MVC sites, the preview mode doesn't automatically display the latest edited version of page content. This is something that you need to take care of as a developer. You need to check whether the request is being displayed in preview mode, and then load either the latest version of pages (preview mode) or the currently published version (live site).</p>\n<p>Use the following code to check whether preview mode is enabled:</p>\n<pre><code class=\"language-csharp\">if (System.Web.HttpContext.Current.Kentico().Preview().Enabled) {\n    ...\n}</code></pre>\n<p>You can also implement a custom context service that wraps this code, and then use it to easily check the preview mode status within your project.</p>\n<p>To retrieve the latest version of pages in your code when preview mode is enabled, add the <strong>LatestVersion()</strong> method to your <em>DocumentQuery</em> API calls.&nbsp;You can find an example of preview mode handling in the main <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/Query/DocumentQueryService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DocumentQueryService</em></a> of the Medio Clinic project.</p>\n<p>In the database, non-published versions of pages are stored in the <em>CMS_VersionHistory</em> table.</p>\n<h2>How does the preview work?</h2>\n<p>The <em>preview URLs</em> that Kentico generates for pages consist of the site's Presentation URL, as well as additional information, such as the language version and a validation hash.</p>\n<p>The Kentico integration package in the MVC application validates and processes the preview URL. It updates the Kentico HTTP context with information about the enabled status of preview mode, and then displays the page through the standard routing process using its presentation URL (based on the page type's URL pattern).</p>\n<p>Some additional info about the preview:</p>\n<ul>\n  <li>The preview feature needs to be enabled for your MVC application by calling the <em>UsePreview()</em> method of the <em>ApplicationBuilder</em> instance during the application start.</li>\n  <li>Generated preview links can be long. You might want to set the <em>maxUrlLength</em> attribute of the <em>httpRuntime</em> element in the MVC project's <em>web.config, </em>for example to 515 characters.</li>\n  <li>Data caching needs to be disabled when retrieving content for preview mode.</li>\n  <li>Output caching set for controllers (via<em> OutputCache</em> attributes) is not used in preview mode. This is automatically ensured by the Kentico integration packages.</li>\n</ul>\n<h3>How is security handled for the embedded preview content?</h3>\n<p>In real-world deployments of MVC sites, the live site and administration interface are often hosted on different domains. This could potentially lead to problems, because the preview mode and other related features (such as the page and form builder) display the MVC site's content in an <em>&lt;iframe&gt;</em>&nbsp;embedded in the administration interface.</p>\n<p>MVC applications commonly use the <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.web.mvc.validateantiforgerytokenattribute\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">ValidateAntiForgeryToken</a> attribute to protect against cross-site request forgery and clickjacking attacks, which automatically sends the <em>X-Frame-Options</em> HTTP header with the <em>SAMEORIGIN</em> framing policy. The <em>UsePreview</em> feature disables the header for preview URLs, which allows editors to preview content embedded in the administration interface, even when running on a different domain.</p>\n<p>As a result, preview URLs could potentially be vulnerable to clickjacking attacks. To prevent this, the <em>UsePreview</em> feature automatically adds the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Content Security Policy</a> (CSP) HTTP response header with the <em>frame-ancestors</em> policy, and sets the Kentico administration site's domain as a valid source. This allows the preview to work in the Kentico administration, while preventing embedding on any other domains.</p>\n<p>If you decide to protect your website manually, for example by applying the <em>X-Frame-Options</em> header in the MVC site's <em>web.config</em> file, you may cause the preview mode and other related features in the administration interface to display blank content. If you set your own <em>CSP</em> headers, make sure to always whitelist the Kentico administration site using the <em>frame-ancestors</em> policy.</p>\n<p>Carefully consider the pros and cons of preview mode, and weigh them against the security requirements of your project.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"cfea90bc-66cf-4a79-be7f-db35375308a7","_parentId":"378e27e9-c28c-4ffe-a78e-321675a24946","_type":"component","title":"Setting up the preview mode","displayTitle":"Setting up the preview mode"},{"body":"<p>As you already know, every time you define a page type in the administration interface, you can generate its model class and a provider class (in the <em>Code</em> tab).</p>\n<p>An example of such a provider class is the <em>ArticleProvider</em> mentioned above. You can of course directly render the model class objects via the providers. But<strong> for medium and large sites, </strong>there is a<strong> better approach: a unified page retrieval infrastructure </strong>that <strong>allows for separation of concerns at the same time.</strong> We have built the training website with such an approach - and youll implement it in this part of the course.</p>\n<p>In the Medio Clinic site, Kentico data is retrieved from the shared database via custom&nbsp;<strong>repositories&nbsp;</strong>and&nbsp;<strong>services&nbsp;</strong>that wrap the&nbsp;<strong>Kentico API</strong>. The <em>repositories </em>make use of a unified query service (instead of calling into type-specific providers).<strong>&nbsp;</strong>Instead of Kentico objects,<strong>&nbsp;</strong>the repositories return <strong>DTOs </strong>(data transfer objects) to achieve a higher degree of testability and maintainability. All of this is handled in the&nbsp;<strong>Business </strong>project. The DTO models are used to construct custom&nbsp;<strong>view models&nbsp;</strong>and passed to&nbsp;<strong>views&nbsp;</strong>through&nbsp;<strong>controllers&nbsp;</strong>in the&nbsp;<strong>MedioClinic </strong>project.</p>\n<p>In addition to the Kentico NuGet packages, Medio Clinic has the following packages installed:</p>\n<ul>\n  <li><a href=\"https://www.nuget.org/packages/Autofac/4.8.1\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Autofac MVC 5</a>&nbsp;(4.8.1)</li>\n  <li><a href=\"https://www.nuget.org/packages/Modernizr/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Modernizr</a></li>\n</ul>\n<p>Here is a simple overview of the Medio Clinic implementation.</p>\n<figure data-asset-id=\"4967cab0-4d45-413a-adb4-0abcbaf1a797\" data-image-id=\"4967cab0-4d45-413a-adb4-0abcbaf1a797\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/8c7deaff-c513-405c-ad17-be1135928f22/updated-training-high-level-architecture.png\" data-asset-id=\"4967cab0-4d45-413a-adb4-0abcbaf1a797\" data-image-id=\"4967cab0-4d45-413a-adb4-0abcbaf1a797\" alt=\"\"></figure>\n<p><br></p>\n<h2>Retrieving data in the Business project</h2>\n<p>Medio Clinic <strong>services </strong>and <strong>repositories </strong>inherit from base classes which implement appropriate interfaces. This is to register the responsibilities into the IoC container.</p>\n<p>The essential part of the business logic in the Medio Clinic implementation is the&nbsp;<strong>DocumentQueryService</strong>. This service provides the basic functionality for retrieving all types of page data within the project, and it brings a unified way of retrieving either published versions or the very latest versions of content. It also filters data based on selected culture.</p>\n<p>The service has just two methods: <em>GetDocument</em> and <em>GetDocuments</em>. These return the <em>CMS.DocumentEngine.DocumentQuery&lt;TDocument&gt;</em> query objects. It means that the consumers of this service may further tailor the queries before running them (add predicates, specify properties of pages to be returned, etc.).</p>\n<p>In order to be injected by the IoC container to other objects, <em>DocumentQueryService </em>inherits from<em> BaseService. </em>The <em>BaseService </em>implements an empty <em>IService</em> which is required to register responsibilities into the IoC<em>.&nbsp;</em></p>\n<p><em>DocumentQueryService</em> also<em> </em>&nbsp;implements the&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/Query/IDocumentQueryService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IDocumentQueryService</em></a>&nbsp;interface. From the IoC container, the service itself accepts the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Utils/SiteContextService.cs\"><em>SiteContextService</em></a> object which is injected into the <em>DocumentQueryService</em> constructor. The reason for this is that the site context service provides the selected culture to be used for querying the database.</p>\n<p><strong>Repository</strong> classes handle the loading of data for specific page types and objects used on the site. Each repository inherits from&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/BaseRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BaseRepository</em></a>&nbsp;and implements an empty&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/IRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IRepository</em></a>&nbsp;interface (it is required by the IoC container). The <em>BaseRepository</em> constructor takes the&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/BaseRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DocumentQueryService</em></a>&nbsp;described above.&nbsp;</p>\n<p>In the Medio Clinic project, there is always a specific repository class per each page type or other Kentico artifact. Most of these classes call into the <em>DocumentQueryService</em>s <em>GetDocument</em> or <em>GetDocuments</em> methods, get the query object and alter the query object to their specific needs. Once the query is executed, they always map and reduce the returned Kentico classes into lightweight DTO objects that abstract from Kentico specifics.</p>\n<p>For example, the&nbsp;<em>CompanyRepository</em> class makes sure that the client code (the controllers and views) stay unaware of the internal format of data produced by Kentico's <strong>Country selector</strong> form control (used in the <em>Company</em> page type). <strong>Country selector</strong> stores values for both&nbsp;<em>country</em>, e.g., USA, and&nbsp;<em>state</em>, e.g., New Hampshire, into one database field. In your&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Company/CompanyRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CompanyRepository</em></a>, you should <em>split the data</em>&nbsp;retrieved from the&nbsp;\"<em>Country</em>\"<em>&nbsp;column</em>, and map separate values to the&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Company/CompanyDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CompanyDto</em></a>&nbsp;<em>Country</em> and <em>State</em>&nbsp;properties.</p>\n<p>All the repositories and services are instantiated through dependency injection (handled by the&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/DependencyInjection/BusinessDependencies.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BusinessDependencies</em>&nbsp;</a>class) and registered in <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/AutofacConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>AutofacConfig</em></a>. The implementation of the Medio Clinic website also allows use of services from the Kentico assemblies (NuGet packages), which are registered on-the-fly in the&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/DependencyInjection/CmsRegistrationSource.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CmsRegistrationSource</em></a>&nbsp;class.</p>\n<h2>Displaying data in the Medio Clinic project</h2>\n<p>The Medio clinic project contains files typical for a standard MVC website.</p>\n<p>The&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Global.asax.cs\"><em>Global.asax</em></a>&nbsp;file registered required functionality on application start. The&nbsp;<em>ApplicationBuilder</em>&nbsp;instance is used to enable and configure Kentico MVC features, for example, the use of <em>Preview</em>.&nbsp;</p>\n<p>The&nbsp;<strong>App_Start</strong>&nbsp;folder contains configuration classes used in the application start code.</p>\n<ul>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/AutofacConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>AutofacConfig</em></a> initializes the&nbsp;<em>Autofac&nbsp;</em>builder which registers both Kentico-specific and custom services, as well as repositories used throughout the whole project.</li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/BundleConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BundleConfig</em></a><em>&nbsp;</em>is a standard ASP.NET class that bundles design-related resources, such as CSS and scripts.</li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/RouteConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>RouteConfig</em></a>&nbsp;registers routes (already covered in a previous part of the training).</li>\n</ul>\n<p>The&nbsp;<strong>Config </strong>folder&nbsp;contains custom configuration classes.</p>\n<ul>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Config/AppConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>AppConfig</em></a>&nbsp;is a simple class storing global static variables, such as the code name of the Medio Clinic site.</li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Config/ConnectionStrings.config\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ConnectionString.config</em></a>&nbsp;stores the application's database connection string, separated from the project's <em>web.config</em>. When using source control, this separation allows developers to exclude this file and have their own database connection. The <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Web.config\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>web.config</em></a> needs to contain an appropriate reference.</li>\n</ul>\n<p>The <strong>Content&nbsp;</strong>folder contains design-related resources, such as CSS and scripts files, as well as static image files that are used within the website's code. Website editors cannot influence these files from the Kentico administration interface.</p>\n<p>The <strong>Models&nbsp;</strong>folder contains view model classes for the website's pages, stored within subfolders. The&nbsp;view model&nbsp;classes introduce an additional layer between DTOs and the views. This pattern allows you to easily cover views with tests.</p>\n<ul>\n  <li>All the view models inherit from <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/PageViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>PageViewModel</em></a>. Again, this class implements an empty&nbsp;<em>IViewModel</em>&nbsp;interface (for easy registration in the IoC container). Objects of this class carry common data, such as <em>Company</em>, or <em>Metadata</em>. and creates a generic class for working with DTOs used on all pages across the website. The basic <em>PageViewModel class</em>&nbsp;provides data used on all pages (views), such as&nbsp;<em>Company</em>, or&nbsp;<em>Metadata</em>. Additionally, a generic <em>PageViewModel&lt;TViewModel&gt;</em>&nbsp;class is defined, which inherits from the basic <em>PageViewModel</em> class and has a <em>Data</em> property (of type <em>TViewModel</em>). This property holds individual view-specific view models.</li>\n</ul>\n<p>Medio Clinic's&nbsp;<strong>Controllers</strong>&nbsp;work as common ASP.NET MVC 5 controllers. All controllers inherit from the&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/BaseController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BaseController</em></a>&nbsp;class, which holds a reference to all business dependencies and returns either <em>PageViewModel or PageViewModel&lt;TViewModel&gt;</em>&nbsp;with the website's data. Individual controllers load their required dependencies to retrieve data and return specific views.</p>\n<p>Controller actions return <strong>Views</strong>&nbsp;stored in corresponding subfolders. For example, the&nbsp;<em>Doctors</em>&nbsp;folder contains&nbsp;<em>Index</em>&nbsp;and&nbsp;<em>Detail</em>&nbsp;views. Let's look at some details about Medio Clinic's views.</p>\n<ul>\n  <li>Medio Clinic's shared&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Shared/_Layout.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>_Layout.cshtml</em></a>&nbsp;uses <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/PageViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>PageViewModel</em></a>&nbsp;as its model and renders the content of the website's header and footer. The header includes a culture selector and a dynamic navigation menu (covered later in the training).</li>\n  <li>Texts translated through resource strings stored in the database are provided through a custom <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Extensions/LocalizationExtensions.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Localize</em></a>&nbsp;HTML helper method.</li>\n  <li>URLs of images stored in Kentico are resolved using a custom <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Extensions/UrlExtensions.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>KenticoImageUrl</em></a> extension method.</li>\n  <li>Individual pages on the website have their own views, using the generic version of <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/PageViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>PageViewModel</em></a> as their model. Additional data of specialized view models (DTOs) is available based on the used type parameter.</li>\n  <li>Besides&nbsp;<em>namespaces</em>&nbsp;installed by default, the MedioClinic's View <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/web.config\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>web.config</em></a>&nbsp;registers&nbsp;the <em>MedioClinic.Extensions</em>&nbsp;namespace, which provides custom HTML helper methods for views defined in the <em>Business</em> project.</li>\n</ul>\n<p>Feel free to familiarize yourself with the following views:</p>\n<ul>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Shared/_Layout.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>_Layout</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Home/Index.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Home page</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Doctors/Index.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Doctors (listing page)</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Doctors/Detail.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Doctor details page</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Contact/Index.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Contact page</em></a></li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"a826260a-49fc-45e8-a718-dfd3c9d6b874","_parentId":"22dfb5f8-5e95-46bb-8472-d10dc55c050d","_type":"component","title":"Medio Clinic implementation","displayTitle":"Medio Clinic implementation"},{"body":"<p>In this task, you will set up the content loading functionality of your <em>MedioClinic</em> training website and create its main pages on the side of the MVC application.</p>\n<p>To complete the exercise, make sure your training website displays the following:</p>\n<ul>\n  <li><em>Home</em> page with the<em> </em>\"Welcome to Medio Clinic\" headline, a sub-heading with information about the clinic, and a link button to the <em>Doctors</em> listing page. In a different section of the page, display all Medio Clinic services, their headlines, descriptions, and their icons.</li>\n  <li>All doctors on a listing page, e.g., <em>Doctors</em>. The page shows doctor profile images, names, and excerpts from the doctor bio, e.g., 2 lines of text. Each doctor's \"card\" indicates if the doctor currently has an emergency shift based on the day of the week, for example using an <em>Open/Closed</em> badge.</li>\n  <li>Doctor <em>profile pages</em> with all the information entered in the admin interface, such as their name, profile image, degree, bio and info about the emergency shift.</li>\n  <li>A general site header and footer (can be hard-coded in the HTML markup of the site's main layout for now).</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"adf6fdc1-47d4-40c2-a109-2da733a919ae","_parentId":"f963a95a-5537-4c91-82e6-5e0553616366","_type":"component","title":"Task: Working with content","displayTitle":"Task: Working with content"},{"body":"<p>Before you start coding the business infrastructure, let's prepare the MedioClinic project and bring together various resources, such as css files, scripts or classes generated in the administration interface.</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>You can use design assets in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinicStaticAssets.zip\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">MedioClinicStaticAssets.zip</a> package.</p>\n<ol>\n  <li>Create a new Content folder in your Medio clinic project for the design-related files. You can add clarity and place the resources in subfolders. (E.g., <em>Css &gt; Master</em>, and <em>Images &gt; Logo</em>).</li>\n  <li>Add <em>Scripts &gt; Master</em> folders in the Medio Clinic project.&nbsp;</li>\n  <li>Add suitable resources, such as styles, images or script files from the assets package. In the end, your <em>Content</em> and <em>Script</em> folders can look like the image on the left.</li>\n</ol>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/318c3da2-987f-433f-a8df-6114876a1db3/mvc-content-design-resources.png","alt":"mvc-content-design-resources.png"},"strapline":""},{"title":"","body":"<p>The recommended practice for large projects is to separate your business logic from the MVC application into a custom class library.</p>\n<ol>\n  <li>In your solution, create a new <em>.NET Framework</em> class library project, e.g., <em>Business</em>. The class library must target the same version of the .NET Framework as both your Medio Clinic project and the administration interface, e.g., 4.6.1.</li>\n  <li>Reference the <em>Business</em> library from the <em>Medio Clinic</em> project.</li>\n</ol>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/499f1e9f-9bfb-4fce-bc71-78551ef02df3/mvc-custom-class-library.png","alt":"mvc-custom-class-library.png"},"strapline":""},{"title":"","body":"<p>In the <em>Business </em>project, install the following NuGet packages:</p>\n<ul>\n  <li><a href=\"https://www.nuget.org/packages/Autofac/4.8.1\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Autofac</a> 4.8.1</li>\n  <li><a href=\"https://www.nuget.org/packages/Kentico.Libraries/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico.Libraries</a></li>\n</ul>\n<p>In the <em>MedioClinic </em>project, install the following NuGet packages:</p>\n<ul>\n  <li><a href=\"https://www.nuget.org/packages/Autofac/4.8.1\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Autofac</a> 4.8.1</li>\n  <li><a href=\"https://www.nuget.org/packages/autofac.mvc5/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Autofac.Mvc5</a> 4.0.2</li>\n  <li><a href=\"https://www.nuget.org/packages/Modernizr/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Modernizr</a> 2.8.3</li>\n  <li><a href=\"https://www.nuget.org/packages/Kentico.AspNet.Mvc/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico.AspNet.Mvc</a> (The package will install additional three packages - <a href=\"https://www.nuget.org/packages/Kentico.AspNet.Mvc.Libraries/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico.Asp.Net.Mvc.Libraries</a>, <a href=\"https://www.nuget.org/packages/Kentico.Libraries/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico.Libraries</a>, and <a href=\"https://www.nuget.org/packages/Kentico.LanguagePack.English/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico.LanguagePack</a>.)</li>\n</ul>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/5c306b0d-e837-4418-a6b2-c4e646502f23/mvc-custom-class-library-with-packages.png","alt":"mvc-custom-class-library-with-packages.png"},"strapline":""},{"title":"","body":"<p>To retrieve data from Kentico, you will use the generated wrapper classes of various page types. The <em>Info</em> class contains the page's properties, the provider class allows you to work with pages of the given type in the MVC application's code.</p>\n<ol>\n  <li>Generate classes for all content-only page types by going to the&nbsp;<em>Page types</em>&nbsp;application &gt;&nbsp;<em>Code tab</em>&nbsp;and click the&nbsp;<em>Generate code button</em>.<br>\nBy default, the generated classes are stored in<em>&nbsp;~/Old_App_Code/CMSClasses/Pages/MedioClinic</em>.</li>\n  <li>Create a new folder <em>Generated&nbsp;</em>&gt;&nbsp;<em>Pages</em>&nbsp;in the&nbsp;<em>Business</em>&nbsp;project and copy the model classes and their accompanying <em>provider</em> classes for page types into the <em>Pages</em> folder.</li>\n  <li>Update Business project to reference to the following assemblies:\n    <ol>\n      <li>CMS.Base</li>\n      <li>CMS.DataEngine</li>\n      <li>CMS.DocumentEngine</li>\n      <li>CMS.Helpers</li>\n    </ol>\n  </li>\n</ol>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/34a82771-b940-45c3-a6a5-7c03866cc354/mvc-generated-classes.png","alt":"mvc-generated-classes.png"},"strapline":""},{"title":"","body":"<p>You can hold general information about your system's configuration, such as the <em>connection string</em>, in dedicated config files. This can help you in many situations. For example, when your development team uses a continuous integration system (together with the Continuous integration Kentico module) and each person wants to have a connection string to their own local database (the connection string config file can be excluded from the source control).</p>\n<ol>\n  <li>In the <em>Medio Clinic</em> project &gt; <em>Config</em> folder, create a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Config/ConnectionStrings.config\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ConnectionStrings.config</em></a> file.</li>\n  <li>Move the values of the <em>&lt;connectionStrings /&gt;</em> element from your Medio Clinic project's <em>web.config</em> to the new <em>ConnectionStrings.config</em>. See the content of the config file in GitHub.</li>\n</ol>\n<p>In general, your project should be ready, so let's grab some coffee and move ahead to code the site's infrastructure.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/37b4a399-f0bb-45da-b180-2f4788e7c686/mvc-developer-coffee-laptop.jpg","alt":"mvc-developer-coffee-laptop.jpg"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrative","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"a629e152-417e-4c09-b3e1-6b891ce96ea4","_parentId":"9c3120f4-2255-488f-b872-5ef0e2818e68","_type":"component","title":"Demo: Getting the MedioClinic project ready","displayTitle":"Demo: Getting the MedioClinic project ready"},{"body":"<p>In the following steps, you will see how the business logic is implemented for the Medio Clinic site. The code snippets and the comments in the demo explain how the project is built.&nbsp;However, there are many ways to make an MVC website, so feel free to implement your training website in any way you prefer.</p>\n<p>If you decide to follow the demos, please note that&nbsp;<strong>simply copy-pasting the snippets from the demo right into your solution won't likely work</strong>. The snippets should <strong>help you see</strong> what the<strong> Medio Clinic's implementation</strong> looks like. You'll need to <strong>build on these examples</strong>, and <strong>update code in your solution</strong> accordingly. At any time, feel free to consult&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12\">the final Medio Clinic solution</a>&nbsp;on GitHub if you need to see the \"big picture\".&nbsp;</p>\n<p>Also, remember that the Medio Clinic implementation shows how a large, enterprise-level Kentico website can be built with the MVC development model. It means that you will be preparing classes for multiple layers of abstraction before you actually display some data on the live site.</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>In the&nbsp;<em>Business</em>&nbsp;project, create a new&nbsp;<em>Services</em>&nbsp;folder.</p>\n<ol>\n  <li>Add an empty public&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/IService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IService</em></a><em>&nbsp;</em>interface into the folder<em>.</em></li>\n  <li>Implement the interface in a new public <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/BaseService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BaseService</em></a> abstract class with no members.</li>\n</ol>","code":{"src":"namespace Business.Services\n{\n    public abstract class BaseService : IService\n    {\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>In the <em>Business</em> project <em>Services</em> folder,</p>\n<ol>\n  <li>Create a <em>Context</em> subfolder and add a new public <em>ISiteContextService</em> interface.</li>\n  <li>In <em>ISiteContextService</em>, declare properties for the site's <em>code name</em>, <em>active culture</em>, <em>preview culture</em>, and a bool variable which will help determine whether the <em>preview mode</em> is enabled for a given request.</li>\n</ol>","code":{"src":"namespace Business.Services.Context\n{\n    public interface ISiteContextService\n    {\n        // Holds the code name of the current site\n        string SiteName { get; }\n\n        // Holds the active site culture\n        string CurrentSiteCulture { get; }\n\n        // Indicates which preview culture should be used in the preview mode\n        string PreviewCulture { get; }\n\n        // Indicates if preview is enabled\n        bool IsPreviewEnabled { get; }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Implement the interface in the following way:</p>\n<ol>\n  <li>In the <em>Medio Clinic</em> project, switch to the <em>Utils</em> folder and add a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Utils/SiteContextService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>SiteContextService</em></a> class.</li>\n  <li>Make the new class inherit from the <em>BaseService </em>class,</li>\n  <li>and implement the <em>ISiteContextService</em> interface:\n    <ol>\n      <li>Add <em>SiteName</em> and <em>CurrentSiteCulture </em>properties with <em>get</em> accessors. Values will be set via the class's constructor.</li>\n      <li>To get values for the <em>PreviewCulture</em> and <em>IsPreviewEnabled</em> properties, call Kentico extension methods on an instance of <em>System.Web.HttpContext.Current</em> (the current HTTP request). You will need to add using statements for the <em>Kentico.Content.Web.Mvc</em> and <em>Kentico.Web.Mvc</em> namespaces.</li>\n    </ol>\n  </li>\n</ol>","code":{"src":"using Business.Services.Context;\nusing Kentico.Content.Web.Mvc;\nusing Kentico.Web.Mvc;\n\nnamespace MedioClinic\n{\n    public class SiteContextService : BaseService, ISiteContextService\n    {\n        public string SiteName { get; }\n\n        public string CurrentSiteCulture { get; }\n\n        public string PreviewCulture => System.Web.HttpContext.Current.Kentico().Preview().CultureName;\n\n        public bool IsPreviewEnabled => System.Web.HttpContext.Current.Kentico().Preview().Enabled;\n\n        public SiteContextService(string currentCulture, string sitename)\n        {\n            CurrentSiteCulture = currentCulture;\n            SiteName = sitename;\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>To make instances of your <em>ISiteContextService </em>(and other interfaces later) available throughout your project, you need to configure the <em>Autofac DI </em>container.</p>\n<ol>\n  <li>In the Medio Clinic project's <em>App_Start</em> folder, create a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/AutofacConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>AutofacConfig</em></a> class.</li>\n  <li>Call <em>RegisterType&lt;SiteContextService&gt;().As&lt;ISiteContextService&gt;() </em>to register the site context service. You want to register the&nbsp;<em>SiteContextService</em>&nbsp;<a href=\"https://autofaccn.readthedocs.io/en/latest/lifetime/instance-scope.html#instance-per-request\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">per request</a>.</li>\n  <li>Also, call <em>RegisterAssemblyTypes(typeof(IService).Assembly) </em>to register all types in the assembly that implement the<em>&nbsp;IService</em>&nbsp;interface.&nbsp;</li>\n  <li>Finally, don't forget to invoke the container registration in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Global.asax.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Global.asax.cs</em></a> file (in the <em>Application_Start </em>method) by calling the <em>AutofacConfig.ConfigureContainer</em> method.</li>\n</ol>","code":{"src":"(...)\nnamespace MedioClinic.App_Start\n{\n\tpublic class AutofacConfig\n\t{\n        public static void ConfigureContainer()\n        {\n            // Initializes the Autofac builder instance\n            var builder = new ContainerBuilder();\n            (...)\n           \n           // Registers all services that implement the IService interface\n            builder.RegisterAssemblyTypes(typeof(IService).Assembly)\n                .Where(x => x.IsClass && !x.IsAbstract && typeof(IService).IsAssignableFrom(x))\n                .AsImplementedInterfaces()\n                .InstancePerRequest();\n\n            // Registers the site context service\n            builder.RegisterType<SiteContextService>().As<ISiteContextService>()\n                .WithParameter((parameter, context) => parameter.Name == \"currentCulture\",\n                    (parameter, context) => CultureInfo.CurrentUICulture.Name)\n                .WithParameter((parameter, context) => parameter.Name == \"sitename\",\n                  (parameter, context) => AppConfig.Sitename)\n                .InstancePerRequest();\n        }\n    }\n}\n(...)","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Things like menu items, social links or site context information will often be used together in your site's controllers (and other code). You can wrap these dependencies into a BusinessDependencies class and let the IoC container inject them at one time.</p>\n<ol>\n  <li>In the <em>Business</em> project, create a new <em>DependencyInjection</em>&nbsp;folder and add an <em>IBusinessDependencies</em> interface.</li>\n  <li>Declare a property for accessing an instance of <em>ISiteContextService</em>.</li>\n</ol>\n<p>You will declare other business-related properties later within this class.</p>","code":{"src":"using Business.Services.Context;\n\nnamespace Business.DependencyInjection\n{\n    public interface IBusinessDependencies\n    {\n        ISiteContextService SiteContextService { get; }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<ol>\n  <li>Create a new <em>BusinessDependencies</em> class in the <em>DependencyInjection </em>folder, in which you &nbsp;accept the context service object from the IoC container.</li>\n  <li>Don't forget to register <em>BusinessDependencies </em>in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/AutofacConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Autofac container</em></a><em> </em>by calling <em>builder.RegisterType&lt;BusinessDependencies&gt;().As&lt;IBusinessDependencies&gt;().InstancePerRequest()</em>.</li>\n</ol>","code":{"src":"using Business.Services.Context;\n\nnamespace Business.DependencyInjection\n{\n    public class BusinessDependencies : IBusinessDependencies\n    {\n        public ISiteContextService SiteContextService { get; }\n\n        public BusinessDependencies(\n            ISiteContextService siteContextService\n            )\n        {\n            SiteContextService = siteContextService;\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>To separate the Kentico API from your MVC application's code, let's wrap Kentico <em>DocumentQuery</em> in the custom service that you've read about earlier.</p>\n<ol>\n  <li>In the <em>Business</em> project's <em>Services</em> folder, create a new <em>Query</em> subfolder and add a public <em>IDocumentQueryService</em> interface.</li>\n  <li>Define two wrapper methods around Kentico <a href=\"https://docs.kentico.com/k12/custom-development/working-with-pages-in-the-api#WorkingwithpagesintheAPI-Retrievingpages\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">DocumentQuery</a>. These methods build common parts of query objects used throughout the site. They select a site to retrieve from, they filter for either published or the very latest versions of pages, and they also filter for the currently selected culture. Both methods will be generic on TDocument which represents page type's generated models.\n    <ol>\n      <li>The first <em>GetDocument</em> method will build a query for a single document identified by its <em>nodeGuid</em>.</li>\n      <li>The second <em>GetDocuments</em> method will be parameterless. The query object returned by this method will be custom tailored (and invoked) by repositories' methods.</li>\n    </ol>\n  </li>\n</ol>\n<p>(You will need to add a <em>CMS.DocumentEngine</em> using statement.)</p>","code":{"src":"(...)\nusing CMS.DocumentEngine;\n\nnamespace Business.Services.Query\n{\n    public interface IDocumentQueryService\n    {\n        /// <summary>\n        /// Wrapper around Kentico's DocumentQuery. \n        /// This query filters data based on active culture and handles the preview mode.\n        /// </summary>\n        /// <typeparam name=\"TDocument\">Type of the generated page</typeparam>\n        /// <param name=\"nodeGuid\">NodeGuid of the page</param>\n        /// <returns>DocumentQuery to a document identified by its nodeGuid</returns>\n        DocumentQuery<TDocument> GetDocument<TDocument>(Guid nodeGuid) where TDocument : TreeNode, new();\n\n        /// <summary>\n        /// Wrapper around Kentico's DocumentQuery. \n        /// This query filters data based on active culture and handles the preview mode.\n        /// </summary>\n        /// <typeparam name=\"TDocument\">Type of the generated page</typeparam>\n        /// <returns>DocumentQuery documents</returns>\n        DocumentQuery<TDocument> GetDocuments<TDocument>() where TDocument : TreeNode, new();\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>To retrieve page data from the database, implement the&nbsp;<em>IDocumentQueryService</em>&nbsp;interface in a new&nbsp;<em>DocumentQueryService</em>&nbsp;class<em>.</em></p>\n<ol>\n  <li>Make the <em>DocumentQueryService</em> inherit from the abstract <em>BaseService</em>.</li>\n  <li>Declare an&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/Context/ISiteContextService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ISiteContextService</em></a><em>&nbsp;</em>read-only property to store the context.</li>\n  <li>Declare <em>_coreColumns</em> property to return default values for the document query: <em>NodeGUID</em>, <em>DocumentID</em>, and <em>NodeID</em>.&nbsp;</li>\n  <li>Implement a constructor that accepts the site context object from the IoC container and stores it in the property from the first step.</li>\n  <li>Implement the <em>GetDocuments</em> method.</li>\n</ol>\n<p>The <em>GetDocuments</em> query method uses the site context's <em>active culture</em> and the <em>preview mode</em> to build the base query. The base query object will be custom tailored mainly by repositories' methods to suit their needs. In fact, the <em>GetDocument</em> method from the previous step is one such client method. It also alters the base query.&nbsp;</p>\n<p>Implement the method in the following steps:</p>\n<ol>\n  <li>Call the <em>CMS.DocumentEngine.DocumentHelper.GetDocuments()</em>&nbsp;method and pass around the <em>TDocument</em> generic parameter representing the <em>page type. </em>Capture the result in a local <em>query </em>variable.</li>\n  <li>To process the query further, add an <em>if </em>statement that splits the execution based on the preview mode.</li>\n  <li>Define a condition in which either the published or the latest version of the document is queried for.</li>\n  <li>Chain other query methods according to the code example. These handle queries by the site code name, the active culture, and they add one column (property) to the retrieved pages.</li>\n</ol>","code":{"src":"using System;\nusing CMS.DocumentEngine;\nusing Business.Services.Context;\n\nnamespace Business.Services.Query\n{\n    public class DocumentQueryService : BaseService, IDocumentQueryService\n    {\n        private ISiteContextService SiteContext { get; }\n        \n        private readonly string[] _coreColumns = \n        {\n            \"NodeGUID\", \"DocumentID\", \"NodeID\"\n        }\n\n        public DocumentQueryService(ISiteContextService siteContext)\n        {\n            SiteContext = siteContext;\n        }\n\n(...)\npublic DocumentQuery<TDocument> GetDocuments<TDocument>() where TDocument : TreeNode, new()\n        {\n            var query = DocumentHelper.GetDocuments<TDocument>();\n\n            // Evaluates whether preview mode is enabled\n            if (SiteContext.IsPreviewEnabled)\n            {\n                // Loads the latest version of pages as preview mode is enabled\n                query = query\n                    .Columns(_coreColumns.Concat(new []{ \"NodeSiteID\" })) // Sets initial columns returned for optimization.\n                    //Adds 'NoteSiteD' column required for the Preview mode.\n                    .OnSite(SiteContext.SiteName) // There could be more sites with matching page\n                    .LatestVersion()\n                   . Published(false)\n                    .Culture(SiteContext.PreviewCulture);\n            } else {\n                // Loads the published version of pages\n                query = query\n                    .Columns(_coreColumns) // Sets initial columns returned for optimization.\n                    .OnSite(SiteContext.SiteName)\n                    .Published()\n                    .PublishedVersion()\n                    .Culture(SiteContext.CurrentSiteCulture);\n            }\n\n            return query;\n        }","lang":"csharp"},"strapline":""},{"title":"","body":"<ol>\n  <li>Now, implement the second query method. This method takes <em>nodeGuid</em> and returns the query object for a single page. This method calls into the <em>GetDocuments</em> query method that you have implemente in the previous step.</li>\n</ol>","code":{"src":"(...)\nusing CMS.DocumentEngine;\nusing Business.Services.Context;\n\nnamespace Business.Services.Query\n{\n    public class DocumentQueryService : BaseService, IDocumentQueryService\n    {\n        (...)\n\n        public DocumentQuery<TDocument> GetDocument<TDocument>(Guid nodeGuid) where TDocument : TreeNode, new()\n        {\n            return GetDocuments<TDocument>()\n                .TopN(1)\n                .WhereEquals(\"NodeGUID\", nodeGuid);\n        }\n\n        (...)\n\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>To easily use the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/Query/DocumentQueryService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DocumentQueryService</em></a> in all the repositories that will retrieve page content from the database, you can create an abstract base repository.</p>\n<ol>\n  <li>Create a new <em>Repository</em> folder in the <em>Business</em> project and add a BaseRepository.cs file.</li>\n  <li>Declare a read-only property of the document query service and initialize it in your constructor (again, with an object from the IoC container).</li>\n</ol>\n<p>(See the top part of the code sample for specific details of the implementation.)</p>\n<ol>\n  <li>In the <em>Repository</em> folder, add a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/IRepository.cs\"><em>IRepository</em></a> interface<em>.</em>&nbsp;Similarly to the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/IService.cs\"><em>IService</em></a> interface, <em>IRepository</em> does not have any members. It only serves as an identifier that the&nbsp;IoC<em> </em>container will search for and use to <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/AutofacConfig.cs\">inject</a> concrete types of repositories.<br>\n(Each specific repository class will have its own interface (e.g., the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Company/CompanyRepository.cs\">CompanyRepository</a> class will implement <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Company/ICompanyRepository.cs\">ICompanyRepository</a>), which in turn will implement <em>IRepository</em>. On top of that, most repository classes will inherit from <em>BaseRepository</em> implemented in the previous step.)</li>\n</ol>\n<p>Once you have created your IRepository.cs, head on to register repositories that implement the <em>IRepository</em> in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/AutofacConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>AutofacConfig</em></a>. See the bottom part of the code sample for implementation details.</p>","code":{"src":"using Business.Services.Query;\n\nnamespace Business.Repository\n{\n    public abstract class BaseRepository : IRepository\n    {\n        protected IDocumentQueryService DocumentQueryService { get; }\n\n        protected BaseRepository(IDocumentQueryService documentQueryService)\n        {\n            DocumentQueryService = documentQueryService;\n        }\n    }\n}\n\n\n// Example of code from AutofacConfig\n// Registers all repositories that implement the IRepository interface\nbuilder.RegisterAssemblyTypes(typeof(IRepository).Assembly)\n    .Where(x => x.IsClass && !x.IsAbstract && typeof(IRepository).IsAssignableFrom(x))\n    .AsImplementedInterfaces()\n    .InstancePerRequest();","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Before you start implementing the repositories, controllers, models and views for individual pages on the Medio Clinic website, you might first want to retrieve and map data which repeats across the entire site (for example, the company name and address).</p>\n<p>Prior to creating the <em>ICompanyRepository</em> interface, create a <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Company/CompanyDto.cs\">CompanyDto</a> class and an empty <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/IDto.cs\">IDto</a> interface.</p>\n<ol>\n  <li>In the <em>Business</em> project, create a new <em>Dto</em> folder and the <em>IDto.cs</em> codefile. Individual <em>DTO</em> classes will reside in their own subfolders. Create a <em>CompanyDto</em> subfolder.</li>\n  <li>The <em>CompanyDto</em> class should implement <em>IDto</em> (so do all other individual DTO classes). You will reference <em>CompanyDto</em> from within <em>ICompanyRepository</em> later.</li>\n</ol>","code":{"src":"namespace Business.Dto.Company\n{\n    public class CompanyDto : IDto\n    {\n        public string Name { get; set; }\n        public string Street { get; set; }\n        public string City { get; set; }\n        public string Country { get; set; }\n        public string State { get; set; }\n        public string PhoneNumber { get; set; }\n        public string Email { get; set; }\n        public string ZipCode { get; set; }\n\n        public string ShortAddress => $\"{Street}, {City}, {Country}\";\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Lets first create the&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Company/ICompanyRepository.cs\">ICompanyRepository</a>&nbsp;interface. Do so in the new&nbsp;<em>Repository/Company</em>&nbsp;folder.</p>","code":{"src":"using Business.Dto.Company;\n\nnamespace Business.Repository.Company\n{\n    public interface ICompanyRepository\n    {\n        CompanyDto GetCompany();\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Now implement the&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Company/CompanyRepository.cs\"><em>CompanyRepository</em></a>&nbsp;itself. &nbsp;First, make it inherit the <em>BaseRepository</em> and implement the <em>ICompanyRepository</em> interface. The <em>GetCompany </em>method then builds the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Company/CompanyDto.cs\"><em>CompanyDto</em></a> object by:</p>\n<ul>\n  <li>Retrieving the base DocumentQuery object from the DocumentQueryService mentioned before.</li>\n  <li>Altering the query object with the <em>AddColumns</em> and <em>TopN</em> extension method calls.</li>\n  <li>Executing the query by calling <em>ToList</em>.</li>\n  <li>Projecting the retrieved <em>List&lt;CMS.DocumentEngine.Types.MedioClinic.Company&gt;</em> collection into <em>IEnumerable&lt;CompanyDto&gt;</em>.</li>\n  <li>Finally, converting the <em>IEnumerable&lt;CompanyDto&gt;</em> sequence into the CompanyDto object by calling <em>FirstOrDefault()</em>.</li>\n</ul>\n<p>Note the additional logic in&nbsp;<em>CompanyDto</em>&nbsp;and&nbsp;<em>CompanyRepository</em>.</p>\n<ul>\n  <li>The&nbsp;<em>CompanyDto&nbsp;</em>builds the&nbsp;<em>ShortAddress&nbsp;</em>string property from other properties in the object<em>.</em></li>\n  <li>The&nbsp;<em>CompanyRepository.GetCompany</em> method splits the country and state names which Kentico&nbsp;<em>Country selector</em>&nbsp;form control previously stored into one database field.</li>\n</ul>\n<p>(See the code sample for additional details).</p>\n<p>Before you move to the next step, your website should contain the following classes (if you want to continue following the demos later in the course):</p>\n<ul>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Company/CompanyDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CompanyDto</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Company/CompanyRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CompanyRepository</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Company/ICompanyRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ICompanyRepository</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Social/SocialLinkDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>SocialLinkDto</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Social/SocialLinkRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>SocialLinkRepository</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Social/ISocialLinkRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ISocialLinkRepository</em></a></li>\n</ul>\n<p>The <em>CultureService</em> class slightly differs from the repositories, and youll implement it in the next step. For now, just don't forget to enlist your new repositories in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/DependencyInjection/IBusinessDependencies.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IBusinessDependencies</em></a> interface and also the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/DependencyInjection/BusinessDependencies.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BusinessDependencies</em></a> class.</p>","code":{"src":"(...)\n// CompanyRepository\npublic CompanyDto GetCompany()\n        {\n            return DocumentQueryService.GetDocuments<CMS.DocumentEngine.Types.Training.Company>()\n                .AddColumns(\"CompanyName\", \"Street\", \"City\", \"Country\", \"ZipCode\", \"PhoneNumber\", \"Email\")\n                .TopN(1)\n                .ToList()\n                // Splits the Country field which stores country and state values\n                .Select(m =>\n                {\n                    var splitCountry = m.Country.Split(';');\n\n                    string country;\n                    string state = null;\n                    if (splitCountry.Length == 2)\n                    {\n                        country = splitCountry[0];\n                        state = splitCountry[1];\n                    }\n                    else\n                    {\n                        country = m.Country;\n                    }\n\n                    return new CompanyDto()\n                    {\n                        Name = m.CompanyName,\n                        City = m.City,\n                        Street = m.Street,\n                        Country = country,\n                        State = state,\n                        Email = m.Email,\n                        PhoneNumber = m.PhoneNumber,\n                        ZipCode = m.ZipCode\n                    };\n                })\n                .FirstOrDefault();\n        }","lang":"csharp"},"strapline":""},{"title":"","body":"<p>The <a href=\"https://github.com/Kentico/training-kentico-k12/tree/master/Business/Services/Culture\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CultureService</em></a> class retrieves cultures from <em>CMS.SiteProvider.CultureSiteInfoProvider</em>.</p>\n<ol>\n  <li>In the <em>Business</em> project &gt; <em>Dto</em> folder, create a new <em>Culture</em> folder and add a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Culture/CultureDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CultureDto</em></a><em> </em>class. Declare the following properties of type <em>string:</em> <em>CultureCode</em>, <em>CultureName</em>, and <em>CultureShortName</em>.</li>\n  <li>In the <em>Business</em> project &gt; <em>Services </em>folder, create a new <em>Culture</em> subfolder and add an <em>ICultureService</em> interface which defines a <em>GetSiteCultures</em>&nbsp;method.</li>\n  <li>Implement the interface in the new&nbsp;<em>CultureService</em>&nbsp;class which inherits from the <em>BaseService</em>.</li>\n  <li>The <em>CultureService</em> class takes &nbsp;<em>SiteContextService </em>and retrieves culture from <em>CMS.SiteProvider.CultureSiteInfoProvider </em>by calling the <em>GetSiteCultures </em>method, and returns a collection of <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Culture/CultureDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CultureDto</em></a>&nbsp;objects with Kentico culture data mapped to their properties.</li>\n  <li>Also, don't forget to enlist the new service in the&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/DependencyInjection/BusinessDependencies.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BusinessDependencies</em></a><em>&nbsp;</em>class<em>.</em></li>\n</ol>","code":{"src":"// Example of the CultureService\n(...)\npublic class CultureService : BaseService, ICultureService\n    {\n        private ISiteContextService SiteContextService { get; }\n\n        public CultureService(ISiteContextService siteContextService)\n        {\n            SiteContextService = siteContextService;\n        }\n\n        public IEnumerable<CultureDto> GetSiteCultures()\n        {\n            return CultureSiteInfoProvider.GetSiteCultures(SiteContextService.SiteName).Items.Select(m =>\n                new CultureDto()\n                {\n                    CultureCode = m.CultureCode,\n                    CultureName = m.CultureName,\n                    CultureShortName = m.CultureShortName\n                }\n            );\n        }\n    }","lang":"csharp"},"strapline":""},{"title":"","body":"<p>In the previous steps, you prepared logic which retrieves Kentico data and maps it to their respective DTOs. Now you should pass DTOs to view models which are consumed by views. But if you started implementing the view models one by one, youd soon realize that you repeatedly created properties representing common parts like information about the company and links to its social media profiles.</p>\n<p>You don't want to repeat the same code in all those view models. To deal with that, you can introduce a&nbsp;<em>PageViewModel</em> class that wraps that common data instead.</p>\n<ol>\n  <li>In the <em>Medio Clinic</em> project, create a new <em>Models</em> folder to collect the suitable classes.</li>\n  <li>To keep the design approach consistent, create an empty&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/IViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IViewModel</em></a>&nbsp;interface, and make the&nbsp;<em>page view model</em>&nbsp;implement it. This empty interface serves as a base interface for all views. It can be helpful if you need to add or change something across all the pages on the website it in the future.</li>\n  <li>Create a <em>PageViewModel</em> base model for your pages. The non-generic class is designed for pages (views) that dont display anything else than the company information, cultures, and social links, for example, the <em>NotFound</em> page.</li>\n  <li>Create a generic <em>PageViewModel&lt;TViewModel&gt;</em> class which inherits from the base model. (The generic view model represents models for pages that also display other information captured in the generic TViewModel Data property, for instance, <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/Home/HomeViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>HomeViewModel</em></a> or <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/Contact/ContactViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ContactViewModel</em></a>).</li>\n  <li>Make the generic <em>view model</em> implement the empty <em>IViewModel</em> interface for consistency.</li>\n</ol>","code":{"src":"using System.Collections.Generic;\nusing Business.Dto.Company;\nusing Business.Dto.Culture;\nusing Business.Dto.Social;\n\nnamespace MedioClinic.Models\n{\n    // Base class\n    public class PageViewModel : IViewModel\n    {\n        public CompanyDto Company { get; set; }\n        public IEnumerable<CultureDto> Cultures { get; set; }\n        public IEnumerable<SocialLinkDto> SocialLinks { get; set; }\n    }\n    // Inherits page view model \n    // Accepts generic view model which represents data for other pages on the website\n    public class PageViewModel<TViewModel> : PageViewModel where TViewModel : IViewModel\n    {\n        public TViewModel Data { get; set; }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>So far we have repositories with their DTOs, all of that wrapped in our BusinessDependencies class. Now we need controllers to accept requests with their route data, pick the right model from the repositories and render an appropriate view.</p>\n<p>Similarly to view models, if you started implementing controllers one by one, youd repeat the logic related to company information, cultures, and social links.</p>\n<p>Thus you may want to process repeated requests in <em>BaseController. </em>The <em>BaseController</em> will only model the repeated data. The requests will be resolved in <em>controllers</em> derived from the <em>BaseController</em>, such as the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/HomeController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>HomeController</em></a> or <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/DoctorsController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorsController</em></a>.</p>\n<ol>\n  <li>Create the <em>BaseController</em> class in the <em>Controllers</em> folder.</li>\n  <li>Similarly to previous classes, make the necessary provisions to take business dependencies &nbsp;from the IoC container and store them in a property.</li>\n  <li>Implement the two GetPageViewModel and GetPageViewModel&lt;TViewModel&gt; public methods and their supportive private methods as seen in GitHub. The methods are responsible for populating the view models with data from repositories. (You'll learn more about them in the next step.)</li>\n  <li>Invoke the&nbsp;<em>RegisterControllers</em>&nbsp;method in the&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/AutofacConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>AutofacConfig</em></a>, so that the IoC container resolves dependencies in Medio Clinic's controllers.</li>\n</ol>\n<p>Now, wrap the page <em>title</em> &nbsp;displayed in the browser tab and the <em>company name</em> in the logo area, into a new <em>PageMetaDataDto</em> class.</p>\n<ol>\n  <li>In <em>Business</em> project &gt; <em>Dto</em> folder, create a new folder <em>Page</em>. Add the new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Page/PageMetadataDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>PageMetadataDto</em></a><em> </em>class and define the metadata properties, such as <em>title</em> or <em>company name</em>.&nbsp;</li>\n  <li>In the <em>BaseController</em>, create a <em>private</em> <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/BaseController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>GetPageMetadata</em></a> method to map related data to the <em>PageMetadataDto </em>object.</li>\n</ol>","code":{"src":"(...)\nnamespace MedioClinic.Controllers\n{\n    public class BaseController : Controller\n    {\n        // Gets related business dependencies\n        protected IBusinessDependencies Dependencies { get; }\n        protected BaseController(IBusinessDependencies dependencies)\n        {\n            Dependencies = dependencies;\n        }\n\n        // Returns new page view model with mapped data\n        public PageViewModel GetPageViewModel(string title)\n        {\n            return new PageViewModel()\n            {\n                (...)\n                Metadata = GetPageMetadata(title),\n                Cultures = Dependencies.CultureService.GetSiteCultures(),\n                (...)\n            };\n        }\n\n        (...)\n      \n        // Maps metadata of pages, such as the title tag in the browser\n        private PageMetadataDto GetPageMetadata(string title)\n        {\n            return new PageMetadataDto()\n            {\n                Title = title,\n                CompanyName = Dependencies.SiteContextService.SiteName\n            };\n        }\n\n        (...)\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Similarly to the approach you took with the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Page/PageMetadataDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>PageMetadataDto</em></a>, can implement two additional private methods for company data and its social media presence.&nbsp;</p>\n<ol>\n  <li>Declare <em>private</em> <em>GetCompany</em> method to get company related data mapped in the <em>CompanyDto</em>.</li>\n  <li>Similarly, declare private <em>GetSocialLinks</em> method to create a collection of links mapped to the <em>SocialLinkDto</em>'s properties.</li>\n</ol>","code":{"src":"(...)\n\nprivate IEnumerable<SocialLinkDto> GetSocialLinks()\n       {\n           return Dependencies.SocialLinkRepository.GetSocialLinks();\n       }\n\n(...)\n\nprivate CompanyDto GetCompany()\n        {\n            return Dependencies.CompanyRepository.GetCompany();\n        }","lang":"csharp"},"strapline":""},{"title":"","body":"<ol>\n  <li>Implement the second <em>GetPageViewModel</em> method that is generic on <em>TViewModel</em>.&nbsp;</li>\n  <li>The generic view model <em>TViewModel</em> type represents all view models, such as the <em>HomeViewModel</em>.</li>\n</ol>\n<p>You can see the final <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/BaseController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BaseController</em></a> on GitHub. It contains some additional code, e.g., for a navigation menu, you will be adding later in the course.</p>","code":{"src":"(...)\npublic PageViewModel<TViewModel> GetPageViewModel<TViewModel>(TViewModel data, string title) where TViewModel : IViewModel\n        {\n            return new PageViewModel<TViewModel>()\n            {\n                Metadata = GetPageMetadata(title),\n                Company = GetCompany(),\n                Cultures = Dependencies.CultureService.GetSiteCultures(),\n                SocialLinks = GetSocialLinks(),\n                Data = data\n            };\n        }\n(...)","lang":"csharp"},"strapline":""},{"title":"","body":"<p>At some point in the future, you may also want to use some of the built-in <em>Kentico services</em>, such as &nbsp;<a href=\"https://docs.kentico.com/k12/on-line-marketing-features/configuring-and-customizing-your-on-line-marketing-features/configuring-contacts/tracking-contacts-on-mvc-sites\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">contact tracking</a> or <a href=\"https://docs.kentico.com/k12/on-line-marketing-features/configuring-and-customizing-your-on-line-marketing-features/configuring-email-marketing/handling-newsletter-subscriptions-on-mvc-sites\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">newsletter subscriptions</a>. We recommend that you implement an on-the-fly registration for all services that are part of the Kentico API (included in the <em>Kentico.Libraries</em> NuGet package). You can check Kentico documentation for additional information about <a href=\"https://docs.kentico.com/k12/developing-websites/initializing-kentico-services-with-dependency-injection\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">initializing Kentico services in an IoC container</a>.</p>\n<ol>\n  <li>In the <em>Business</em> project &gt; <em>DependencyInjection</em> folder, create a <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/DependencyInjection/CmsRegistrationSource.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CmsRegistrationSource</em></a><em>&nbsp;</em>class.</li>\n  <li>Follow the sample code and implement the methods accordingly. Don't forget to add required using statements, namely <em>Autofac.Core</em> and <em>Autofac.Builder</em>.</li>\n  <li>Call the <em>RegisterSource</em> method in <a href=\"https://github.com/Kentico/training-kentico-k12/blob/e5501d068435b2ad59faad6d5ccb5059f524edab/MedioClinic/App_Start/AutofacConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>AutofacConfig</em></a><em>&nbsp;</em>to register the Kentico services in the Medio Clinic project.</li>\n</ol>","code":{"src":"(...)\nusing Autofac.Builder;\nusing Autofac.Core;\n\nnamespace Business.DependencyInjection\n{\n    public class CmsRegistrationSource : IRegistrationSource\n    {\n        /// <summary>\n        /// Gets whether the registrations provided by this source are 1:1 adapters on top of other components (I.e. like Meta, Func or Owned.)\n        /// </summary>\n        public bool IsAdapterForIndividualComponents => false;\n\n        /// <summary>\n        /// Retrieves registration for an unregistered service that is to be used by the container.\n        /// </summary>\n        /// <param name=\"service\">The service that was requested.</param>\n        /// <param name=\"registrationAccessor\">A function that returns existing registrations for a service.</param>\n        public IEnumerable<IComponentRegistration> RegistrationsFor(Service service, Func<Service, IEnumerable<IComponentRegistration>> registrationAccessor)\n        {\n            // Checks if the container already contains an existing registration for the requested service\n            if (registrationAccessor(service).Any())\n            {\n                return Enumerable.Empty<IComponentRegistration>();\n            }\n            // Checks if the required service carries valid type information\n            if (!(service is IServiceWithType swt))\n            {\n                return Enumerable.Empty<IComponentRegistration>();\n            }\n\n            // Gets an instance of the requested service using CMS.Core.API\n            object instance = null;\n            if (CMS.Core.Service.IsRegistered(swt.ServiceType))\n            {\n                instance = CMS.Core.Service.Resolve(swt.ServiceType);\n            }\n\n            if (instance == null)\n            {\n                return Enumerable.Empty<IComponentRegistration>();\n            }\n\n            // Registers the service instance in the container\n            return new[] { RegistrationBuilder.ForDelegate(swt.ServiceType, (c, p) => instance).CreateRegistration() };\n        }\n    }\n}","lang":"csharp"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrativeCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"aaf59c28-619a-4a3a-9f1b-77315ce89c15","_parentId":"8e53ddd0-5945-4092-8d94-4d6c601574a3","_type":"component","title":"Demo: Creating the business infrastructure","displayTitle":"Demo: Creating the business infrastructure"},{"body":"<p>At this point, youve already implemented repositories that provide DTOs and a base controller. You did most of your work in the <em>Business</em> project. Now it is time to prepare artifacts in the <em>MedioClinic</em> project - namely a general layout for the site, the view of the home page and a home page controller.</p>\n<p>Note that the following steps show one of the many ways you can take to build the Medio Clinic's home page. It continues in building the site with the infrastructure prepared in the previous part of the course, so it's possible that your solution will differ. The code snippets and the comments in the demo explain how the Medio Clinic is built.&nbsp;However, there are many ways to make an MVC website, so feel free to implement your <em>Home </em>page in a way you prefer.</p>\n<p>If you decide to follow the demo, please note that&nbsp;<strong>simple copy-pasting the snippets from the demo right into your solution won't likely work.</strong> The snippets should <strong>help you see</strong> what the<strong> Medio Clinic's implementation</strong> looks like. For a fully working code, feel free to consult&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12\">the final Medio Clinic solution</a>&nbsp;on GitHub.</p>\n<h3>The Home page</h3>\n<p>Data for the <em>Home</em> page is stored in four separate content-only pages - the <em>HomeSection</em> and three child pages (in the content tree). The child pages store information about Medio clinic's services in text and icons in the format of page attachments.</p>\n<p>You'll now put common parts of pages' markup into an ordinary <em>_Layout</em> view, and then you'll put it together with the <em>Home</em>'s <em>Index</em> <em>v</em>iew to display the Medio Clinic's home page.</p>\n<p>(Optional: You can also see <a href=\"https://drafteuwest.blob.core.windows.net/63117da1-007f-01dd-86eb-23e8353ac375/6bdeff9b-adec-470a-887c-e96dedef90e9/MedioClinicHomePageDiagram.png?sv=2017-07-29&amp;sr=b&amp;sig=rc8DCRQa3uJLreHIOSY0qZGQHYa7azKaRI9rDaWRSu0%3D&amp;se=2019-03-23T12%3A36%3A52Z&amp;sp=r\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">a diagram of classes</a> that participate in displaying the content of the <em>Home page</em> on the live site.)</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>First, let's prepare the website's layout.</p>\n<ol>\n  <li>Add a new<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Shared/_Layout.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"> <em>_Layout.cshtml</em></a> file within the <em>Shared</em> folder, and a <em>ViewStart</em> file. Then you can take the following steps:</li>\n  <li>Copy-paste the content of the <em>index.html</em> file from the Medio Clinic's course resources.</li>\n  <li>Call <em>@RenderBody</em> between the ending <em>&lt;/nav&gt; </em>tag and the opening <em>&lt;footer&gt;</em> tag.</li>\n  <li>Use the @model directive to strongly-type the <em>_Layout</em> against <em>@MedioClinic.Models.PageViewModel</em>.</li>\n  <li>Update references to the design-related files, such as CSS, icons, and scripts. (The course will be covering bundling and minification later, however, feel free to implement the bundles now.)</li>\n</ol>\n<p>At the end of this step, the updated parts of the <em>_Layout </em>header and footer might look like the snippet on the left.</p>\n<p>You don't want to repeatedly add the same <em>using</em> statements for specific namespaces, such as <em>Kentico.Web.Mvc</em>, directly to the views so that you can use their methods.</p>\n<ol>\n  <li>Edit the project's&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/web.config\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Views\\web.config</em></a>&nbsp;file and add the&nbsp;<em>MedioClinic, Kentico.Content.Web.Mvc,&nbsp;</em>and<em>&nbsp;Kentico.Web.Mvc&nbsp;</em>namespaces. This allows you to access methods in these namespaces in any of your views.</li>\n</ol>","code":{"src":"@model MedioClinic.Models.PageViewModel\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1.0\" />\n    <title>Home | Medio Clinic</title>\n    <!-- CSS  -->\n    <link rel=\"shortcut icon\" type=\"image/png\" href=\"~/Content/Images/Logo/mcfavicon.ico\">\n    <link href=\"https://fonts.googleapis.com/icon?family=Material+Icons\" rel=\"stylesheet\">\n    <link href=\"~/Content/Css/Master/materialize.min.css\" type=\"text/css\" rel=\"stylesheet\" media=\"screen,projection\" />\n    <link href=\"~/Content/Css/Master/style.css\" type=\"text/css\" rel=\"stylesheet\" media=\"screen,projection\" />\n    <link href=\"~/Content/Css/Master/icons.css\" type=\"text/css\" rel=\"stylesheet\" media=\"screen,projection\" />\n    <link rel=\"stylesheet\" href=\"https://use.fontawesome.com/releases/v5.1.0/css/all.css\" integrity=\"sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt\"\n          crossorigin=\"anonymous\">\n</head>\n<body>\n  <nav class=\"white\" role=\"navigation\">\n  (...)\n  </nav>\n\n   @RenderBody()\n    \n    <footer class=\"page-footer blue-grey darken-4\">\n   (...)\n    </footer>\n\n    <!-- Scripts -->\n   <script src=\"js/main.js\"></script>\n    <script src=\"js/materialize.min.js\"></script>\n\n</body>\n</html>","lang":"html"},"strapline":""},{"title":"","body":"<p>First, let's prepare Kentico data. You'll build on the business infrastructure and retrieve the suitable data using repositories which create DTOs. You will then pass them to a newly created <em>HomeViewModel. </em>You will then pass the view model to a suitable view.</p>\n<p>This approach is used all across the Medio Clinic website, so let's see in detail how the logic is built.</p>\n<ol>\n  <li>In the <em>Business</em> project &gt; <em>Dto</em> folder, create a new <em>Home</em> subfolder. Then add a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Home/HomeSectionDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>HomeSectionDto</em></a> class and define properties for <em>link text</em>, <em>title</em>, and <em>text</em> which will appear in the clinic's header section. The DTO should implement the empty <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/IDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IDto</em></a> interface for consistency.</li>\n  <li>In the <em>Business</em> project &gt; <em>Repository</em> folder, create a new <em>Home</em> subfolder. Add a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Home/IHomeSectionRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IHomeSectionRepository</em></a> interface with <em>GetHomeSection</em> method which will map the home section's data.</li>\n  <li>In the same folder, create a new <em>HomeSectionRepository</em> which implements the interface.</li>\n  <li>At the same time, the repository inherits from <em>BaseRepository</em>, so add an empty constructor to call the ancestor class' constructor in the background to initialize the <em>document query service</em>.</li>\n  <li>Implement the&nbsp;<em>GetHomeSection</em>&nbsp;method so that it retrieves the&nbsp;<em>CMS.DocumentEngine.Types.MedioClinic.HomeSection</em>&nbsp;objects, maps them&nbsp;to&nbsp;<em>HomeSectionDto</em>&nbsp;objects and converts the sequence to a single object.</li>\n  <li>In <em>GetHomeSection,</em>&nbsp;use the Kentico API <em>DocumentQuery.GetDocuments()</em> method, and custom-tailor the query in the following way:\n    <ol>\n      <li>Add only specific page type's columns (<em>Title</em>,&nbsp;<em>Text</em>, and&nbsp;<em>Button</em>) by calling the&nbsp;<em>AddColumns()</em>,</li>\n      <li>Limit the number of records to 1 by calling the&nbsp;<em>TopN()</em>,</li>\n    </ol>\n  </li>\n  <li>Then, make provisions to return the HomeSectionDto object:\n    <ol>\n      <li>Execute the query by calling ToList().</li>\n      <li>Map the collection to a&nbsp;new&nbsp;<em>IEnumerable&lt;HomeSectionDto&gt; </em>sequence&nbsp;objects via the <em>Select()</em> call.</li>\n      <li>Convert the sequence to a single object through <em>FirstOrDefault()</em>.</li>\n    </ol>\n  </li>\n</ol>\n<p>You now have only the data you need mapped to the DTO, so let's build the corresponding <em>view model</em>.</p>\n<p><em>(Continues in the next step)</em></p>","code":{"src":"// Home section DTO object\n(...)\nnamespace Business.Dto.Home\n{\n    public class HomeSectionDto : IDto\n    {\n        public string LinkText { get; set; }\n        public string Title { get; set; }\n        public string Text { get; set; }\n    }\n}\n\n// Home section repository sample\n(...)\nnamespace Business.Repository.Home\n{\n    public class HomeSectionRepository : BaseRepository, IHomeSectionRepository\n    {\n        // Calls the constructor of the base class\n        public HomeSectionRepository(IDocumentQueryService documentQueryService) : base(documentQueryService)\n        {\n        }\n        \n        // Maps Kentico data to home section DTO object\n        public HomeSectionDto GetHomeSection()\n        {\n            return DocumentQueryService.GetDocuments<HomeSection>()\n                .AddColumns(\"Title\", \"Text\", \"Button\")  // Adds only specified columns to the columns selected in DocumentQueryService\n                .TopN(1)  // Selects exactly one record\n                .ToList()\n                .Select(m => new HomeSectionDto()  // Maps the selected values to the DTO's properties\n                {\n                    Title = m.Title,\n                    Text = m.Text,\n                    LinkText = m.Button\n                })\n                .FirstOrDefault();  // Converts the sequence to a single object\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Follow the MVC development conventions and create a <em>view model object</em>.</p>\n<ol>\n  <li>In the <em>Medio Clinic</em> project &gt; <em>Models</em> folder, create a new <em>Home</em> subfolder.</li>\n  <li>Add a new <em>HomeViewModel</em> class which&nbsp;\n    <ol>\n      <li>Implements the empty <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/IViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IViewModel</em></a> base interface,</li>\n      <li>Has a property of type <em>HomeSectionDto</em>.</li>\n    </ol>\n  </li>\n</ol>\n<p>Using this approach, you separate Kentico API from your application's code. It gives you a lot of benefits, such as easier upgradability.</p>","code":{"src":"(...)\nusing Business.Dto.Home;\n\nnamespace MedioClinic.Models.Home\n{\n    public class HomeViewModel : IViewModel\n    {\n        public HomeSectionDto HomeSection { get; set; }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Let's create the logic which prepares data for the <em>Clinic services</em> section in the Medio Clinic's home page. Follow the same approach you took with the <em>home section</em>,</p>\n<ul>\n  <li>Map the data from the <em>CMS.DocumentEngine.Types.MedioClinic.CompanyService</em> type into <em>CompanyServiceDto.</em></li>\n  <li>Pass them into the <em>home view</em> <em>model</em>.</li>\n</ul>\n<p>The following steps give you an idea of how the logic is implemented.</p>\n<ol>\n  <li>In the <em>Business</em> project &gt; <em>Dto</em> &gt; <em>Company</em> folder, create a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Company/CompanyServiceDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CompanyServiceDto</em></a><em> </em>class. Define DTO's properties for the <em>header</em>, the <em>path to the icon</em>, and <em>text</em>. Make the DTO implement the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/IDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IDto</em> </a>interface.</li>\n  <li>In the <em>Business</em> project &gt; <em>Repository</em> &gt; <em>Company</em> folder, add a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Company/ICompanyServiceRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ICompanyServiceRepository</em></a> interface. The interface defines a <em>GetCompanyServices </em>method which returns a <em>collection</em> of <em>company service</em> objects.</li>\n  <li>In the same <em>Repository</em> folder, create a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Company/CompanyServiceRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CompanyServiceRepository</em></a> class. The repository inherits from the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/BaseRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BaseRepository</em></a> and implements the <em>ICompanyService</em> interface.</li>\n  <li>The code of the <em>company service</em> repository is similar to the <em>home section</em> repository you have already built.\n    <ol>\n      <li>The repository's constructor first call to the the <em>base repository.&nbsp;</em></li>\n      <li>The <em>GetCompanyServices </em>method calls into the DocumentQueryService.GetDocuments method. Then it maps the obtained values to a collection of DTO objects.\n        <ol>\n          <li>The method <em>lists</em> the objects (\"<em>nodes</em>\") according to their <em>order</em> in the content tree.</li>\n          <li>The method assigns the <em>Header</em>, <em>Text </em>and <em>Fields</em>.<em>Icon </em>properties to the newly created DTO's.</li>\n        </ol>\n      </li>\n      <li>See comments in the code for details.</li>\n    </ol>\n  </li>\n</ol>\n<p>In the end of this part, your website should contain the following classes:</p>\n<ul>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Home/HomeSectionRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>HomeSectionRepository</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Home/IHomeSectionRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IHomeSectionRepository</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Home/HomeSectionDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>HomeSectionDto</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Company/CompanyServiceRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CompanyServiceRepository</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Company/ICompanyServiceRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ICompanyServiceRepository</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Company/CompanyServiceDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CompanyServiceDto</em></a></li>\n  <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/Home/HomeViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>HomeViewModel</em></a></li>\n</ul>","code":{"src":"// The company service interface\n(...)\nnamespace Business.Repository.Company\n{\n    public interface ICompanyServiceRepository\n    {\n         IEnumerable<CompanyServiceDto> GetCompanyServices();\n    }\n\n// The example of the implemented GetCompanyServices() method\n(...)\nusing Kentico.Content.Web.Mvc;\n\n(...)\npublic IEnumerable<CompanyServiceDto> GetCompanyServices()\n        {\n            return DocumentQueryService.GetDocuments<CMS.DocumentEngine.Types.Training.CompanyService>()\n                .AddColumns(\"Header\", \"Text\", \"Icon\", \"DocumentID\")  // Adds only specified page type's columns\n                .OrderByAscending(\"NodeOrder\") // Orders the objects according to their position in the content tree\n                .ToList()\n                .Select(m => new CompanyServiceDto()\n                {\n                    Header = m.Header,\n                    Text = m.Text,\n                    Icon = m.Fields.Icon\n                });\n        }","lang":"csharp"},"strapline":""},{"title":"","body":"<p>You have prepared classes that can create your <em>model</em> from Kentico data, so you should now pass the data to the <em>Home</em> view. According to the MVC conventions, this is exactly what a controller is supposed to do. The responsibility of your future <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/HomeController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>HomeController</em></a> will be to call repository methods, get the model, create a view model, pick the right view, and pass the view model to it.&nbsp;</p>\n<ol>\n  <li>Add a new <em>HomeController</em> class to the <em>Controllers</em> folder in the MedioClinic project.</li>\n  <li>Make your <em>HomeController</em> inherit from <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/BaseController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BaseController</em></a>.</li>\n  <li>Let the IoC container inject suitable dependencies. Get the data for the <em>home page</em> (the <em>Home section</em> page in the content tree) and Medio Clinic's services (stored in pages of the <em>Company service</em> page type).</li>\n  <li>Implement the <em>Index</em> action result method and return a view.\n    <ol>\n      <li>Define a <em>homeSection</em> variable with the data from the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Home/HomeSectionRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>HomeSectionRepository</em></a><em> </em>by calling <em>HomeSectionRepository.GetHomeSection().</em></li>\n      <li>Add an <em>if-else logic</em> to prevent errors in case the <em>home section</em> contains no data. When there is no data, return <em>HttpNotFound()</em>.</li>\n      <li>Create a <em>model</em> by calling the <em>GetPageViewModel </em>method and submit two arguments to it:&nbsp;\n        <ol>\n          <li>A new <em>HomeViewModel </em>object,&nbsp;</li>\n          <li>The page <em>title</em> as the second parameter.</li>\n        </ol>\n      </li>\n    </ol>\n  </li>\n  <li>The <em>Index</em> action returns the so called conventional view with the model parameter. (A conventional view's identifier is not explicitly specified in the <em>View()</em> call. Instead, it is being searched for by the MVC runtime according to its conventions.)</li>\n</ol>","code":{"src":"(...)\nnamespace MedioClinic.Controllers\n{\n    public class HomeController : BaseController\n    {\n        private ICompanyServiceRepository CompanyServiceRepository { get; }\n        private IHomeSectionRepository HomeSectionRepository { get; }\n\n        public HomeController(\n            IBusinessDependencies dependencies,\n            ICompanyServiceRepository companyServiceRepository,\n            IHomeSectionRepository homeSectionRepository) : base(dependencies)\n        {\n            CompanyServiceRepository = companyServiceRepository;\n            HomeSectionRepository = homeSectionRepository;\n        }\n\n        public ActionResult Index()\n        {\n            var homeSection = HomeSectionRepository.GetHomeSection();\n             \n            if (homeSection == null)\n            {\n                return HttpNotFound();\n            }\n\n            var model = GetPageViewModel(new HomeViewModel()\n           {\n                CompanyServices = CompanyServiceRepository.GetCompanyServices(),\n                HomeSection = homeSection\n           }, homeSection.Title);\n\n            return View(model);\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>To build the Medio Clinic's Home <em>Index</em> view:</p>\n<ol>\n  <li>Create a strongly-typed view against the <em>PageViewModel&lt;HomeViewModel&gt;</em>. To create the page's design, you can use the HTML markup from the <em>index.html</em> file in the asset files - the <em>Clinic header </em>and <em>Clinic services</em> sections<em>.</em></li>\n  <li>Replace the static content with <em>Razor</em> inline expressions and render the appropriate properties, e.g., <em>Title</em>, <em>Text</em>, <em>LinkText.</em></li>\n</ol>\n<p>Note that the <em>Clinic services </em>section in the Medio Clinic's <em>Home</em> page displays images which editors attached to the pages in the content tree. (The section is covered by the second half of the Razor code.) To get the URLs of company service's icons, you first need to get <em>service.Icon</em> and apply the <em>GetPath</em> extension method to it. As a result, you will get a server-relative path of the icon that has to be converted to an absolute URL.</p>\n<p>You can convert the absolute URL by calling @Html.Kentico().ImageUrl(). However, to minimize calls of Kentico-specific code in the website's presentation layer, in the next step, you will implement the <em>KenticoImageUrl</em> HTML helper method. It will wrap the <em>Kentico.Content.Web.Mvc.UrlHelperFileExtensions.ImageUrl </em>method exposed in Kentico API. In subsequent steps, you will also create a feature which will allow you to set size constraints of the returned images.</p>\n<p><em>(Continues in the next steps)</em></p>","code":{"src":"<!-- Example of the Medio Clinic's Home page view -->\n@using MedioClinic.Models.Home\n@model MedioClinic.Models.PageViewModel<HomeViewModel>\n<!-- Clinic header -->\n@if (Model.Data.HomeSection != null)\n{\n    <div class=\"section kn-section-top\">\n        <div class=\"kn-header-gradient\">\n            <div class=\"container kn-header\">\n                <h1 class=\"col l10 m4 s12\">@Model.Data.HomeSection.Title</h1>\n                <div class=\"row left\">\n                    <h5 class=\"col l10 m8 s12 kn-light\">\n                        @Model.Data.HomeSection.Text\n                    </h5>\n                </div>\n                <div class=\"row\">\n                    <div class=\"left\">\n                        <a href=\"@Url.Action(\"index\", \"Doctors\")\" class=\"kn-btn-doctors btn waves-effect waves-light red darken-3\">@Model.Data.HomeSection.LinkText</a>\n                        <br>\n                        <br>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n}\n(...)","lang":"html"},"strapline":""},{"title":"","body":"<p>To minimize the direct usage of Kentico API in the MVC application's, create a new custom HTML helper method which coverts server-side relative paths of image to absolute URLs. As the wrapped <em>ImagePath</em> method supports specifying image dimension constraints, you will also add that support to your extension method. The dimension constraint support involves creating one other class that youll implement in the next step. For now, just implement the HTML helper.</p>\n<ol>\n  <li>In the <em>MedioClinic </em>project, create a new folder <em>Extensions</em> and add a new <em>UrlExtensions</em> class.</li>\n  <li>Create a new <em>KenticoImageUrl</em> extension method (the HTML helper) which accepts the following parameters:\n    <ol>\n      <li>The <em>UrlHelper</em> instance to operate on,</li>\n      <li>The image's path mapped taken from the <em>GetPath</em> Kentico API method,</li>\n      <li>The size parameter represented by an <em>IImageSizeConstraint</em> interface that you'll implement in the next step.</li>\n    </ol>\n  </li>\n</ol>","code":{"src":"using Kentico.Content.Web.Mvc;\nusing Kentico.Web.Mvc;\nusing System.Web.Mvc;\nusing MedioClinic.Models;\n\nnamespace MedioClinic.Extensions\n{\n    public static class UrlExtensions\n    {\n        /// <summary>\n        /// Custom extension method for retrieving image urls based on their path\n        /// </summary>\n        /// <param name=\"helper\">Html helper</param>\n        /// <param name=\"path\">Path to file</param>\n        /// <param name=\"size\">Size constraints</param>\n        /// <returns></returns>\n        public static string KenticoImageUrl(this UrlHelper helper, string path, IImageSizeConstraint size = null)\n        {\n            return helper.Kentico().ImageUrl(path, size?.GetSizeConstraint() ?? SizeConstraint.Empty);\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>As it was mentioned before, the <em>ImageUrl</em> method exposed in Kentico API allows you to <a href=\"https://docs.kentico.com/k12/developing-websites/retrieving-content-in-mvc-applications/displaying-page-attachments#Displayingpageattachments-Constrainingthereturnedattachmentsizeforimages\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">resize images</a><em> </em>which are attached to pages. To add that feature to your KenticoImageUrl method, you need to have a few methods that return the <em>Kentico.Content.Web.Mvc.SizeConstraint</em> struct.</p>\n<p>The struct has the <em>Height</em>, <em>Width</em> and <em>MaxWidthOrHeight</em> methods that:</p>\n<ul>\n  <li>Need to be called depending on the needs of your client code.</li>\n  <li>At the same time, the calls need to be initiated from within your KenticoImageUrl method.</li>\n</ul>\n<p>Therefore you want to create corresponding three classes with the names of the methods above (<em>Height</em>, <em>Width</em> and <em>MaxWidthOrHeight</em>). And you want all of them to implement your new <em>IImageSizeConstraint</em> interface. This way they can be called from within <em>KenticoImageUrl()</em> consistently.</p>\n<p>To accomplish this, do the following:</p>\n<ol>\n  <li>In the <em>MedioClinic </em>project &gt; <em>Models</em> folder, add a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/KenticoSizeConstraints.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>KenticoSizeConstraints</em></a> class file. This file will contain both the interface and all the three classes mentioned before.</li>\n  <li>Define the <em>IImageSizeConstraint</em> interface with its <em>GetSizeConstraint</em> method<em>. </em>The method is supposed to return the<em> SizeContraint </em>struct.</li>\n  <li>Add the three classes. Theyll call <em>SizeConstraint.Width</em>, <em>SizeConstraint.Height</em> and <em>SizeConstraint.MaxWidthOrHeight</em> methods via the unified <em>IImageSizeConstraint.GetSizeConstraint</em> method. In all three classes, create properties representing the underlying dimension. Always add private backing fields accordingly.</li>\n</ol>\n<p>With this code in place, you can always do calls like @Url.KenticoImageUrl(service.Icon.GetPath()) from your views. If omitted, the second parameter of the KenticoImageUrl method will default to SizeConstraint.Empty. Otherwise, any dimensional constraint can be specified through this parameter.</p>\n<p>To access the extension methods in your&nbsp;<em>MedioClinic.Extensions</em>&nbsp;namespaces easily in your views, edit your <em>MedioClinic</em> project's&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/web.config\"><em>Views\\web.config</em></a><em>,&nbsp;</em>and add the&nbsp;<em>MedioClinic.Extensions</em>&nbsp;namespace. (This way, you won't need to add&nbsp;<em>using</em>&nbsp;statements directly to any of the individual views in the future.)</p>\n<p>Find out more about the <em>ImageUrl</em> method's <em>SizeConstraint</em> parameters in <a href=\"https://docs.kentico.com/k12/developing-websites/retrieving-content-in-mvc-applications/displaying-page-attachments#Displayingpageattachments-Constrainingthereturnedattachmentsizeforimages\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico documentation</a>.</p>","code":{"src":"using Kentico.Content.Web.Mvc;\n\nnamespace MedioClinic.Models\n{\n    /// <summary>\n    /// Interface for size constrains so that we can avoid using Kentico code directly in views\n    /// </summary>\n    public interface IImageSizeConstraint\n    {\n        SizeConstraint GetSizeConstraint();\n    }\n    // Specifies the maximum width of the image\n    public class Width : IImageSizeConstraint\n    {\n        private readonly int _width;\n        public Width(int width)\n        {\n            _width = width;\n        }\n        public SizeConstraint GetSizeConstraint()\n        {\n            return SizeConstraint.Width(_width);\n        }\n    }\n    // Specifies the maximum height of the image\n    public class Height : IImageSizeConstraint\n    {\n        private readonly int _height;\n        public Height(int height)\n        {\n            _height = height;\n        }\n        public SizeConstraint GetSizeConstraint()\n        {\n            return SizeConstraint.Height(_height);\n        }\n    }\n    // Specifies the maximum width and height of the image\n    public class MaxWidthOrHeight : IImageSizeConstraint\n    {\n        private readonly int _maxWidthOrHeight;\n        public MaxWidthOrHeight(int maxWidthOrHeight)\n        {\n            _maxWidthOrHeight = maxWidthOrHeight;\n        }\n        public SizeConstraint GetSizeConstraint()\n        {\n            return SizeConstraint.MaxWidthOrHeight(_maxWidthOrHeight);\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Let's finish the <em>Home's</em> Index view.</p>\n<ol>\n  <li>To display each page containing information about services, create a <em>foreach</em> loop and retrieve every service within the <em>CompanyServices</em> model.</li>\n  <li>Replace the static text with <em>Razor</em> code that gets the <em>Header</em>, <em>Text </em>properties.</li>\n  <li>To retrieve the <em>Icon</em> property, call the <em>GetPath</em> extension method on it. Then, wrap this expression into your <em>KenticoImageUrl</em> extension method call as an argument. Do not add any&nbsp;<em>size</em>&nbsp;parameter. The whole expression will generate the image's URL.</li>\n</ol>\n<p>In the end, your <em>Clinic services</em> section can look like the snippet on the left. You can also build your project and check what the <em>Home</em> page looks like on the live site.</p>","code":{"src":"<!-- Clinic services -->\n@if (Model.Data.CompanyServices != null)\n{\n    <div class=\"container\">\n        <div class=\"section\">\n            <div class=\"row\">\n                @foreach (var service in Model.Data.CompanyServices)\n                {<div class=\"col s12 m4\">\n                        <div class=\"icon-block\">\n                            <img class=\"kn-icons kn-center\" src=\"@Url.KenticoImageUrl(service.Icon.GetPath())\" />\n                            <h4 class=\"center\">@service.Header</h4>\n                            <p class=\"light center\">\n                                @service.Text\n                            </p>\n                        </div>\n                    </div>\n                }\n            </div>\n        </div>\n        <br>\n        <br>\n    </div>\n}","lang":"html"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrativeCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"5b5f1816-fcd1-49b6-9232-c0252a8a67bd","_parentId":"28d72213-fee5-4723-b3c7-9eb673f1f11e","_type":"component","title":"Demo: Displaying the Home page","displayTitle":"Demo: Displaying the Home page"},{"body":"<p>In the following steps, you will see a demo of the approach we took to display Medio Clinic's doctor listing and profile pages. Feel free to implement both pages in your way - or follow along and use the hints and ideas from the sample Medio Clinic implementation.</p>\n<h3>Doctors and doctor's details pages</h3>\n<p>Just a reminder, Kentico stores the doctor-related data in the content tree in separate content-only pages for individual doctors (<em>Doctor</em> page type). All the doctor pages come under the <em>DoctorSection</em> parent page (<em>DoctorSection</em> page type). We wanted to display doctor data in two pages:</p>\n<ul>\n  <li><em>Listing page</em> that shows all the doctors with some basic information, such as <em>name</em>, a snippet of doctor's <em>bio</em>, or info about <em>emergency shift</em> in the listing page, and</li>\n  <li><em>Doctor profile pages</em> with all the data about the doctor that editors added in the <em>Pages </em>application.</li>\n</ul>\n<p>To display the data, we recommend that you take a similar approach to what you did with the <em>Home </em>page - retrieve the data from the database via injected repositories and map it to DTOs for each page type (<em>DoctorSectionDto</em> and <em>DoctorDto</em>). Then use the DTOs to create <em>view models</em> and pass them to views of each page.&nbsp;Because you will be working with pages related to doctors, you don't need to create two controllers. You can use one <em>DoctorsController</em> and define two <em>action results -</em> for the listing page (<em>Index</em>), and for the doctor's profile page (<em>Details</em>)</p>\n<p>Feel free to code along and build your training website!</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>First, let's create objects to which the data will be mapped.</p>\n<ol>\n  <li>In the <em>Business</em> project &gt; <em>Dto</em> folder, create a new <em>Doctors</em> subfolder and add two <em>DTOs</em> to map the doctor-related data.</li>\n  <li>Create <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Doctors/DoctorSectionDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorSectionDto</em></a> with a <em>Header</em> property.</li>\n  <li>Create second class for the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Doctors/DoctorDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorDto</em></a> object.</li>\n  <li>Create properties to map the necessary information stored in the <em>Doctor </em>objects.</li>\n  <li>Add simple logic to create a <em>FullName </em>property from the doctor's first and last names. You will use the property, e.g., on the listing page in doctors' cards.</li>\n  <li>Define <em>HasShiftToday</em> property based on the current day. You will use the value to display either \"<em>Open</em>\", or \"<em>Closed</em>\" badge.</li>\n</ol>","code":{"src":"// Example of the doctor data object\nnamespace Business.Dto.Doctors\n{\n    public class DoctorDto\n    {\n        public int NodeId { get; set; }\n        public Guid NodeGuid { get; set; }\n        public string NodeAlias { get; set; }\n        public string FirstName { get; set; }\n        public string LastName { get; set; }\n        public string Degree { get; set; }\n        public DocumentAttachment Photo { get; set; }\n        public string Specialty { get; set; }\n        public string Bio { get; set; }\n        public int EmergencyShift { get; set; }\n        \n        // Defines doctor's full name\n        public string FullName => $\"{FirstName} {LastName}\";\n       \n        // Determines whether the doctor has emergency shift\n        public bool HasShiftToday => EmergencyShift == (int)DateTime.Now.DayOfWeek;\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Create a new <em>Doctor</em> folder in the <em>Business</em> project &gt; <em>Repository</em> folder, and add classes which retrieve the data from the shared database.&nbsp;</p>\n<ol>\n  <li>Map data for the <em>doctor section </em>the same way you<em> </em>mapped it for the <em>home section</em><em>. </em>Make the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Doctor/DoctorSectionRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorSectionRepository</em></a> inherit the <em>base repository</em> and implement the<em> </em><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Doctor/IDoctorSectionRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IDoctorRepository</em></a><em> </em>interface. It uses the custom <a href=\"https://github.com/Kentico/training-kentico-k12/tree/master/Business/Services/Query\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DocumentQueryService</em></a><em> </em>object to retrieve the value of the page's <em>Title</em> property from the database. Then it maps its value to <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Doctors/DoctorSectionDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorSectionDto</em>'s</a> <em>Header</em> property.</li>\n  <li>Create a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Doctor/IDoctorRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IDoctorRepository</em></a> interface and define two methods:\n    <ol>\n      <li><em>GetDoctors()</em> to return a sequence of <em>DoctorDto </em>objects, and</li>\n      <li><em>GetDoctor()</em> to return specific <em>doctor object</em> identified by its <em>nodeGuid</em>.</li>\n    </ol>\n  </li>\n  <li>Implement the interface in a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Doctor/DoctorSectionRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorRepository</em></a> class.</li>\n  <li>Get values from only specific columns into a private <em>_doctorColums</em> array.</li>\n  <li>To save yourself from repeating the same code in the methods you're going to implement, use a <em>private Func&lt;&gt;</em> delegate to map the doctor data to the <em>DoctorDto</em> objects.&nbsp;</li>\n  <li>&nbsp;Call the constructor of the <em>base repository</em>, so that you can use the <em>document query </em>and <em>site context services</em>.</li>\n  <li>Implement the <em>GetDoctors</em> method to return a sequence of <em>DoctorDtos</em>. Add only the columns specified in the <em>_doctorColumns</em> private array by calling <em>AddColumns()</em>.</li>\n  <li>&nbsp;Implement the <em>GetDoctor </em>method so that it retrieves the <em>Doctor</em> object identified by its <em>nodeGuid</em> property, and maps its values to a single <em>DoctorDto</em> object. Similarly to <em>GetDoctors()</em>, add only the columns specified in the <em>array</em>.</li>\n</ol>","code":{"src":"(...)\nnamespace Business.Repository.Doctor\n{\n    public class DoctorRepository : BaseRepository, IDoctorRepository\n    {\n\n        private readonly string[] _doctorColumns = \n        {\n           \"NodeAlias\", \"Bio\", \"Degree\", \"EmergencyShift\", \"FirstName\",\n            \"LastName\", \"Photo\", \"Specialty\"\n        };\n\n        private Func<CMS.DocumentEngine.Types.Training.Doctor, DoctorDto> DoctorDtoSelect => doctor => new DoctorDto()\n        {\n            NodeAlias = doctor.NodeAlias,\n            NodeId = doctor.NodeID,\n            NodeGuid = doctor.NodeGUID,\n            Bio = doctor.Bio,\n            Degree = doctor.Degree,\n            EmergencyShift = doctor.EmergencyShift,\n            FirstName = doctor.FirstName,\n            LastName = doctor.LastName,\n            Photo = doctor.Fields.Photo,\n            Specialty = doctor.Specialty\n        };\n\n        ISiteContextService SiteContextService { get; }\n\n        public DoctorRepository(IDocumentQueryService documentQueryService, ISiteContextService siteContextService) : base(documentQueryService)\n        {\n                SiteContextService = siteContextService;\n        }\n\n        public IEnumerable<DoctorDto> GetDoctors()\n        {\n            return DocumentQueryService.GetDocuments<CMS.DocumentEngine.Types.Training.Doctor>()\n                .AddColumns(_doctorColumns)\n                .ToList()\n                .Select(DoctorDtoSelect);\n        }\n\n        public DoctorDto GetDoctor(Guid nodeGuid)\n        {\n            return DocumentQueryService.GetDocument<CMS.DocumentEngine.Types.Training.Doctor>(nodeGuid)\n                .AddColumns(_doctorColumns)\n                .Select(DoctorDtoSelect)\n                .FirstOrDefault();\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Similarly to&nbsp;<em>HomeController</em>, the&nbsp;<em>DoctorsController</em> takes the relevant DTOs from injected repositories, populates a new&nbsp;<em>view model</em>&nbsp;with those DTOs and passes the view model to a view.</p>\n<p>There are two <em>action result</em> methods in that controller:&nbsp;</p>\n<ul>\n  <li><em>Index()</em> which crafts the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/Doctors/DoctorsViewModel.cs\"><em>DoctorsViewModel</em></a>&nbsp;used to populate the&nbsp;<em>Doctors</em>&nbsp;listing page.&nbsp;</li>\n  <li><em>Detail()</em> which gets the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/Doctors/DoctorDetailViewModel.cs\"><em>DoctorDetailViewModel</em></a>&nbsp;and passes it to the doctor profile pages.</li>\n</ul>\n<p><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/DoctorsController.cs\"><em>DoctorsController</em></a>&nbsp;inherits the&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/DoctorsController.cs\"><em>BaseController</em></a><em>&nbsp;</em>and uses several dependencies (namely the <em>business</em>&nbsp;<em>dependencies</em>, and both \"doctor\" repositories). (The code on GitHub already contains caching examples which will be covered later in the course.)</p>\n<p>The&nbsp;<em>DoctorsController</em>&nbsp;has two <em>action result</em> methods.</p>\n<p><strong>The&nbsp;</strong><em><strong>Index()</strong></em><strong>&nbsp;method</strong></p>\n<ol>\n  <li>Captures the <em>DoctorSectionDto</em> object to the&nbsp;<em>doctorSection</em>&nbsp;variable.</li>\n  <li>Checks if <em>doctorSection</em> is null and returns&nbsp;<em>HttpNotFound()&nbsp;</em>eventually.</li>\n  <li>Crafts a view model containing a <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/Doctors/DoctorsViewModel.cs\"><em>DoctorsViewModel</em></a>&nbsp;object, <em>doctorSection</em>, and its <em>Header</em> property.</li>\n  <li>Returns the <em>~/Views/Doctors/Index.cshtml</em> view by convention.</li>\n</ol>\n<p><strong>The&nbsp;</strong><em><strong>Detail()</strong></em><strong> method&nbsp;</strong></p>\n<ol>\n  <li>Gets a proper <em>DoctorDto</em>&nbsp;object by the <em>nodeGuid</em> value and stores it in the <em>doctor</em> variable<em>.</em></li>\n  <li>Also, checks for null&nbsp;with an eventual <em>HttpNotFound() call</em>.</li>\n  <li>Populates a view model with a <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/Doctors/DoctorDetailViewModel.cs\"><em>DoctorDetailViewModel</em></a>&nbsp;object and the <em>DoctorDto.FullName</em> property.</li>\n  <li>Returns the <em>~/Views/Doctors/Detail.cshtml</em> view, again, by convention.</li>\n</ol>\n<p>With the DoctorsController ready, let's update the RouteConfig.cs to map requests for&nbsp;<em>doctor profile pages</em>&nbsp;to the&nbsp;<em>Details</em>&nbsp;action.</p>","code":{"src":"using System.Web.Mvc;\nusing Business.DependencyInjection;\nusing Business.Repository.Doctor;\nusing MvcTrainingMedioClinic.Models.Doctors;\n\nnamespace MedioClinic.Controllers\n{\n    public class DoctorsController : BaseController\n    {\n        private IDoctorRepository DoctorRepository { get; }\n        private IDoctorSectionRepository DoctorSectionRepository { get; }\n\n        public DoctorsController(\n            IBusinessDependencies dependecies,\n            IDoctorRepository doctorRepository,\n            IDoctorSectionRepository doctorSectionRepository\n            ):base(dependecies)\n        {\n            DoctorRepository = doctorRepository;\n            DoctorSectionRepository = doctorSectionRepository;\n        }\n        \n        public ActionResult Index()\n        {\n            var doctorSection = DoctorSectionRepository.GetDoctorSection();\n             \n           if (doctorSection == null)\n            {\n                return HttpNotFound();\n            }\n\n            var model = GetPageViewModel(new DoctorsViewModel()\n            {\n                Doctors = DoctorRepository.GetDoctors(),\n                DoctorSection = doctorSection\n            }, doctorSection.Header);\n\n            return View(model);\n        }\n\n\n        public ActionResult Detail(Guid nodeGuid, string nodeAlias)\n        {\n            var doctor = DoctorRepository.GetDoctor(nodeGuid);\n\n            if (doctor == null)\n            {\n                return HttpNotFound();\n            }\n\n            var model = GetPageViewModel(new DoctorDetailViewModel()\n            {\n                Doctor = doctor\n            }, doctor.FullName);\n\n            return View(model);\n        }\n    } \n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>In the Medio Clinic, the Doctors page use the Index.cshtml view returned by the Index action in the DoctorsController. Here are some basic instructions to follow:</p>\n<ol>\n  <li>To display the <em>Doctors</em> page, use the <em>Doctors.html</em> static page in the course package.</li>\n  <li>Strongly-typed against <em>PageViewModel&lt;DoctorsViewModel&gt;</em>.</li>\n  <li>Does a <em>null</em> check. In case there is no data<em>,</em> don't render any markup.</li>\n  <li>Use the&nbsp;<em>foreach </em>loop to display doctor cards for every <em>Doctor</em> page that is stored under the <em>DoctorSection</em> parent page in the administration interface.</li>\n  <li>To generate doctors' image URL paths, call the custom <em>KenticoImageUrl</em> method, together with the <em>GetPath</em> method.</li>\n  <li>The <em>Opened/Closed</em> badges which indicate that the doctor has or has not emergence shift are resolved through <em>if-else</em>&nbsp;logic. The logic uses the value of the&nbsp;<em>HasShiftToday</em>&nbsp;property.</li>\n  <li>To render the rich text in the <em>Biography</em> field (<em>Bio</em> property on the <em>Doctor</em> page type), call <em>@Html.Raw()</em>. (To limit the doctor's biography text to two lines, the HTML markup uses&nbsp;the <em>text-overflow</em> CSS style set to <em>ellipsis</em>.)</li>\n  <li>For the <em>See more</em> link, call the conventional <em>Url.Action</em> method with the doctor's <em>NodeGuid</em> and <em>NodeAlias</em> arguments as route data.</li>\n</ol>","code":{"src":"@using MedioClinic.Models.Doctors\n@model MedioClinic.Models.PageViewModel<DoctorsViewModel>\n(...)\n<!--   Doctors Section   -->\n@if (Model.Data.Doctors != null)\n{\n    <div class=\"section\">\n        <div class=\"container\">\n            <div class=\"row\">\n                @foreach (var doctor in Model.Data.Doctors)\n                {\n                    <div class=\"col l4 m12 s12\">\n                        <div class=\"card\">\n                            <div class=\"card-image\">\n                                <img src=\"@Url.KenticoImageUrl(doctor.Photo.GetPath())\" alt=\"@doctor.FullName\">\n                            </div>\n                            <div class=\"card-title kn-margin-m kn-padding-m truncate\">\n                                <a href=\"@Url.Action(\"Detail\", \"Doctors\", new { nodeGuid = doctor.NodeGuid, nodeAlias = doctor.NodeAlias })\">@doctor.FullName, @doctor.Degree</a>\n                            </div>\n                            <div class=\"card-content kn-doctor-card-content\">\n                                <p>\n                                    @Html.Raw(doctor.Bio)\n                                </p>\n                            </div>\n                            <div class=\"kn-badges kn-margin-m kn-padding-m\">\n                                @if (doctor.HasShiftToday)\n                                {\n                                    <span class=\"kn-badge opened\">\n                                        Open\n                                    </span>\n                                }\n                                else\n                                {\n                                    <span class=\"kn-badge closed\">Now closed</span>\n                                }\n                            </div>\n                            <div class=\"card-action\">\n                                <a href=\"@Url.Action(\"Detail\", \"Doctors\", new { nodeGuid = doctor.NodeGuid, nodeAlias = doctor.NodeAlias })\">See more</a>\n                            </div>\n                        </div>\n                    </div>\n                }\n            </div>\n        </div>\n    </div>\n}","lang":"html"},"strapline":""},{"title":"","body":"<p>In the Medio Clinic's website, the doctor's page uses uses the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Doctors/Detail.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Detail</em></a> view returned by the <em>Detail()</em> action in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/DoctorsController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorsController</em></a>. Here are some basic instructions to follow:</p>\n<ol>\n  <li>To display the profile page, you can use the&nbsp;<em>Doctorprofile.html&nbsp;</em>static page in the course materials.</li>\n  <li>Strongly-type the view against the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/PageViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>PageViewModel</em></a><em>&lt;</em><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/Doctors/DoctorDetailViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorDetailViewModel</em></a><em>&gt;</em>.</li>\n  <li>Do a null check. Should <em>Model.Data.Doctor</em> be missing, don't render the markup.</li>\n  <li>Replace the hard-coded values in the markup with retrieved Kentico data. Here are some notes about the values:\n    <ol>\n      <li>To generate the doctor's image URL for the <em>source</em> tag, call the <em>GetPath</em> extension method on the <em>Model.Data.Doctor.Photo</em> property and pass the whole expression as an argument to your custom <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Extensions/UrlExtensions.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>KenticoImageUrl</em></a> method.&nbsp;</li>\n      <li>Use the doctor's <em>FullName</em> property for the <em>alt</em> tag and for the <em>heading</em> of the whole view.</li>\n      <li>Use <em>if-else</em> logic when displaying the <em>Opened </em>or <em>Closed</em> badges which indicate the doctor <em>has </em>or<em> has not</em> an emergency shift. Use the value of the <em>HasShiftToday </em>property of <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Doctors/DoctorDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorDto</em></a>.</li>\n      <li>Display the rich text added by the editors in the <em>Biography</em> field by calling <em>@Html.Raw()</em>.&nbsp;</li>\n    </ol>\n  </li>\n</ol>\n<p>Feel free to inspect the code on the left for any other additional information. In the last step, you need to update the <em>RouteConfi</em>g file to map the incoming URLs correctly.</p>","code":{"src":"@using MedioClinic.Models.Doctors\n\n@model MedioClinic.Models.PageViewModel<DoctorDetailViewModel>\n\n@if (Model.Data.Doctor != null)\n{\n    <div class=\"section\">\n        <div class=\"container\">\n            <div class=\"row\">\n                <div class=\"kn-doctor-profile\">\n                    <div class=\"col l4 m6 s12\">\n                        <img src=\"@Url.KenticoImageUrl(Model.Data.Doctor.Photo.GetPath())\" alt=\"@doctor.FullName\"/>\n                    </div>\n                    <div class=\"col l8 m6 s12\">\n                        <div class=\"kn-doctor-profile-box\">\n                            <div class=\"kn-doctor-profile-header\">\n                                <h4>@Model.Data.Doctor.FullName</h4>\n                            </div>\n                            @if (Model.Data.Doctor.HasShiftToday)\n                            {\n                                <span class=\"kn-badge opened\">Open</span>\n                            }\n                            else\n                            {\n                                <span class=\"kn-badge closed\">now closed</span>\n                            }\n                            <br>\n                            <div class=\"kn-doctor-profile-degree\">\n                                    <strong>Academic Degree:&nbsp;</strong>@Model.Data.Doctor.Degree\n                                    <br>\n                                    <strong>Doctor Specialty:&nbsp;</strong>@Model.Data.Doctor.Specialty\n                            </div>\n                            <div class=\"kn-doctor-profile-bio\">\n                                <h5>Biograpy</h5>\n                                <p>\n                                   @Html.Raw(Model.Data.Doctor.Bio)\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n}","lang":"html"},"strapline":""},{"title":"","body":"<p>Update the Medio Clinic's <em>route config</em> to map the requests for <em>doctor profile pages</em> to the <em>Details</em> controller action.</p>\n<ol>\n  <li>Edit the<em> </em><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/RouteConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>RouteConfig</em></a><em>, </em>and create a new <em>DoctorWithAlias </em>route.&nbsp;</li>\n  <li>Define the URL pattern using the following definition: <em>\"{culture}/Doctors/Detail/{nodeGuid}/{nodeAlias}\"</em></li>\n  <li>Set the URL's default values (the <em>Detail</em> action of <em>DoctorsController</em>, a default culture, an <em>empty</em> <em>nodeGUID</em> <em>string</em> data type, and a <em>nodeAlias</em>).</li>\n  <li>Apply the <em>SiteCultureConstraint</em> constraint to the <em>{culture}</em> parameter.</li>\n  <li>Apply the .NET <em>GuidRouteConstraint</em> to restrict the valid type of the <em>{nodeGuid}</em> parameter in the <em>DoctorWithAlias</em> route.</li>\n  <li>Apply the .NET <em>AlphaRouteConstraint</em> to restrict the valid type of the optional {<em>nodeAlias</em>} parameter in the route.</li>\n</ol>","code":{"src":"// Maps route to doctor detail\n            var route = routes.MapRoute(\n                name: \"DoctorWithAlias\",\n                url: \"{culture}/Doctors/Detail/{nodeGuid}/{nodeAlias}\",\n                defaults: new { action = \"Detail\", controller = \"Doctors\", culture = defaultCulture.Name, nodeGuid = string.Empty, nodeAlias = \"\" },\n                constraints: new { culture = new SiteCultureConstraint(AppConfig.Sitename), nodeGuid = new GuidRouteConstraint(), nodeAlias = new OptionalRouteConstraint(new AlphaRouteConstraint()) }\n            );","lang":"csharp"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrativeCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"a5311bd4-d76f-46cb-8ba8-c6538d2f4e59","_parentId":"f6754fa1-1d43-424c-951c-56ab284129b6","_type":"component","title":"Demo: Displaying Doctors and Doctor's details","displayTitle":"Demo: Displaying Doctors and Doctor's details"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Look at the code snippet showing a simple controller which is supposed to display content of an article on the live site. Decide which is the correct answer following the <strong>recommended practices</strong>.</p>\n<pre><code class=\"language-csharp\">using System;\nusing System.Web.Mvc;\nusing CMS.DocumentEngine;\n\nnamespace MVCSampleApplication\n{\n    public class ArticleController : Controller\n    {\n        public ActionResult Index()\n        {\n            // GET: Article\n            var article = DocumentHelper.GetDocuments()\n                .Types(\"MVCSampleApplication.Article\")\n                .Path(\"/Articles/\", PathTypeEnum.Children)\n                .WhereStartsWith(\"DocumentName\")\n                .OnSite(\"MVCSampleApplication\")\n                .Culture(\"en-us\")\n                .WithCoupledColumns();\n\n            return View(article);\n        }\n    }\n}</code></pre>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p>The sample code is correct and it follows Kentico recommended practices for calling Kentico API.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. The sample code will display content, however, it doesn't follow the best practices. We recommend that you abstract from Kentico API and create custom services that handles Kentico API separately from your MVC application code.</p>"},{"text":"<p>The sample code doesn't follow the recommended practices.</p>","_shouldBeSelected":true,"feedback":""},{"text":"<p>The sample code is correct and it follows Kentico best practices to call Kentico API in controllers.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. There are numerous small issues with this code snippet. One of them is that Kentico API can be called directly in the controllers. It is NOT recommended practice as it introduces potential issues with project's&nbsp;maintenance and upgradability.</p>"}],"_feedback":{"title":"","correct":"<p>Correct. Though the sample code might retrieve data, it is not correct as it wont retrieve a single article properly.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"c4c8adeb-6d46-4767-bc9e-85b79dfdc8bc","_parentId":"84185a01-7ff8-4791-8595-a278af449aee","_type":"component","title":"Progress-check: Kentico API","displayTitle":"Progress-check: Kentico API"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Select the correct code which enables editors to preview latest (unpublished) changes in the administration interface.</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"title":"","code":{"src":"query = query\n                    .OnSite(SiteContext.SiteName)","lang":"csharp"},"feedback":"<p>Wrong. The snippet doesn't specify version of the page, which is supposed to be displayed.</p>","_shouldBeSelected":false},{"title":"","code":{"src":"query = query\n                    .OnSite(SiteContext.SiteName)\n                    .LatestVersion()\n                    .Published(false)","lang":"csharp"},"feedback":"","_shouldBeSelected":true},{"title":"","code":{"src":"query = query\n                    .OnSite(SiteContext.SiteName)\n                    .Published()\n                    .PublishedVersion()","lang":"csharp"},"feedback":"<p>Wrong. The code snippet queries for the latest published version of the page, which doesn't necessarily need to be the latest, yet unpublished version of the page.</p>","_shouldBeSelected":false}],"_feedback":{"title":"","correct":"<p>Correct. The \"<em>NodeSiteID</em>\" property ensures the preview mode works in the administration interface.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"cmcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"aaba338f-d041-4fce-8735-8665889b8901","_parentId":"84185a01-7ff8-4791-8595-a278af449aee","_type":"component","title":"Progress-check: Preview","displayTitle":"Progress-check: Preview"},{"body":"<p>Congratulations on completing this part of the training. You have built your project's business logic which allows for scalability and displayed three types of pages on the live site - Medio Clinic's <em>homepage</em>, <em>Doctors</em> listing page and pages which show details about each of the doctors. Your implementation supports the preview model which allows editors to see changes before they are published on the live site.</p>\n<p>Head on to the next part of the training course where you will learn how to display localized resource strings and create workflows!</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"3bb6c3e2-9f95-4141-978e-a14f215d1f8c","_parentId":"ddd0aa64-925e-4d55-a707-943aefcc70ac","_type":"component","title":"Conclusion","displayTitle":"Conclusion"},{"body":"<p>What you will learn in this section:</p>\n<ul>\n  <li>How you can&nbsp;<strong>display localized data from the shared database</strong>&nbsp;on the live site</li>\n  <li>Which steps you need to take to&nbsp;<strong>create a new user and role</strong></li>\n  <li>How&nbsp;<strong>security model</strong>&nbsp;works in Kentico</li>\n</ul>\n<p>You will work on:</p>\n<ul>\n  <li>Localizing data on your website</li>\n  <li>Creating a new user and workflow and test your implementation provides preview functionality</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"59a068c7-d443-4fcb-9c8e-757d87abd13c","_parentId":"a50178b5-0981-4d9c-9d5d-10ac8b598696","_type":"component","title":"Introduction","displayTitle":"Introduction"},{"body":"<p>Kentico websites with content in multiple languages usually contain resource strings. Editors use the strings to localize various texts on the website which are not stored in the pages in the content tree.</p>\n<p>To retrieve the localized strings in the MVC application, you need to call the<em>&nbsp;ResHelper.</em><em>GetStrings</em><em>(\"codename of the string\")</em>&nbsp;method in the&nbsp;<em>CMS.Helpers</em>&nbsp;namespace in your views. For example, the following snippet retrieves a localized variant of the <em>Contact</em> heading in the Medio Clinic's footer.&nbsp;</p>\n<pre><code class=\"language-html\">&lt;h3&gt;@ResHelper.GetString(\"Footer.Contact\")&lt;/h3&gt;</code></pre>\n<h3>Using custom methods to localize content</h3>\n<p>The snippet above calls Kentico code in the MVC application's code which is not a recommended approach.</p>\n<p>Instead, we recommend you to wrap Kentico <em>ResHelper() </em>method into an extension method, and call this custom method on the views instead. This separates the Kentico API from your code and keeps your code highly maintainable. You can see an example of this approach in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Extensions/LocalizationExtensions.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Localize</em></a>&nbsp;extension method on the Medio Clinic website.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"fdebd4df-bc50-46ad-a1cc-1300bda4c36b","_parentId":"20219ee8-3040-458d-9b6f-9d98c4f04864","_type":"component","title":"Theory: Retrieving localized strings","displayTitle":"Theory: Retrieving localized strings"},{"body":"<p>Kentico provides a flexible security model that allows you to configure granular access permissions for pages and applications in the administration interface.</p>\n<p>The security model consists of the following components.</p>","_items":[{"body":"<p><strong>Users</strong> are shared among websites by default. However, you can disable sharing of users in the <strong>Settings</strong> application. The system grants individual users specific privilege levels that determine whether the user can access the administration interface and perform various types of actions.</p>","title":"Users","_graphic":null},{"body":"<p><strong>Roles</strong> determine which actions users are allowed to perform on the website and within the Kentico administration interface. Roles are defined for individual websites or globally for all sites in the system.</p>","title":"Roles","_graphic":null},{"body":"<p><strong>Memberships</strong>&nbsp;are a collection of roles that can be assigned to users. Memberships are mainly intended for e-commerce scenarios and typically associated with a specific product.</p>","title":"Memberships","_graphic":null},{"body":"<p>Module permissions grant access to specific features in the administration interface. Permissions are assigned to roles.</p>","title":"Module permissions","_graphic":null},{"body":"<p>Page permissions define which content, page types, and pages (<strong>ACLs</strong>) a user can access or modify.</p>","title":"Page permissions","_graphic":null},{"body":"<p><strong>UI personalization</strong> feature allows hiding UI components, such as applications, individual tabs, etc.) for specific users. A personalized UI helps to make the system easier to navigate.</p>","title":"UI personalization","_graphic":null}],"instruction":"","_layout":"full","_component":"accordion","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"03d8712f-05c5-480e-afad-05c7c7dbbed2","_parentId":"f83d1b51-2638-4b05-b364-cdc70763c5a2","_type":"component","title":"Security model overview","displayTitle":"Security model overview"},{"body":"<p><strong>Permissions </strong>provide a way to control which sections of the administration interface, applications, pages in the content tree and custom tables users can access.</p>\n<p>In Kentico, you can configure permissions at three levels.</p>\n<ul>\n  <li><strong>Module permissions</strong>&nbsp;allow access to specific Kentico features or functionalities. For example, with permissions for the Content module, users get access to the whole content of the website; the Design module allows users to develop and modify the design of the pages. Module permissions can only be granted to roles, from either the&nbsp;<strong>Permissions</strong>&nbsp;or&nbsp;<strong>Roles</strong>&nbsp;applications.</li>\n  <li><strong>Page type&nbsp;</strong>permissions grant access to all pages of a specific page type, such as <em>Articles</em> or <em>Products</em>. Page type permissions can only be assigned to roles, from either the&nbsp;<strong>Permissions</strong>&nbsp;or&nbsp;<strong>Roles</strong>&nbsp;applications.</li>\n  <li><strong>Page-level permissions (ACLs)</strong>&nbsp;allow or deny users access to particular sections or individual pages in the site content tree. You can also use ACLs to limit which pages website editors see in the content tree. If a user is granted access to the parent page of a section, the permission to access its child pages is inherited. You can break the inheritance by creating another <strong>ACL</strong>, e.g., for a specific child page. ACLs are assigned in the&nbsp;<em>Pages</em> application on the&nbsp;<strong>Properties</strong> &gt; <strong>Security&nbsp;</strong>tab.</li>\n</ul>\n<h2>How are page permissions evaluated?</h2>\n<div class=\"infobox warning\"><p>Please note that the following information covers the security rules applied in the administration interface. Enforcing security in MVC applications will be handled in another training module.</p></div>\n<p>Kentico checks permissions on each level. When assessing if a user can perform an action on a specific page, Kentico merges all the three levels together. However, the <em>Deny</em> option overrides settings for this permission on the other levels.</p>\n<figure data-asset-id=\"2d7f3fca-7811-436c-bf19-2124d7122de9\" data-image-id=\"2d7f3fca-7811-436c-bf19-2124d7122de9\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/81384d4c-9393-44c2-ac14-b0480da6b444/mvc-page-permissions-evaluation.png\" data-asset-id=\"2d7f3fca-7811-436c-bf19-2124d7122de9\" data-image-id=\"2d7f3fca-7811-436c-bf19-2124d7122de9\" alt=\"\"></figure>\n<p>You can permit access to a particular page in the content tree for individual users. However, you need to create roles and assign them the required permissions if you want your site's users to be able to work with specific features in Kentico, access all content or particular page types and custom tables.</p>\n<h2>Permissions and the user interface</h2>\n<p>Permissions&nbsp;in Kentico control what users can do in the system, such as create or modify objects. If you are creating a new user, remember to also set up the user's interface through the&nbsp;<strong>UI personalization</strong>&nbsp;application which controls what the user can see in the administration interface. A user can have permission to modify the content of the website, but still not be able to see the related parts of the administration interface.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":false},"_isOptional":false,"_classes":"","_id":"bafbc255-1aeb-4ef2-9bd9-2e91de90efc6","_parentId":"f83d1b51-2638-4b05-b364-cdc70763c5a2","_type":"component","title":"Permissions","displayTitle":"Permissions"},{"body":"<p><strong>Roles&nbsp;</strong>define what actions users can perform on the website and in the administration interface. Roles are predefined sets of permissions that can be assigned to users. A given role can be assigned to multiple users. Conversely, each user can have multiple roles.</p>\n<p>You can customize and define any number of roles and grant them permissions that fit your scenario. Kentico uses a flat-role structure. It's not possible to create a hierarchy among your roles. When a user is a member of multiple roles, the permissions from all of the roles merge together.</p>\n<p>That's why it is important to carefully plan which roles you need before you start defining them and assigning their permissions. To avoid getting into an unmanageable role system, we recommend that you resort to the <em>least permission</em> strategy. Always think of what is the minimal required set of permissions that a given role needs.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":false},"_isOptional":false,"_classes":"","_id":"bc77308e-3e3f-4b13-9df1-40c5220e528c","_parentId":"f83d1b51-2638-4b05-b364-cdc70763c5a2","_type":"component","title":"Roles","displayTitle":"Roles"},{"body":"<p>Every user has one of the following privilege levels assigned:</p>\n<ul>\n  <li><strong>Global administrator</strong>&nbsp;grants full access to all parts of the system, can use any application, and perform any operation in the system.</li>\n  <li><strong>Administrator</strong>&nbsp;grants access to any of the non-global applications and features.</li>\n  <li><strong>Editor</strong>&nbsp;allows access to the administration interface (and the <em>on-site editing mode</em> in the Portal Engine development model). It does not grant any permissions and only differentiates site editors from registered users who are limited only to the live site. Editors get permissions to applications and actions through <em>roles</em>.</li>\n  <li><strong>None</strong>&nbsp;restricts users to the live site where they can view pages and perform actions depending on their assigned roles or the site's security options.</li>\n</ul>\n<p>By default, Kentico creates an <strong>Administrator </strong>user with the <em>Global administrator</em> privilege level and a <strong>Public </strong>user which represents an anonymous visitor on the website.</p>\n<p>Additionally, users can have any number of <em>roles</em>.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":false},"_isOptional":false,"_classes":"","_id":"67b647ea-2f93-4067-afd8-91441e7e8291","_parentId":"f83d1b51-2638-4b05-b364-cdc70763c5a2","_type":"component","title":"Users","displayTitle":"Users"},{"body":"<h2>Workflows</h2>\n<p>Kentico allows you to organize and control the process of creating, updating and publishing the content-only pages by applying <strong>workflows</strong>. A workflow is <strong>a sequence of steps</strong> which details the life cycle of pages. Workflows help define <strong>review and approval processes</strong> which editors use to ensure that only a high-quality content gets published on the live site.&nbsp;</p>\n<p>In Kentico, you can <strong>specify roles</strong> that different users have, and <strong>the points</strong> within the content-only page life cycle, e.g., <em>Draft</em>, <em>Review</em>, <em>Ready for publishing</em>,<em> Published</em>, when only the specified people can work with pages. To make sure only one editor works on a page at one time, you might want to combine workflows with <a href=\"https://docs.kentico.com/k12/configuring-kentico/configuring-the-environment-for-content-editors/configuring-and-using-page-versioning/content-locking\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">content locking</a>. The workflow functionality also provides editors options to comment on approving or rejecting the changes to the page's content.</p>\n<p>An example of a simple workflow process is approving changes to a new article. A copywriter creates the article introducing a change in legal terms to website visitors and sends it for approval to an editor. The editor corrects the text and sends it to the legal department for approval. Once approved, the page moves to a content manager, who publishes the page to the live site.</p>\n<h2>The default workflow</h2>\n<p>Kentico comes with <em>a default workflow</em> which consists of three steps - <em>Edit</em>, <em>Published</em>, and <em>Archived</em>.</p>\n<p>Pages in the <em>edit</em> step are available only to the specified people in the admin UI (or via generated preview links). Pages in the <em>published </em>step are displayed on the live site. And by default, pages in the <em>archive</em>d step stay in the content tree, but they aren't displayed on the live site.&nbsp;</p>\n<h2>Types of workflows in Kentico</h2>\n<p>Kentico offers you two types of workflows - basic workflows and advanced workflows.</p>\n<p>The<strong> basic workflows</strong> consist of a flow of successive steps, where the page moves from one step to another in a direct sequence. The <strong>advanced workflows</strong> feature (available in the EMS edition of Kentico) allows you to create additional logic between the workflow steps and introduce branching by defining <em>conditions</em>, <em>waiting periods</em>, or <em>user decisions</em> before the page moves to the following steps.</p>\n<p>This course covers only working with basic workflows, however, feel free to find out more information about <a href=\"https://docs.kentico.com/k12/configuring-kentico/configuring-the-environment-for-content-editors/configuring-workflows/designing-advanced-workflows\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">designing the advanced workflows</a> in our documentation.</p>\n<h2>Applying workflows</h2>\n<p>You can apply a workflow on pages on your site using one of the two ways:</p>\n<ul>\n  <li><strong>Apply a workflow directly on a page</strong>, or a page and its children directly from the <em>Pages</em> application. Applying a workflow directly also creates a <em>workflow scope</em>.</li>\n  <li><strong>Create a workflow scope</strong> when you need to have more control when applying a workflow on the pages on your site. You can exclude pages from a workflow and control to which page types and cultures the scope applies. Each scope can also have conditions based on which it will be applied to pages. Find out more about <a href=\"https://docs.kentico.com/k12/configuring-kentico/configuring-the-environment-for-content-editors/configuring-workflows/applying-workflows-to-pages#Applyingworkflowstopages-Definingworkflowscopes\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">workflow scopes</a> in our documentation.</li>\n</ul>\n<p>You can find additional information about <a href=\"https://docs.kentico.com/k12/managing-website-content/working-with-pages/using-workflows\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">using</a> and <a href=\"https://docs.kentico.com/k12/configuring-kentico/configuring-the-environment-for-content-editors/configuring-workflows\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">configuring</a> workflows in Kentico documentation.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"d348d0ec-94db-4868-8959-55f8acaab4cf","_parentId":"1e0a2917-c750-492f-bf5b-99621aa52c71","_type":"component","title":"Working with workflows","displayTitle":"Working with workflows"},{"body":"<p>To complete this task, make sure your training website contains the following:</p>\n<ul>\n  <li>The website has a unified header and footer which display the following information:\n    <ul>\n      <li><em>Header</em>\n        <ul>\n          <li>Medio Clinic icon, the name of the company, static menu with the home page and the doctor page, a language selector indicated with, e.g., an icon, which allows users to switch between website cultures (just a placeholder, making the menu and language selector dynamic is covered later in the course).</li>\n        </ul>\n      </li>\n      <li><em>Footer</em>\n        <ul>\n          <li>The company's address, links to Medio Clinic's social media profiles, a navigation menu (just a placeholder, making the menu dynamically add pages from the admin interface is covered later in the course).</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>One <em>editor-type</em> user</li>\n  <li><em>Content Administrator </em>role which\n    <ul>\n      <li>Allows users to work with the Pages application and use the <em>Preview</em> mode.</li>\n      <li>Personalizes the admin interface to offer editors only the <em>Pages</em> application.</li>\n    </ul>\n  </li>\n  <li>A basic workflow with one custom step. The workflow:\n    <ul>\n      <li>Includes another user who can approve or reject the changes in the content.</li>\n      <li>Is applied on the home page and its child pages.</li>\n    </ul>\n  </li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":false},"_isOptional":false,"_classes":"","_id":"fb989e64-0d7e-49cd-beb7-0ddde0f053a4","_parentId":"5f45e070-e040-4559-864b-b9ad1a5100c8","_type":"component","title":"Task: Localizing data and creating a workflow","displayTitle":"Task: Localizing data and creating a workflow"},{"body":"<p>The following demo explains how the Medio Clinic code resolves the individual resource strings that you have created in the <em>Localization</em> application. Feel free to implement it using your favorite approach - or follow along and use the demo to close yet another task!</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>Before you start localizing the individual strings in the page's view, you can replace hard-coded values for <em>company address</em> or <em>links to social media</em> with dynamic values. You can approach it the same way as you did with Home and Doctor pages - display the basic information about the clinic using the repository pattern.</p>\n<p>As a reminder, the links to social media are retrieved via <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Social/SocialLinkRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>SociaLinkRepository</em></a> and mapped to <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Social/SocialLinkDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>SocialLinkDto</em></a>. The values are then inserted as an <em>IEnumerable&lt;SocialLinkDto&gt;</em> collection in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/PageViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BaseController</em></a> to the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/PageViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>PageViewModel</em></a><em> </em>and passed to the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Shared/_Layout.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>_Layout</em></a> view.</p>\n<p>You can find more information about the objects in the following classes:</p>\n<ul>\n  <li><em>Metadata</em>, such as the <em>page title</em>\n    <ul>\n      <li><a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Page/PageMetadataDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>PageMetadataDto</em></a> is mapped in a private <em>GetPageMetadata</em> method in the <em>BaseController</em></li>\n    </ul>\n  </li>\n  <li><em>Company</em>\n    <ul>\n      <li>Uses the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Company/CompanyDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CompanyDto</em></a> object in a private <em>GetCompany</em> method in the <em>BaseController</em></li>\n    </ul>\n  </li>\n  <li><em>Social links</em>\n    <ul>\n      <li>Uses a collection of <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Social/SocialLinkDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>SocialLinkDto</em></a> objects returned by a private&nbsp;<em>GetSocialLinks()</em>&nbsp;method in the&nbsp;<em>BaseController.&nbsp;</em></li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Company address column</strong></p>\n<ol>\n  <li>Use <em>@if (Model.Company != null)</em> to display the markup only if there is any data.</li>\n  <li>Replace the values for company <em>address</em> hard-coded to the HTML markup of the<em> _Layout</em> view with data from Kentico.</li>\n</ol>\n<p>&nbsp;See the snippet of the Medio clinic footer's <em>Contact</em> section.</p>\n<p><strong>Follow us column</strong></p>\n<ol>\n  <li>Use <em>@foreach (var socialLink in Model.SocialLinks)</em> to iterate through the collection of links and display them on the live site.</li>\n  <li>Use the object's <em>Url</em> property as the source of the <em>href</em> tag, and the <em>Title</em> property for the <em>title </em>and <em>alt</em> tags.</li>\n  <li>Get the socialLink.Icon property and apply the GetPath extension method to it. Then, pass this expression as an argument to the <em>KenticoImageUrl</em> method. This will generate the URL.</li>\n</ol>\n<p>See the snippet of the Medio clinic footer's <em>Follow us </em>section.</p>\n<p>Feel free to follow the same pattern on your training website and build the functionality. To see the bigger picture, you can use the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Shared/_Layout.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>&nbsp;_Layout</em></a><em> </em>on GitHub.</p>","code":{"src":"(...)\n<!-- Updated markup for Medio Clinic's Address column in the footer -->\n<footer class=\"page-footer blue-grey darken-4\">\n        <div class=\"container\">\n            <div class=\"row\">\n                <div class=\"col l4 s12\">\n                    @if (Model.Company != null)\n                    {\n                    <h5 class=\"white-text\">Contact</h5>\n                        <div class=\"grey-text text-lighten-4\">\n                            <p class=\"kn-smaller kn-address\">\n                                <address>\n                                    <strong>@Model.Company.Name</strong>\n                                    <br> @Model.Company.PhoneNumber\n                                    <br> @Model.Company.Email\n                                    <br> @Model.Company.ShortAddress\n                                </address>\n                            </p>\n                        </div>\n                    }\n(...)\n<!-- Updated markup for the Medio Clinic's Follow us column in the footer -->\n<div class=\"col l4 s12\">\n                    <h5 class=\"white-text\">FollowUs</h5>\n                    <div class=\"kn-social\">\n                        @foreach (var socialLink in Model.SocialLinks)\n                        {\n                            <a href=\"@socialLink.Url\" title=\"@socialLink.Title\">\n                                <img alt=\"@socialLink.Title\" src=\"@Url.KenticoImageUrl(socialLink.Icon.GetPath())\">\n                            </a>\n                        }\n                    </div>\n                </div>","lang":"html"},"strapline":""},{"title":"","body":"<p>The <em>MedioClinic</em> project uses a custom <em>Localize</em> HTML helper method to display<em> localized strings</em> which are stored in the Kentico database as<em> key-value </em>pairs.&nbsp;</p>\n<ol>\n  <li>In the <em>MedioClinic </em>project &gt; <em>Extensions</em> folder, add a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Extensions/LocalizationExtensions.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>LocalizationExtension</em></a> class.</li>\n  <li>Add <em>using</em> statement for <em>CMS.Helpers</em> namespace.</li>\n  <li>Implement the <em>Localize</em> HTML helper method to return a <em>string</em> data type. The method accepts two parameters - the <em>HtmlHelper</em> object to operate on and the <em>key </em>of the resource string.</li>\n  <li>Call the <em>GetString</em> method in the Kentico <a href=\"http://devnet.kentico.com/docs/12_0/api/html/Methods_T_CMS_Helpers_ResHelper.htm\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">ResHelper</a> class with the <em>key</em> as the method's argument. The <em>key </em>parameter of the <em>GetString</em> method represents the resource string's full <em>key</em> in the <strong>Localization</strong> application. The method returns it's paired <em>value</em> stored in the database.</li>\n</ol>\n<p>See the code snippet on the right for additional details.</p>","code":{"src":"using System.Web.Mvc;\nusing CMS.Helpers;\n\nnamespace MedioClinic.Extensions\n{\n    public static class LocalizationExtensions\n    {\n        /// <summary>\n        /// Custom extension method that localizes text based on a given key\n        /// </summary>\n        /// <param name=\"helper\">Html helper</param>\n        /// <param name=\"key\">The full key stored in Localization app within Kentico admin interface</param>\n        /// <returns></returns>\n        public static string Localize(this HtmlHelper helper, string key)\n        {\n            return ResHelper.GetString(key);\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>You have prepared your custom method to <em>resolve localized strings</em>, so let's replace the hard-coded values in the HTML markup in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Shared/_Layout.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>_Layout</em></a> view's <em>footer</em> with the values from the database.</p>\n<ol>\n  <li>Call <em>@Html.Localize()</em> and supply the full <em>key</em> part of the <em>key-value pair</em> as the method's argument.</li>\n</ol>\n<p>Note that the argument needs to match exactly the value of the \"<em>Key</em>\" field stored in the administration interface.</p>\n<figure data-asset-id=\"991fcd2d-23b1-497b-b3ae-cdd483022ecc\" data-image-id=\"991fcd2d-23b1-497b-b3ae-cdd483022ecc\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/9531f238-1a64-4800-af46-043648b84102/mvc-localizing-resource-strings.png\" data-asset-id=\"991fcd2d-23b1-497b-b3ae-cdd483022ecc\" data-image-id=\"991fcd2d-23b1-497b-b3ae-cdd483022ecc\" alt=\"\"></figure>\n<p>Check the sample solution for what the &nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Shared/_Layout.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>_Layout</em></a> file can look like when you have finished updating the markup.</p>","code":{"src":"<h5 class=\"white-text\">@Html.Localize(\"Footer.Contact\")</h5>","lang":"html"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrativeCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"62131595-5fa3-4acc-af11-c657b6502735","_parentId":"7a0176ce-6365-45d7-a237-685032d82178","_type":"component","title":"Demo: Displaying localized strings","displayTitle":"Demo: Displaying localized strings"},{"body":"<p>The following demo shows how you can create a new basic workflow with custom step which requires approval from content manager, new role which will be assigned to content editors and one new user to test the workflow functionality.</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>Navigate to the <strong>Workflows</strong> application and create a new <em>Content management workflow </em>workflow<em>.</em></p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/681d118c-aa6d-48ec-9c4f-c118412ba9f0/mvc-create-new-workflow.gif","alt":"mvc-create-new-workflow.gif"},"strapline":""},{"title":"","body":"<p>Switch to the <strong>Step</strong> tab and create a new <em>Manager approval</em> workflow step.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/2bf16ab7-a81f-4a91-b2a6-20dfe4bb1bc5/mvc-add-new-workflow-step.gif","alt":"mvc-add-new-workflow-step.gif"},"strapline":""},{"title":"","body":"<p>Navigate to the <strong>Users</strong> application and create a new user Andy with the following values:</p>\n<ul>\n  <li>Username: <em>Andy</em></li>\n  <li>Privilege level: <em>Editor</em></li>\n</ul>\n<p>Leave the remaining fields with their default values and click <strong>Save</strong>.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/fc79651d-b611-487c-a4e4-f77a8f83f3a4/mvc-adding-new-user.gif","alt":"mvc-adding-new-user.gif"},"strapline":""},{"title":"","body":"<p>Navigate to the <strong>Roles</strong> application and create a new role with the following values:</p>\n<ul>\n  <li>Role display name: <em>Content editor</em></li>\n  <li>Role name: <em>automatic</em></li>\n  <li>Is domain role: <em>no (cleared)</em></li>\n</ul>\n<p>Switch to the users tab and add user <em>Andy</em>. You have created a new <em>role</em> for content editors and added a <em>user</em> Andy.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/a0ca0261-40de-4ace-ba81-1422574f8714/mvc-adding-new-role.gif","alt":"mvc-adding-new-role.gif"},"strapline":""},{"title":"","body":"<p>Edit the <strong>Content editor</strong> role in the <em>Roles</em><strong> </strong>application. Switch to the <strong>Permissions </strong>tab and <em>enable </em>permissions for the following values:</p>\n<p>Module <strong>Content</strong>:</p>\n<ul>\n  <li><em>Browse tree</em></li>\n  <li><em>Read</em></li>\n  <li><em>Modify</em></li>\n  <li><em>Create</em></li>\n  <li><em>Delete</em></li>\n</ul>\n<p>You have enabled users in the Content editor role to edit data in the <em>Pages </em>application both on the <strong>Page</strong> and <strong>Content</strong> tabs.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/77326843-f825-4fa6-b7a2-a4ffc1b3bc5f/mvc-adding-permissions-for-content-module.gif","alt":"mvc-adding-permissions-for-content-module.gif"},"strapline":""},{"title":"","body":"<p>Edit the <em>Content editor</em> role in the <em>Roles</em> application, switch to the <strong>UI personalization</strong> -&gt; <strong>Administration</strong> tab and click the <strong>Enable globally</strong> button. This will enable the <em>UI personalization</em> feature to work on all sites within Kentico instance.</p>\n<p>To allow user to work with the <strong>Pages</strong> application:</p>\n<p>Select <strong>Content</strong> in the <strong>Modules</strong> drop-down list and working top-down, enable the following:</p>\n<ul>\n  <li><em>CMS</em>\n    <ul>\n      <li><em>Administration</em>\n        <ul>\n          <li><em>Content Management</em>\n            <ul>\n              <li><em>Pages</em>\n                <ul>\n                  <li><em>Edit &gt; Page (MVC)</em></li>\n                  <li><em>Edit &gt; Form</em></li>\n                </ul>\n              </li>\n              <li><em>Preview &gt; View</em></li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n</ul>\n<p>Switch to the <strong>Editor</strong> tab and click the Enable globally button. To simplify the demo, click the <strong>select all</strong> button to enable <strong>WYSIWYG editor </strong>properties.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/8a9ec0c9-6d0b-46a3-a9fe-27aec30b1c60/adding-ui-personalization.gif","alt":"adding-ui-personalization.gif"},"strapline":""},{"title":"","body":"<p>You can test the workflow functionality in the <strong>Pages</strong> application. For example, you can do the following steps:</p>\n<ol>\n  <li>Apply the <strong>Manager approval</strong> workflow on the <em>Home</em> item and its children (<em>Medio Clinic services</em>) in the content tree.</li>\n  <li><strong>Impersonate</strong> Andy user and edit, for example, the &nbsp;<em>Cardio Therapy</em> item. (Note the change of the status icon in the content tree and the additional &nbsp;buttons that allow for working with the workflow.)</li>\n  <li>As user <em>Andy</em>, submit the changes for approval. (You can also open the live site or the page in the preview mode to see the changes are not displayed yet.)</li>\n  <li>Cancel impersonation in the user menu, and click the <strong>Approval</strong> button to promote Andy's changes to the live site. (Note the change of the status icon in the content tree.)</li>\n</ol>\n<p>As the next step, you can also switch to the <strong>Workflows</strong> tab and overview the changes.</p>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/39eb7a51-7e41-469c-a838-4f01c514cad1/mvc-testing-workflow-functionality.gif","alt":"mvc-testing-workflow-functionality.gif"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrative","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"29377512-f667-424c-870c-fa93b452a5fc","_parentId":"8690b8d6-a7cf-4b1f-9fd8-7b63f223251d","_type":"component","title":"Demo: Creating new workflow","displayTitle":"Demo: Creating new workflow"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Kentico security model uses <em>page type</em> permissions to grant access specific content-only page types. The page type permission can be assigned only to:</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p><em>Roles</em></p>","_shouldBeSelected":true,"feedback":""},{"text":"<p><em>Users</em></p>","_shouldBeSelected":false,"feedback":"<p>Wrong. You can assign the page type permissions only to <em>Roles</em>.</p>"},{"text":"<p>Both to <em>Users</em> and <em>Roles</em></p>","_shouldBeSelected":false,"feedback":"<p>Wrong. You can assign the page type permissions only to <em>Roles</em>.</p>"}],"_feedback":{"title":"","correct":"<p>Correct. The page type permissions can be assigned only to Roles.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"c8fcbda2-9d02-4a01-9078-f81059356c06","_parentId":"43bee1d5-3819-4ba2-a1fa-0740af582c02","_type":"component","title":"Progress-check: Page type permissions","displayTitle":"Progress-check: Page type permissions"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Select the code snippet from the view which uses Kentico <strong>recommended practice</strong> to localize individual strings edited in the <em>Localization</em> application in the admin interface.</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"title":"","code":{"src":"<h5>@ResHelper.GetString(\"MedioClinic.Footer.Contact\")</h5>","lang":"html"},"feedback":"<p>Wrong. Though the given code will work, Kentico recommends you to separate Kentico API into custom classes, and do not use Kentico-specific code in your site's markup.</p>","_shouldBeSelected":false},{"title":"","code":{"src":"<h5>@Html.CustomLocalizerService(\"Footer.Contact\")</h5>","lang":"html"},"feedback":"","_shouldBeSelected":true},{"title":"","code":{"src":"<h5>@Html.Kentico().LocalizeString(\"Footer.Contact\")</h5>","lang":"html"},"feedback":"<p>Wrong. The <em>Kentico().LocalizeString</em> extension method doesn't exist. We recommend you to create a custom service which wraps Kentico API and separates Kentico-specific code from your site's markup.</p>","_shouldBeSelected":false}],"_feedback":{"title":"","correct":"<p>Correct. Provided that the <em>CustomLocalizerService</em> extension method returns Kentico <em>ResHelper.GetString()</em> method with the item's full key as its parameter.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"cmcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"b75fa9d3-5b9d-41ef-bbf7-0a5acab908d2","_parentId":"43bee1d5-3819-4ba2-a1fa-0740af582c02","_type":"component","title":"Progress-check: Localizing resource strings","displayTitle":"Progress-check: Localizing resource strings"},{"body":"<p>Congratulations on completing this part of the training!</p>\n<p>Your live site now displays the localized strings which are not saved in the pages application. You know about Kentico security model and its components. Your website has a new role and an editor-type user. You used the security model to personalize the admin interface, so it fits the user's needs. Your site also contains a workflow with a custom step. The step requires the global admin user to approve or reject content changes - and you used the workflow to test the Kentico preview feature.</p>\n<p>Head on to the next part of the training course where you will create the Medio Clinic website's navigation menu!</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"e3daf7be-69cc-486c-a1ba-3ef6f8278b47","_parentId":"02a12da4-f069-447c-b6da-25a5e039079e","_type":"component","title":"Conclusion","displayTitle":"Conclusion"},{"body":"<p>What you will learn in this section:</p>\n<ul>\n  <li>Which options you have <strong>to create a navigation menu</strong></li>\n  <li>How you can <strong>build navigation menu that editors can work with </strong>in the admin interface</li>\n</ul>\n<p>You will work on:</p>\n<ul>\n  <li>Creating the page types to hold navigation menu items in the content tree</li>\n  <li>Coding the classes that display the navigation menu on the live site</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"f5fdf7c9-e98f-43e6-a575-5580cd6bdfc6","_parentId":"7e5c174c-fed1-4075-9924-cfb0e636b022","_type":"component","title":"Introduction","displayTitle":"Introduction"},{"body":"<p>When it comes to navigation menus on MVC sites, there is a number of approaches you can take to implement them. You should always consider the specific requirements of the project. Also, your approach should reflect how much control over the website's navigation you want to give to editors.&nbsp;</p>\n<h2>1) Hard-coded navigation</h2>\n<p>For simple MVC sites, you can hard code the navigation. The result of this approach is a static menu which gives website editors no control over the items that the menu displays or links to. Building such a static menu is fast, the initial cost is inexpensive, and you work only within the MVC application. However, any changes to the menu the client needs require developer's assistance.</p>\n<p>You can see an example of hard-coded navigation in Kentico Dancing Goat MVC sample site (that you can deploy to IIS using Kentico Installer). It generates the link using the <em>ActionLink</em> HTML helper method, supplies the link text from the <em>.resx</em> file via the <em>GetString</em> method in Kentico <em>ResHelper</em> class and calls specific controller actions of the pages in the menu.</p>\n<pre><code class=\"language-html\">&lt;!-- DANCING GOAT NAVIGATION --&gt;\n(...)\n                            &lt;li&gt;\n                                @Html.ActionLink(ResHelper.GetString(\"DancingGoatMvc.Home\"), \"Index\", \"Home\")\n                            &lt;/li&gt;\n(...)</code></pre>\n<h2>2) Navigation defined by editors</h2>\n<p>When editors of a simple website need more control over the items in the navigation menu, you can take an opposite approach and give editors full control over which items appear in the navigation menu.</p>\n<p>The items in the content tree don't need to represent the actual structure of pages on the live site, but a means to collect data. &nbsp;You can prepare a specific page type which editors can use to create navigation items. This page type would collect the menu item captions and references to pages with content. Editors can create navigation items under a specific folder in the Pages application. This approach also allows them to define order of these items within the website navigation.</p>\n<p>However, with this approach, you may want to set some rules on what the structure of the navigation menu looks like. Without setting the right restrictions, it may happen that editors compose the menu out of pages of types that are not supported by your MVC app. As a result, the system would not generate correct data for the website's menu.</p>\n<p>For example, you can use the <em>UNI selector</em> form control in your navigation page type and filter only specific pages, page types or documents under specific paths which are allowed for the menu.</p>\n<p>To see a concrete implementation, you can investigate how menu is implemented in the Kentico MVC tutorial. This very simple tutorial website makes use of the&nbsp;<em>RelativeUrl</em>&nbsp;property of the content-tree item. Your code first loads all menu item pages with their names and the&nbsp;<em>NodeGUID</em>&nbsp;references to content pages (created earlier using the&nbsp;<em>Page selector</em>&nbsp;form control). In the second step, the code retrieves the content pages by the NodeGUID values, and puts the URL for the page to the menu item view model. The following snippet overviews how the menu is implemented , for details, see the <a href=\"https://docs.kentico.com/k12tutorial/mvc-development\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico 12 Tutorial</a>.</p>\n<pre><code class=\"language-csharp\">/// &lt;sumary&gt;\n/// Creates menu items from the pages editors selected\n/// in the Kentico admin interface and passes them to a partial view\n/// &lt;/summary&gt;\npublic class MenuItemViewModel\n    {\n        // Defines the properties of the MenuItem view model\n        public string MenuItemText { get; set; }\n        public string MenuItemRelativeUrl { get; set; }\n    }\n\n// MenuController Methods\n\t// GET: Loads and displays the site's navigation menu\n\tpublic ActionResult GetMenu()\n\t{\n\t\t// Loads all menu items using the page type's generated provider\n\t\t// Uses the menu item order from the content tree in the Kentico 'Pages' application\n\t\tvar menuItems = MenuItemProvider.GetMenuItems()\n\t\t\t.Columns(\"MenuItemText\", \"MenuItemPage\")\n\t\t\t.OrderBy(\"NodeOrder\");\n\n\t\t// Loads the pages selected within the menu items\n\t\t// The data only contains values of the NodeGUID identifier column\n\t\tvar pages = DocumentHelper.GetDocuments()\n\t\t\t.WhereIn(\"NodeGUID\", menuItems.Select(item =&gt; item.MenuItemPage).ToList())\n\t\t\t.Columns(\"NodeGUID\");\n\n\t\t// Creates a collection of view models based on the menu item and page data\n\t\tvar model = menuItems.Select(item =&gt; new MenuItemViewModel()\n\t\t{\n\t\t\tMenuItemText = item.MenuItemText,\n\t\t\t// Gets the URL for the page whose GUID matches the given menu item's selected page\n\t\t\tMenuItemRelativeUrl = pages.FirstOrDefault(page =&gt; page.NodeGUID == item.MenuItemPage).RelativeURL\n\t\t});\n\n\t\treturn PartialView(\"_SiteMenu\", model);\n\t}</code></pre>\n<h2>3) Navigation defined by technically savvy editor or admin</h2>\n<p>The third option somewhat meets both approaches mentioned above in the middle.</p>\n<p>It still provides editors control over items which appear in the navigation menu within the content tree. On the other, editors who define the menu need to understand the technical background of the MVC implementation to add menu items without creating undesired behavior.<br>\nThe implementation consists of a specific page type for menu items which collects values of controllers and actions that are called on the live site. Controller and action names are passed to the MedioClinic layout file that in turn generates link URLs using standard ASP.NET MVC methods.</p>\n<h3>Medio Clinic implementation</h3>\n<p>The Medio clinic project takes this approach to website navigation. It gets the controller and action names captured in pages of the <em>MenuContainerItem</em> page type. Their values are retrieved using the <em>DocumentQuery</em> service and mapped to <em>MenuItemDto </em>objects. As the navigation retrieval logic is shared in all individual controllers, it is implemented in the BaseController which every other controller inherits.</p>\n<p>The <em>BaseController</em> class puts a collection of menu item DTOs into the ubiquitous <em>PageViewModel</em> object which is then passed to views for individual pages. You can see the detailed implementation of the navigation menu in the <em>Demo</em> section below.</p>\n<p>To sum it up, these three approaches are not supposed to describe all the available options. You should keep in mind that each of them is a trade-off, and each depends on the initial project specifications. In the end, the MVC live site is a separate application, so feel free to implement the navigation menu in any way that best suits your project's needs.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"0b55af29-d6bd-41b7-bf0e-6b25ed70143c","_parentId":"ab3dd36f-878b-4dd6-a9b0-4d810ac07bb8","_type":"component","title":"Theory: Navigation on the MVC websites","displayTitle":"Theory: Navigation on the MVC websites"},{"body":"<p>Create a navigation menu that allows website admins or technically savvy editors adding or removing the menu items in the content tree. Make sure that at the end of the exercise, your website navigation menu on the live site matches the following criteria:</p>\n<ul>\n  <li>Contains <em>Home</em> item links to the home page.</li>\n  <li>Contains <em>Our doctors</em> item which links to the <em>Doctors</em> listing page.</li>\n  <li>Displays the default culture (EN) in the navigation menu.</li>\n  <li>Visitors can use culture selector drop-down to manually switch between all of the supported culture versions of the website, e.g., EN and ES.</li>\n  <li>Different website's culture versions are added dynamically to the culture selector.</li>\n  <li>The footer secondary navigation contains <em>Home</em> and <em>Our doctors</em> items which link to the respective pages.</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"7076a0c9-0793-4797-82a5-eb0da644d958","_parentId":"745d5bfc-6c65-44a9-9a6a-1075a710d376","_type":"component","title":"Task: Adding website's navigation menu","displayTitle":"Task: Adding website's navigation menu"},{"body":"<p>In the following demo, you will see how you can prepare the Kentico <em>admin interface</em> so that it allows editors to add items to the Medio Clinic's navigation menu.</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>The Medio Clinic menu uses a similar pattern as the other content on the website - the menu items are stored as content-tree items in a dedicated container that separates them from other items in the content tree. The navigation menu uses own <em>content-only page types</em>.&nbsp;</p>\n<p>To create the pages' types, navigate to the <strong>administration interface</strong> &gt; <strong>Page types</strong> application and create the following page types.</p>\n<p><strong>Menu container</strong></p>\n<p>Add a new <strong>MenuContainer </strong><em>content-only</em> <em>page type</em> to hold the menu content in the content tree. Use MedioClinic the following parameters</p>\n<ul>\n  <li><strong>MenuName&nbsp;</strong>(TEXT data type with size 200,&nbsp;<strong>required</strong>,&nbsp;<em>Menu name&nbsp;</em>caption)</li>\n  <li>The page name source is the&nbsp;<em>MenuName </em>field. This page type is only allowed under the&nbsp;<em>root (CMS.Root)</em>&nbsp;page type, and its&nbsp;<strong>URL pattern</strong>&nbsp;is empty. Optionally, the page type is decorated with an&nbsp;<em>icon-folder </em>icon in the content tree.</li>\n</ul>\n<p><strong>Menu item</strong></p>\n<p>Create a new <strong>MenuContainerItem</strong> <em>content-only page type</em> for the menu items. Add the following fields:</p>\n<ul>\n  <li><strong>Controller&nbsp;</strong>(TEXT data type with size 200,&nbsp;<strong>required</strong>,&nbsp;<em>Controller&nbsp;</em>caption)</li>\n  <li><strong>Action&nbsp;</strong>(TEXT data type with size 200, not required,&nbsp;<em>Action</em>&nbsp;caption)</li>\n  <li><strong>Caption&nbsp;</strong>(TEXT data type with size 200,&nbsp;<strong>required</strong>,&nbsp;<em>Caption</em>&nbsp;caption)</li>\n  <li>The page name source is the&nbsp;<em>Caption&nbsp;</em>field. This page type is only allowed under the&nbsp;<em>Menu container</em>&nbsp;page type, and its&nbsp;<strong>URL pattern</strong>&nbsp;is empty. Optionally, the page type is decorated with&nbsp;an <em>icon-minus</em>&nbsp;icon in the content tree.</li>\n</ul>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/680512cc-c7be-4d1c-834d-59b3ae11f207/mvc-creating-menu-1.png","alt":"mvc-creating-menu-1.png"},"strapline":""},{"title":"","body":"<p>Switch to the <strong>Pages</strong> application and add new items for pages you want to show in the navigation menu, e.g., the <em>Home</em> and <em>Doctors</em> pages.</p>\n<ol>\n  <li>Select the <em>root</em> in the content tree and click the <strong>(+)</strong> button to add a new page.</li>\n  <li>Use the <em>Menu Container</em> <em>page type</em> and supply <em>Menu items</em> as the <em>Menu name</em>.</li>\n  <li>Switch to the <em>Menu item</em> folder in the content tree and add two new items for pages that will be displayed in the navigation menu. Use the following values:</li>\n</ol>\n<ul>\n  <li><strong>Home </strong>page\n    <ul>\n      <li>Controller: <em>Home</em></li>\n      <li>Action: <em>empty</em></li>\n      <li>Caption: <em>Home</em></li>\n    </ul>\n  </li>\n  <li>&nbsp;<strong>Doctors</strong> listing page\n    <ul>\n      <li>Controller: <em>Doctors</em></li>\n      <li>Action: <em>empty</em></li>\n      <li>Caption: <em>Our doctors</em></li>\n    </ul>\n  </li>\n</ul>","_graphic":{"src":"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/3cce3d43-737e-4a0e-a8dd-e3ff55a71544/mvc-creating-menu-2.png","alt":"mvc-creating-menu-2.png"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrative","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"8be281a3-6847-4ea1-8595-0dd896222c90","_parentId":"7b9ee0a6-fbcc-4bba-ac54-258067d98909","_type":"component","title":"DEMO: Adding the navigation menu in the Admin UI","displayTitle":"DEMO: Adding the navigation menu in the Admin UI"},{"body":"<p>The following demo shows you how to implement the navigation menu feature on the Medio Clinic's live site application.</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>Similarly to the individual pages, the MVC application retrieves the items for the navigation menu using the repository pattern. Let's first create the business logic behind.</p>\n<ol>\n  <li>In the <em>Business</em> project &gt; <em>Dto</em> folder, create a new <em>Menu</em> subfolder. Add a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Menu/MenuItemDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>MenuItemDto</em></a> class with properties for <em>caption</em>, <em>controller</em>, and <em>action</em>.</li>\n  <li>In the <em>Business</em> project &gt; <em>Repository</em> folder, add a new <em>Menu</em> subfolder.</li>\n  <li>Create <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Menu/IMenuRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IMenuRepository</em></a> interface which defines <em>GetMenuItems</em> method that creates a <em>collection</em> of menu items. The interface implements the empty <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/IRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IRepository</em></a> so that it's resolved with the IoC container.</li>\n  <li>Create a <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Menu/MenuRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>MenuItemRepository</em></a> class, make it inherit from <em>BaseRepository</em> and implement the <em>IMenuRepository</em> interface.</li>\n  <li>Inside the <em>GetMenuItems </em>method, call <em>DocumentQueryService.GetDocuments()</em>, and from the <em>MenuContainerItem </em>page type\n    <ol>\n      <li>Select only children items under specific path (\"/Menu-items\") by calling <em>Path(),</em></li>\n      <li>Add their specific columns (<em>Caption</em>, <em>Controller</em>, <em>Action</em>)</li>\n      <li>Order the retrieved sequence according to the content tree ordering</li>\n      <li>Creates a new DTO for each item, and map the values of the above columns to the <em>MenuItemDto's</em> properties.</li>\n    </ol>\n  </li>\n</ol>\n<p>See the code snippet for additional details about the menu repository.</p>\n<p>Now, do the following:</p>\n<ol>\n  <li>Switch to the <em>Business</em> project &gt; <em>DependencyInjection </em>folder.</li>\n  <li>Add your new repositories to the project's dependencies. Define them in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/DependencyInjection/IBusinessDependencies.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IBusinessDependencies</em></a> interface and implement in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/DependencyInjection/BusinessDependencies.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BusinessDependencies</em></a> class.</li>\n</ol>","code":{"src":"(...)\nnamespace Business.Repository.Menu\n{\n    public class MenuRepository : BaseRepository, IMenuRepository\n    {\n        public MenuRepository(IDocumentQueryService documentQueryService) : base(documentQueryService)\n        {\n        }\n\n        public IEnumerable<MenuItemDto> GetMenuItems()\n        {\n            return DocumentQueryService.GetDocuments<MenuContainerItem>()\n                .Path(\"/Menu-items\", PathTypeEnum.Children) // Retrieves children items under specified path\n                .AddColumns(\"Caption\", \"Controller\", \"Action\")  // Adds only the specified columns\n                .OrderByAscending(\"NodeOrder\")  // Orders the items according to their order property\n                .Select(m => new MenuItemDto()  // Maps the values to MenuItemDto\n                {\n                    Action = m.Action,\n                    Caption = m.Caption,\n                    Controller = m.Controller\n                });\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>You have mapped Kentico data to your <em>menu item</em> data objects. Now you have to update the <em>BaseController</em> so that the new navigation menu feature resolves correctly.</p>\n<p>Extend the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/BaseController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BaseController</em></a> class so that it generates also menu items by calling <em>Dependencies.MenuRepository.GetMenuItems()</em>. The method adds the mapped menu item data to the <em>page view model</em>.</p>\n<p>Because the <em>PageViewModel</em> is shared by all pages on the website, the <em>menu items</em> will be generated when individual controllers, such as <em>HomeController</em> and <em>DoctorsController, </em>return their views.</p>","code":{"src":"(...)\npublic PageViewModel GetPageViewModel(string title) \n        {\n            return new PageViewModel()\n            {\n                MenuItems = Dependencies.MenuRepository.GetMenuItems() ?? new List<MenuItemDto>(),\n                Metadata = GetPageMetadata(title),\n                Company = GetCompany(),\n                Cultures = Dependencies.CultureService.GetSiteCultures(),\n                SocialLinks = GetSocialLinks(),\n            };\n        }\n\n        public PageViewModel<TViewModel> GetPageViewModel<TViewModel>(TViewModel data, string title) where TViewModel : IViewModel\n        {\n            return new PageViewModel<TViewModel>()\n            {\n                MenuItems = Dependencies.MenuRepository.GetMenuItems() ?? new List<MenuItemDto>(),\n                Metadata = GetPageMetadata(title),\n                Company = GetCompany(),\n                Cultures = Dependencies.CultureService.GetSiteCultures(),\n                SocialLinks = GetSocialLinks(),\n                Data = data\n            };\n}\n(...)","lang":"csharp"},"strapline":""},{"title":"","body":"<p>You have updated the <em>page view</em> <em>model </em>which now contains data for the navigation menu. You need to replace the hard-coded navigation menu in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Shared/_Layout.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>_Layout</em></a>'s markup to dynamically resolve navigation menu from Kentico data.</p>\n<ol>\n  <li>Use Razor <em>@foreach</em> loop to display the menu items from the model.</li>\n  <li>Replace the hard-coded value in the <em>href</em> tag to dynamically resolve the URL by using the <em>@Url.Action(menuItem.Action, menuItem.Controller)</em>.</li>\n  <li>Use <em>@menuItem.Caption</em> for the caption of the menu item.</li>\n  <li>Update the <em>side navigation menu</em> (under the &lt;ul&gt; element with the <em>sidenav</em> class) and the <em>secondary menu</em> in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Shared/_Layout.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>_Layout's</em></a> <em>footer</em>.</li>\n  <li>Replace the hard-coded link under the Medio clinic's logo to navigate to the <em>Home</em> page by using <em>@Url.Action(\"Index\", \"Home\")</em>.</li>\n</ol>\n<p><strong>(Optional)</strong> The code snippet demos how you can use CSS to <em>highlight an active page</em> in the menu by comparing the values you retrieve from the route with the values of the active controller (the <em>menuItem.Controller </em>parameter). The menu item representing the active page will be rendered as <em>bold</em> (wrapped into the <em>kn-bold</em> CSS class) in the menu.</p>","code":{"src":"<!-- Example of dynamically resolved menu navigation menu items on the live site -->\n(...)\n    <nav class=\"white\" role=\"navigation\">\n        <div class=\"nav-wrapper container\">\n            <a id=\"logo-container\" href=\"@Url.Action(\"Index\", \"Home\")\" class=\"brand-logo\">\n                <img class=\"kn-logo\" src=\"~/Content/images/Logo/Logoic.png\" alt=\"\">\n           (...)\n            <ul class=\"right hide-on-med-and-down\">\n                @foreach (var menuItem in Model.MenuItems)\n                {\n                    if (ViewContext.RouteData.Values[\"controller\"]?.ToString().Equals(menuItem.Controller, StringComparison.OrdinalIgnoreCase) ?? false)\n                    {\n                        <li class=\"kn-bold\">\n                           <a href=\"@Url.Action(menuItem.Action, menuItem.Controller)\">@menuItem.Caption</a>\n                        </li>\n                    }\n                    else\n                    {\n                        <li>\n                            <a href=\"@Url.Action(menuItem.Action, menuItem.Controller)\">@menuItem.Caption</a>\n                        </li>\n                    }\n                }\n(...)","lang":"html"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrativeCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"9ad7df70-0a9d-4fa1-9c7a-b067f0c6e4e9","_parentId":"7b9ee0a6-fbcc-4bba-ac54-258067d98909","_type":"component","title":"Demo: Adding a navigation menu to the live site","displayTitle":"Demo: Adding a navigation menu to the live site"},{"body":"<p>The following demo shows you how we implemented the culture selector on the Medio Clinic website.</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>Visitors of the website can manually switch to their preferred culture.</p>\n<p>The functionality is implemented in the <a href=\"http://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Services/CultureService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CultureService</em></a> class. First, the <em>CultureService</em> takes the <em>SiteContextService</em> object from the IoC container. The <em>GetSiteCultures</em> method uses the <em>SiteContextService.SiteName</em> property value to retrieve cultures of the current site. Specifically, it retrieves values of the culture code, culture name and short name, and it stores them in a <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Culture/CultureDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CultureDto</em></a> object. The resulting <em>IEnumerable&lt;CultureDto&gt; sequence is then inserted by</em> <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/BaseController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BaseController</em></a> into the shared <a href=\"https://github.com/Kentico/training-kentico-k12/blob/59746cbb67ce679722314e1ba0795843f93bec82/MedioClinic/Models/PageViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>PageViewModel</em></a> object.</p>","code":{"src":"(...)\nnamespace Business.Service.Culture\n{\n    public class CultureService : BaseService, ICultureService\n    {\n        private ISiteContextService SiteContextService { get; }\n\n        public CultureService(ISiteContextService siteContextService)\n        {\n            SiteContextService = siteContextService;\n        }\n\n        public IEnumerable<CultureDto> GetSiteCultures()\n        {\n            return CultureSiteInfoProvider.GetSiteCultures(SiteContextService.SiteName).Items.Select(m =>\n                new CultureDto()\n                {\n                    CultureCode = m.CultureCode,\n                    CultureName = m.CultureName,\n                    CultureShortName = m.CultureShortName\n                }\n            );\n        }\n    }\n}\n","lang":"csharp"},"strapline":""},{"title":"","body":"<p>In the shared <em>_Layout.cshtml, </em>the active culture is then determined by the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Shared/_Layout.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CultureProperty of the application's thread</em></a>.&nbsp;</p>\n<ol>\n  <li>Use <em>@Thread.CurrentThread.CurrentCulture<br>\n.TwoLetterISOLanguageName</em> to retrieve the two-letter culture code and pass it into the menu item in front of the globe icon.</li>\n  <li>Make the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Shared/_Layout.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>culture selector drop-down list</em></a> create culture-specific URLs for each culture in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/PageViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Cultures </em></a>collection. Collect the culture from the route into a new <em>currentRouteValue</em>s variable. Generate the URL using the specified action and controller names in the current <em>ViewContext</em> and add the <em>CultureCode</em> property of each culture object into the <em>route data </em>collection (to be parsed as the <em>{culture}</em> segment of your routes afterwards).</li>\n</ol>","code":{"src":"<!--  Shows snippets of how the view engine resolves the culture -->\n(...)\nvar currentRouteValues = new RouteValueDictionary(\n       Url.RequestContext.RouteData.Values\n       )\n       { [\"culture\"] = culture.CultureCode };\n       <li>\n           <a href=\"@Url.Action(\n               ViewContext.RouteData.Values[\"action\"]?.ToString(),\n              ViewContext.RouteData.Values[\"controller\"]?.ToString(),\n              currentRouteValues)\">\n              @culture.CultureShortName\n           </a>\n       </li>\n(...)\n<a class=\"dropdown-trigger\" href=\"#\" data-target=\"langs\">\n    @Thread.CurrentThread.CurrentCulture.TwoLetterISOLanguageName\n    <i class=\"fas fa-globe-africa right\"></i>\n</a>","lang":"html"},"strapline":""},{"title":"","body":"<p>Let's sum things up. The <em>foreach</em> loop iterates through cultures in the <em>Cultures</em> object and creates the culture-specific drop-down menu items. The <em>UrlAction </em>helper method constructs the <em>Url</em> link from the <em>action</em> and <em>controller</em> arguments in the <em>route data </em>collection and supplies the values of culture code. Secondly, it inserts short name of the language next to the global icon in the navigation menu.</p>\n<p>The code snippet shows finalized markup in the navigation section in the <em>_Layout.cshtml</em>.</p>","code":{"src":"<nav class=\"white\" role=\"navigation\">\n        <div class=\"nav-wrapper container\">\n            <a id=\"logo-container\" href=\"@Url.Action(\"Index\", \"Home\")\" class=\"brand-logo\">\n                <img class=\"kn-logo\" src=\"~/Content/images/Logo/Logoic.png\" alt=\"\">\n                <span>@Model.Metadata.CompanyName</span>\n            </a>\n            <!-- Languages structure -->\n            @if (Model.Cultures != null)\n            {\n                <ul id=\"langs\" class=\"dropdown-content\">\n                    @foreach (var culture in Model.Cultures)\n                    {\n                        var currentRouteValues = new RouteValueDictionary(\n                            Url.RequestContext.RouteData.Values\n                            )\n                        { [\"culture\"] = culture.CultureCode };\n                        <li>\n                            <a href=\"@Url.Action(\n                                         ViewContext.RouteData.Values[\"action\"]?.ToString(),\n                                         ViewContext.RouteData.Values[\"controller\"]?.ToString(),\n                                            currentRouteValues)\">\n                                @culture.CultureShortName\n                            </a>\n                        </li>\n                    }\n                </ul>\n            }\n            <ul class=\"right hide-on-med-and-down\">\n                @foreach (var menuItem in Model.MenuItems)\n                {\n                    if (ViewContext.RouteData.Values[\"controller\"]?.ToString().Equals(menuItem.Controller, StringComparison.OrdinalIgnoreCase) ?? false)\n                    {\n                        <li class=\"kn-bold\">\n                            <a href=\"@Url.Action(menuItem.Action, menuItem.Controller)\">@menuItem.Caption</a>\n                        </li>\n                    }\n                    else\n                    {\n                        <li>\n                            <a href=\"@Url.Action(menuItem.Action, menuItem.Controller)\">@menuItem.Caption</a>\n                        </li>\n                    }\n                }\n\n                <li>\n                    <a class=\"dropdown-trigger\" href=\"#\" data-target=\"langs\">\n                        @Thread.CurrentThread.CurrentCulture.TwoLetterISOLanguageName\n                        <i class=\"fas fa-globe-africa right\"></i>\n                    </a>\n                </li>\n            </ul>\n            <ul id=\"nav-mobile\" class=\"sidenav\">\n                @foreach (var menuItem in Model.MenuItems)\n                {\n                    if (ViewContext.RouteData.Values[\"controller\"]?.ToString().Equals(menuItem.Controller, StringComparison.OrdinalIgnoreCase) ?? false)\n                    {\n                        <li>\n                            <a href=\"@Url.Action(menuItem.Action, menuItem.Controller)\">@menuItem.Caption</a>\n                        </li>\n                    }\n                    else\n                    {\n                        <li>\n                            <a href=\"@Url.Action(menuItem.Action, menuItem.Controller)\">@menuItem.Caption</a>\n                        </li>\n                    }\n                }\n            </ul>\n            <a href=\"#\" data-target=\"nav-mobile\" class=\"sidenav-trigger\">\n                <i class=\"material-icons\">menu</i>\n            </a>\n        </div>\n    </nav>","lang":"html"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrativeCode","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"861d20f8-26e5-4359-98f3-ca92cf54dc67","_parentId":"9a41b38d-e629-42b6-bce9-21a44642ee1c","_type":"component","title":"Demo: Updating the culture-selector","displayTitle":"Demo: Updating the culture-selector"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Which of the descriptions of the approach presented in this page is correct?</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p>The basic assumption that the approach builds upon is that business users will understand the concept of MVC controllers and actions that all URLs ultimately point to. With such an assumption, a new menu item page type was created. Editors can model the menu structure under a dedicated section in the content tree. For each menu item, they specify a caption, a controller name, and an action name. In the source code of the app, menu items are retrieved and placed into the ubiquitous <em>PageViewModel </em>and <em>PageViewModel&lt;&gt; </em>objects that the app's global layout view file renders. The layout creates <em>&lt;a /&gt; </em>elements using the <em>Url.Action </em>helper method that takes the controller name and action name from the menu items, together with the current thread's culture in an anonymous route data object.</p>","_shouldBeSelected":true,"feedback":""},{"text":"<p>The basic assumption that the approach builds upon is that business users won't understand the concept of MVC controllers and actions that all URLs ultimately point to. With such an assumption, a new menu item page type was created. Editors can model the menu structure under a dedicated section in the content tree. For each menu item, they specify a caption of the menu item, while also picking a page from the content tree using the <em>UniSelector </em>form control. In the source code of the app, menu items are retrieved and placed into the ubiquitous <em>PageViewModel </em>and <em>PageViewModel&lt;&gt; </em>objects that the app's global layout view file renders. The layout creates <em>&lt;a /&gt; </em>elements using the <em>Url.Action </em>helper method that takes the controller name and action name from the menu items, together with the current thread's culture in an anonymous route data object.</p>","_shouldBeSelected":false,"feedback":"<p>The assumption taken in this page was that business users will understand that each URL ultimately points to a certain MVC controller and an action. Therefore, for each menu item, they specify names of controllers and actions. They don't pick pages using the <em>UniSelector </em>control.</p>"}],"_feedback":{"title":"","correct":"","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"a0379fed-7933-4437-9d2b-83e121bae5df","_parentId":"ec218429-a83a-4ff8-9e98-50f792e34009","_type":"component","title":"Progress-check: Navigation menu concepts","displayTitle":"Progress-check: Navigation menu concepts"},{"body":"<p>Congratulations on completing another part of the course. You now know how you can build the website's navigation which allows admins to work with the menu items in the content tree.</p>\n<p>Hurry up to the next part of the training in which you will find out how to work with files stored in the media libraries and display them on the live site.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"fc158242-5bf7-40a7-9900-6da33777f94a","_parentId":"bb82fb9a-acd1-4bb6-bf70-cb6d8fdb4e65","_type":"component","title":"Conclusion","displayTitle":"Conclusion"},{"body":"<p>What you will learn in this section:</p>\n<ul>\n  <li>What media libraries are and you can use them to store files</li>\n  <li>How you can configure the default settings of media libraries to match your project requirements</li>\n  <li>What is the best practice to display media library files on the live site</li>\n</ul>\n<p>You will work on:</p>\n<ul>\n  <li>Implementing the Contact us page</li>\n  <li>Adding a map with office locations generated from Kentico data</li>\n  <li>Creating a new media library and uploading files</li>\n  <li>Displaying media library files on the live site</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"9fb252da-4533-4a88-8767-6b33a7f5ac39","_parentId":"7f218e1d-38ab-4ba7-9a94-88acbfa85f07","_type":"component","title":"Introduction","displayTitle":"Introduction"},{"body":"","_items":[{"body":"<p>Media libraries serve as central repositories for storing media on your website. They can store all types of files editors might want to work with, images, videos or non-image files, such as documents. Here is a basic overview of the behavior of media files:</p>\n<ul>\n  <li>The physical files are uploaded to the project's file system, or you can use any external storage provider, such as Azure Blob Storage or Amazon S3. However, if you decide to use the external storage provider, you need to implement it in your code and configure &nbsp;the admin interface.</li>\n  <li>Website editors can organize media files into a hierarchy of folders to group related files.&nbsp;</li>\n  <li>The physical files are not uploaded to the database, only a link to the file is added to the database (unlike the page attachments where you <a href=\"https://docs.kentico.com/k12/configuring-kentico/managing-files/storing-files\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">can decide on where files are stored</a>).&nbsp;</li>\n  <li>By default, both media library files and their folders are synchronized between the admin UI and the MVC application automatically as the web farm mode is enabled in the MVC development model.</li>\n</ul>","title":"Media library basics","_graphic":null},{"body":"<p>The physical files are stored in the file system and synced with the MVC application thanks to the web farm synchronization. The editors can upload files to the media libraries from the admin UI or they can access the file system directly and upload files via, e.g., FTP.&nbsp;</p>\n<h2>Storing media library files</h2>\n<p>The physical files in the file system are stored in the folder hierarchy that mirrors the folder hierarchy of the media library in the UI. To make navigation around the folder structure in the <em>Media libraries</em> application easier, developers can configure the number of folders which can be displayed under an expanded folder node in the media libraries tree view.&nbsp;</p>\n<p>Editors can store an unlimited number of files in the media library. However, we don't recommend storing more than 100 files per library folder if you want to use external storage option, such as Azure Blob Storage, as the number of files per library affects the performance of the <em>Media library </em>application's UI.&nbsp;If you plan to store the physical files only in the file system, you can store any number of files within one media library.</p>\n<h3>Configuring storage options</h3>\n<p>You can configure the locations of the folder where the system stores media files in the Settings application. If the value is empty, the system stores the files in the default location <em>~/&lt;sitecodename&gt;/media/&lt;MediaLibraryFolderName&gt;</em>.</p>\n<p>In case you run several MVC applications using one administration interface which means the files from different sites are stored in different folder structures.</p>\n<p>If you need to change the location of the media libraries file, you can specify the <em>physical path</em>,<em> root-relative path</em> or <em>UNC path</em> to store the libraries on different servers. Find out more about <a href=\"https://docs.kentico.com/k12/configuring-kentico/configuring-the-environment-for-content-editors/configuring-media-libraries#Configuringmedialibraries-Configuringcustomstorageformedialibraries\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">configuring custom storage</a> in Kentico documentation.</p>\n<h3>Using external storage</h3>\n<p>The media library files can be stored in the file system or in an external storage provider.&nbsp;</p>\n<p>You need to decide early in the project where the files will be stored, because it's not possible to migrate the files from, for example, the file system to Azure CDN. If you tried to migrate the files, all URLs become invalid and even the structure of the media library folders may be affected.</p>\n<p>If you want to store media libraries in a cloud-based file system, you need to configure your MVC application to use storage-specific providers. The configuration of the MVC application for external storage follows the same instruction as for Kentico projects.</p>\n<ul>\n  <li>For Azure Blob storage, see&nbsp;<a href=\"https://docs.kentico.com/k12/custom-development/working-with-physical-files-using-the-api/configuring-file-system-providers/configuring-azure-storage#ConfiguringAzurestorage-ConfiguringKenticotostoreonlymediafilesonAzurestorage\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Configuring Azure storage</a>.</li>\n  <li>For Azure CDN, see&nbsp;<a href=\"https://docs.kentico.com/k12/deploying-websites/running-kentico-on-microsoft-azure/configuring-azure-cdn\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Configuring Azure CDN</a>.</li>\n  <li>For Amazon S3, see&nbsp;<a href=\"https://docs.kentico.com/k12/custom-development/working-with-physical-files-using-the-api/configuring-file-system-providers/configuring-amazon-s3\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Configuring Amazon S3</a>.</li>\n</ul>\n<p>When storing files in an external provider, keep in mind that Kentico is case&nbsp;<em>insensitive</em>, while the external storage applications, such as&nbsp;<em>Azure Blob Storage</em>, are case&nbsp;<em>sensitive</em>.</p>\n<h2>Registering media files in the database</h2>\n<p>Files uploaded to the media library need to be registered in the database. Files that were uploaded in the admin UI get registered automatically. Files uploaded directly to the file system outside of the admin UI need to be registered either manually from the UI (unregistered files are marked by a yellow triangle icon), or you can customize the system, for example, by developing a custom scheduled task and register the files using Kentico API.</p>\n<p>When the file is registered in the database, it's not uploaded in the database. Each media library file gets an entry in the <em>Media_File</em> database table which collects a link to the file (<em>FileGUID column</em>), the library the file is stored in (<em>FileLibraryID</em>) and other values.</p>","title":"Storing media files","_graphic":null},{"body":"<p>Media libraries can store <strong>any types of file</strong>, such as images, sound files, videos, package files, presentations or document files. By default, there are some restrictions on what types editors can upload to media library through UI, but it's possible to configure the allowed extensions and support uploading many more different file-types in the Settings application.</p>\n<h2>Supported file types in Media libraries</h2>\n<p>Editors can preview images of different types, such as <em>bmp,&nbsp;gif,&nbsp;png,&nbsp;jpg,&nbsp;</em>or <em>jpeg, </em>directly<em> </em>in the Media library application<em>. </em>The system also detects audio and video files based on their&nbsp;<a href=\"https://en.wikipedia.org/wiki/Media_type\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">MIME type</a>&nbsp;(audio types starting with the&nbsp;<em>audio/</em>&nbsp;prefix, video types with the&nbsp;<em>video/</em>&nbsp;prefix) and renders appropriate HTML5 markup. In the end, the types of files that can be previewed or played on your site depend on the users web browser.</p>\n<p>Editors can store other file types, such as PDF or packages. The system recognizes these file types as documents which means they cannot be played or displayed as the images or video files. However, users can download them from the live site or preview provided that their browsers contain the necessary extensions.</p>\n<h3>Adding custom files types to media libraries</h3>\n<p>You can allow custom files types, such as <em>.svg</em>, by modifying the site's <em>web.config</em> file. If your browser supports previewing, e.g., <a href=\"https://caniuse.com/#search=svg\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">the .svg file type</a>, the system can recognize and process. Using the <em>web.config</em> keys, you can specify which file types are detected automatically; other image file types are recognized as <em>documents</em>.</p>\n<pre><code class=\"language-html\">&lt;!-- The system allows only the following media types (the default file types are extended with .svg file type --&gt;\n&lt;add key=\"CMSImageExtensions\" value=\"bmp;gif;ico;png;svg;wmf;jpg;jpeg;tiff;tif\" /&gt;</code></pre>\n<h2>Adjusting the maximum file upload size</h2>\n<p>The default maximum upload size for IIS 7 and higher is 30 MB. If someone tries to upload anything larger than 30 MB, the IIS returns 404 error.</p>\n<p>You can enable uploads of larger files, e.g., up to 2 GB, by changing the <em>httpRuntime</em> element's <strong>maxRequestLength</strong> attribute in the <em>&lt;system.web&gt;</em> section. You should specify the size in <em>kilobytes</em>:</p>\n<pre><code class=\"language-html\">&lt;!-- Modified key which enables uploading 2GB files   --&gt;\n&lt;httpRuntime maxRequestLength=\"2097152\" ... /&gt;</code></pre>\n<p>Secondly, you need to add the following <em>&lt;security&gt;</em> element into the main &lt;<em>web.WebServer</em>&gt; section. To enable the 2 GB uploads, you need to set the <em>requestLimits </em>element's <strong>maxAllowedContentLength </strong>property in <em>bytes</em>.</p>\n<pre><code class=\"language-html\">&lt;!-- Updates the IIS's default file upload size to 2 GB --&gt; \n&lt;system.webServer&gt;\n(...)\n  &lt;security&gt;\n    &lt;requestFiltering&gt;\n      &lt;requestLimits maxAllowedContentLength=\"2147483648\"/&gt;\n    &lt;/requestFiltering&gt;\n  &lt;/security&gt;\n(...)</code></pre>\n<p>&nbsp;(You can find out more in the <a href=\"https://docs.microsoft.com/en-us/iis/configuration/system.webserver/security/requestfiltering/requestlimits/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Microsoft documentation</a>.)</p>","title":"Working with media library files","_graphic":null},{"body":"<h2>Retrieving media files</h2>\n<p>You can retrieve media library files in MVC application using Kentico API methods from the CMS.MediaLibrary namespace.</p>\n<pre><code class=\"language-csharp\">(...)\n    // Gets an instance of the 'MedicalCenters' media library for the current site\n    MediaLibraryInfo mediaLibrary = MediaLibraryInfoProvider.GetMediaLibraryInfo(\"MedicalCenters\", SiteContext.CurrentSiteName);\n\n    // Gets a collection of media files with the .jpg extension from the media library\n    IEnumerable&lt;MediaFileInfo&gt; mediaLibraryFiles = MediaFileInfoProvider.GetMediaFiles()\n        .WhereEquals(\"FileLibraryID\", mediaLibrary.LibraryID)\n        .WhereEquals(\"FileExtension\", \".jpg\");\n\n    // Prepares a collection of view models containing required data of the media files\n    IEnumerable&lt;MediaFileViewModel&gt; model = mediaLibraryFiles.Select(\n            mediaFile =&gt; new MediaFileViewModel\n            {\n                FileTitle = mediaFile.FileTitle,\n                DirectUrl = MediaLibraryHelper.GetDirectUrl(mediaFile),\n                PermanentUrl = MediaLibraryHelper.GetPermanentUrl(mediaFile)\n            }\n    );</code></pre>\n<h2>Getting URLs of the media files</h2>\n<p>The code above retrieves two properties you can use to generate media file URLs - <em>GetDirectUrl</em> or <em>GetPermanentUrl</em> methods from the <em>MediaLibraryHelper</em> class.</p>\n<h3>GetDirectUrl</h3>\n<p><em>GetDirectUrl</em> method returns a <em>server-relative URL</em> to the media file in the server's file system, e.g., <em>~/MedioClinic/Media/emergencyservices.jpg. </em>URL generated using this method provides the best performance. However, there is not much you can do with the returned file other than display it.</p>\n<h3>GetPermanentUrl</h3>\n<p><em>GetPermanentUrl</em> method returns file's <em>permanent URL</em>, for example, <em>~/getmedia/0140bccc-9d47-41ea-94a9-ca5d35b2964c/emergency_services.jpg. </em>If you store the media files in external storage, always generate the permanent URL of the media file.</p>\n<p>The <strong>permanent URL</strong> offers you some additional features which you can use when working with the file. You can use the permanent URL to <em>set access permissions</em> for viewing or updating the file. The permanent URLs allows you to <em>resize the images</em> in views (based on constraints) using the <em>ImageUrl</em> extension method or <em>add URL extensions</em>. On the other hand, adding more logic to retrieving the files means that performance-wise, the <em>permanent URL</em> is slower than the <em>direct URL</em>.</p>\n<h2>Displaying media files</h2>\n<p>Both methods mentioned above return files' <em>relative URLs </em>which means you need to process their values through <em><strong>ImageUrl</strong></em> or <em><strong>FileUrl</strong></em> extension methods in views to get the final URL of the media file you want to display. Both methods are available in the <em>Kentico.Content.Web.Mvc</em> namespase and expose the following behavior.</p>\n<div class=\"infobox note\"><h3><strong>Available </strong><em>SizeConstraint </em><strong>parameters</strong></h3>\n<p>Calling the&nbsp;<em>ImageUrl&nbsp;</em>method on the file's permanent URL allow you to resize the image to the specified <strong>height </strong>(<em>SizeConstraint.Height(value)</em>), <strong>width</strong><em><strong>&nbsp;</strong></em><em>(SizeConstraint.Width(value))</em>&nbsp;or ensure that the image <strong>doesn't exceed the specified size</strong> (<em>SizeConstraint.MaxWidthOrHeight(value)</em>) in either of the two dimensions.</p>\n<p>The&nbsp;<em>SizeConstraint.Size(value, value)</em>&nbsp;property <strong>resizes the image to the specified width and height</strong> (and changes the image's aspect ratio).</p>\n<p>No matter what size you specify in the&nbsp;<em>SizeConstraint.Size</em>&nbsp;method call, the resized image is never larger than its original size.</p></div>\n<p>Following code snippet shows how you can display the files in <em>model</em> (the snippet above).</p>\n<pre><code class=\"language-html\">@model IEnumerable&lt;MediaFileViewModel&gt;\n(...)\n@* Loops through the media files in the view model *@\n@foreach (MediaFileViewModel mediaFile in model)\n{\n    @* Gets a permanent URL for the media file *@\n    string url = Url.Kentico().ImageUrl(mediaFile.PermanentUrl);\n  @* Sets the file's URL as the source tag, and its title as the alt-tag *@ \n    &lt;img src=\"@url\" alt=\"@mediaFile.FileTitle\" /&gt;\n}</code></pre>","title":"Retriving files from media libraries","_graphic":null},{"body":"<h2>Setting access permissions for media libraries</h2>\n<p>Not all the users or editors need to have access to all of the media libraries and to all the actions that can be performed with them. With the advanced functionalities of Kentico security model, you can assign user permissions to prevent undesired behavior of the website. We recommend that <strong>only the lowest number of users (or admins) are allowed</strong> to perform actions mentioned above.</p>\n<p>The best practice is to pre-define the folder structure of the libraries when they are created and not to allow users to further modify it. You can create a specific role to manage your media libraries and define suitable permissions for particular actions for each media library.</p>\n<p>You can find an example of <a href=\"https://docs.kentico.com/k12/configuring-kentico/configuring-the-environment-for-content-editors/configuring-media-libraries/assigning-permissions-to-media-libraries\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">defining the role and setting up permissions for media libraries</a> in Kentico documentation.</p>\n<p>Please note that if you want to modify access permissions to specific media files on the live site, for example, to only sign-in users, you need to make sure the following is true:</p>\n<ul>\n  <li>In the live site, you generate permanent URLs for the media files.</li>\n  <li>Enable <em>Check file permissions</em> in the <em>Settings </em>application.</li>\n  <li>Enable <em>Use permanent URLs</em> in <em>Settings &gt; Content &gt; Media &gt; General</em>.</li>\n</ul>","title":"Configuring the media files","_graphic":null}],"instruction":"","_layout":"full","_component":"accordion","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"ade14105-06ed-4c22-8037-249441077015","_parentId":"1dac1227-fea0-43cc-a2da-e2094a629695","_type":"component","title":"Media libraries","displayTitle":"Media libraries"},{"body":"<p>Medio Clinic contains one media library. The <em>MedicalCenters</em> media library stores several <em>.jpg</em> images which are displayed on the live site's <em>Contact</em> page. The media library is synced in the web farm with the MVC application; the images are stored in the default location, i.e., <em>/MedioClinic/media/MedicalCenters</em>.<br>\nThe images are retrieved in a custom service class. First, the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/MediaLibrary/IMediaLibraryService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IMediaLibraryService</em></a> interface defines methods for getting media library files. The <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/MediaLibrary/MediaLibraryService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>MediaLibraryService</em></a><em>,</em> an implementation of IMediaLibraryService, internally uses Kentico API to obtain files from media libraries. The service maps the result to an <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/MediaLibrary/MediaLibraryFileDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IEnumerable&lt;MediaLibraryFileDto&gt;</em></a><em> </em>sequence. The <em>MediaLibraryFileDtos</em> have <em>titles</em>, file <em>extensions</em>, and both <em>direct</em> and <em>permanent URLs</em> of the media files.</p>\n<p>The above sequence is passed around into the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/Contact/ContactViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ContactViewModel</em></a> object and to the Contact's <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Contact/Index.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Index</em></a> view respectively. In there, it is looped through with <em>foreach</em> and displayed on the live site. The method reads the <em>DirectURL</em> property through the custom <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Extensions/UrlExtensions.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>KenticoImageUrl</em></a> HTML helper method.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"ff338a51-c294-4daa-be56-d0aaff41c291","_parentId":"1dac1227-fea0-43cc-a2da-e2094a629695","_type":"component","title":"Implementation of media libraries on Medio Clinic","displayTitle":"Implementation of media libraries on Medio Clinic"},{"body":"<p>To see how Kentico API helps you with displaying images stored in media libraries, let's build a <em>Contact</em> page. Make sure that the following statements about your training website are true at the end of this exercise.</p>\n<ul>\n  <li>Medio Clinic website contains a <em>Contact us</em> page.</li>\n  <li>The new <em>Contact</em> page displays data from the admin UI - a <em>Contact us</em> header, a subtitle, a short description, and all the contact information of the Medio Clinic company (as well as the website's <em>header</em> and <em>footer</em>).</li>\n  <li>The page uses data from the admin UI and displays position of <em>Medio Clinic</em>'s offices on a map.</li>\n  <li>The implementation of the map is capable of locating any new offices which editors add in the admin UI (by a using a specific page type for map locations).</li>\n  <li>The admin UI contains a media library, e.g, <em>Medical centers</em>, which contains images. (You can use images in the <em>assets</em> &gt; <em>Medial Centers photos</em> folder in the course assets.)</li>\n  <li>The <em>Contact</em> page uses Kentico API to display the images from the media library. (The recommended practice is to use a custom service to wrap Kentico API. Note: You don't need to add another web farm to your website, your course license covers what you need to complete this part of the exercise.)</li>\n  <li>The code that displays the images dynamically handles the images. If a new image is added to the media library in the admin UI, it's displayed on the page.</li>\n  <li>Medio Clinic's navigation menus contain the <em>Contact</em> <em>us </em>item.</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"2b119d0e-a78f-4ea8-aaa0-edcb88a8a5ba","_parentId":"053ac411-e964-4820-96bb-a9414f476d8c","_type":"component","title":"Task: Displaying images from the Media library","displayTitle":"Task: Displaying images from the Media library"},{"body":"<p>The following demo shows how you can accomplish the goals outline above.</p>\n<p>If you want to follow the demo, you need to create a new media library, e.g., <em>MedicalCenters</em>, in the administration interface and upload some files. You can use photos in the <em>assets </em>&gt; <em>Medical Centers photos</em> folder in the course assets.&nbsp;</p>\n<p>The demo focuses on the code-part of the implementation. If you are not familiar with working with media libraries application, you can follow a step by step description for both <a href=\"https://docs.kentico.com/k12/managing-website-content/working-with-files/media-library-files/creating-media-libraries\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">creating the media library</a> and <a href=\"https://docs.kentico.com/k12/managing-website-content/working-with-files/media-library-files/inserting-files-into-media-libraries\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">inserting the files</a> in the Kentico documentation.</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>Before you attempt to display the contents of the <em>MedicalCenters</em> media library, you may want to display the textual content of the contact us page first.&nbsp;</p>\n<p>The future <em>Contact us </em>page is supposed to render a lot of data which were added through different content-only pages. Take some time and look into your admin interface to see what content &nbsp;you've created. If you followed the demos, your <em>Contact us</em> and its child sections should contain the following:</p>\n<ul>\n  <li><em>Contact us - ContactSection </em>page type<em>, </em>contains <em>Title</em>, <em>Subtitle</em>, and <em>Text</em> fields.</li>\n  <li><em>Medio clinic</em> - <em>Company</em> page type, contains <em>Company name</em>,<em> Street</em>,<em> City</em>, etc. You have already mapped the values to <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Company/CompanyDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CompanyDto</em></a>.</li>\n  <li><em>Map locations</em> - <em>MapLocation</em> page type, contains N<em>ame</em>, <em>Latitude</em>, <em>Longitude</em>, and <em>Tooltip text</em> fields.</li>\n  <li><em>Social links</em> - <em>SocialLink</em> page type, contains <em>Name</em>, <em>Link title</em>, and <em>Link URL</em> fields. You have already mapped the stored values to <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Social/SocialLinkDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>SocialLinkDto</em></a>.</li>\n</ul>\n<p>Use the same approach to map the data from the yet unmapped<em> </em>page types as you did with the rest of the pages.&nbsp;</p>\n<p><strong>Retrieving data for the contact section</strong></p>\n<ol>\n  <li>In the <em>Business</em> project &gt; <em>Dto</em> folder, create a new <em>Contact</em> folder, add a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Contact/ContactSectionDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ContactSectionDto</em></a> class with <em>Header</em>, <em>Subheader</em>, and <em>Text</em> properties.</li>\n  <li>In the <em>Business</em> project &gt; <em>Repository</em> folder, add a new <em>Contact</em> folder, and create a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Contact/IContactSectionRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IContactSectionRepository</em></a> interface which implements <em>IRepository</em>. Add a <em>GetContactSection</em> to return a <em>contact section</em> <em>data object</em>.</li>\n  <li>Create a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Repository/Contact/ContactSectionRepository.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ContactSectionRepository</em></a> repository, make it inherit from the <em>base repository</em> and call the base class' constructor to initialize the <em>document query service</em>.</li>\n  <li>Implement the <em>GetContactSection</em> method defined in the interface. Call into <em>DocumentQueryService.GetDocuments()</em> &nbsp;and map the retrieved values from the <em>CMS.DocumentEngine.Types.MedioClinic.ContactSection</em> objects to a new single <em>ContactSectionDto</em> object.</li>\n</ol>\n<p>See the code snippet on the left to find out how the method should be implemented. (The approach is similar to how you implemented, e.g., the <em>GetHomeSection</em> method for the Medio Clinic's home page).</p>","code":{"src":"(...)\nnamespace Business.Repository.Contact\n{\n    public class ContactSectionRepository : BaseRepository, IContactSectionRepository\n    {\n\n        public ContactSectionRepository(IDocumentQueryService documentQueryService) : base(documentQueryService)\n        {\n        }\n\n        public ContactSectionDto GetContactSection()\n        {\n            return DocumentQueryService.GetDocuments<ContactSection>()\n                .TopN(1)\n                .AddColumns(\"Title\", \"Subtitle\", \"Text\")\n                .ToList()\n                .Select(m => new ContactSectionDto()\n                {\n                    Header = m.Title,\n                    Subheader = m.Subtitle,\n                    Text = m.Text\n                })\n                .FirstOrDefault();\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Adding MapRepository</p>\n<p>Now you should make some provisions to render office locations in the map.</p>\n<ol>\n  <li>In the <em>Business</em> project &gt; <em>Dto</em> folder, create a <em>Map</em> subfolder. Add a new <em>MapLocationDto</em> class that implements <em>IDto</em>.</li>\n  <li>Add the <em>Latitude</em>, <em>Longitude</em> properties of type <em>double</em>. Add a <em>Tooltip</em> string property.</li>\n  <li>In the Repository folder, create a Map subfolder. In there, define a new <em>IMapRepository</em> interface with a <em>GetOfficeLocations</em> method that returns <em>IEnumerable&lt;MapLocationDto&gt;</em>.</li>\n  <li>Implement that interface in a new <em>MapRepository</em> class that also inherits from <em>BaseRepository</em>.</li>\n  <li>In your GetOfficeLocations method, build a query calling <em>DocumentQueryService.GetDocuments()</em>, materialize the query and map the results to an <em>IEnumerable&lt;MapLocationDto&gt;</em> sequence.</li>\n</ol>","code":{"src":"// Example of MapLocationDto object\npublic class MapLocationDto : IDto\n  {\n        public double Latitude { get; set; }\n        public double Longitude { get; set; }\n        public string Tooltip { get; set; }\n  }\n\n// Example of MapRepository\n()\n    public class MapRepository : BaseRepository, IMapRepository\n    {\n        public MapRepository(IDocumentQueryService documentQueryService) : base(documentQueryService)\n        {\n        }\n\n        public IEnumerable<MapLocationDto> GetOfficeLocations()\n        {\n            return DocumentQueryService.GetDocuments<CMS.DocumentEngine.Types.MedioClinic.MapLocation>()\n                .AddColumns(\"Longitude\", \"Latitude\", \"Tooltip\")\n                .OrderByAscending(\"NodeOrder\")\n                .ToList()\n                .Select(m => new MapLocationDto()\n                {\n                    Latitude = m.Latitude,\n                    Longitude = m.Longitude,\n                    Tooltip = m.Tooltip\n                });\n        }\n    }","lang":"csharp"},"strapline":""},{"title":"","body":"<p><strong>Registering the repositories</strong></p>\n<ol>\n  <li>Define the new repositories in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/DependencyInjection/IBusinessDependencies.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IBusinessDependencies</em></a> interface.</li>\n  <li>Implement the new repositories in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/DependencyInjection/BusinessDependencies.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BusinessDependencies</em></a> so that they are resolved by the IoC container.</li>\n</ol>\n<p><strong>Adding the view model</strong></p>\n<ol>\n  <li>In the <em>MedioClinic</em> project's &gt; <em>Models</em> folder, add a new <em>Contact</em> subfolder.</li>\n  <li>Add a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/Contact/ContactViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>contact view model </em></a>which implements the <em>IViewModel</em> interface, and maps the <em>contact section data</em> in the <em>ContactSection</em> property and a <em>collection</em> of <em>map location data</em> in an <em>OfficeLocations</em> property.</li>\n</ol>","code":{"src":"namespace MedioClinic.Models.Contact\n{\n    public class ContactViewModel : IViewModel\n    {\n        public ContactSectionDto ContactSection { get; set; }\n        public IEnumerable<MapLocationDto> OfficeLocations { get; set; }\n    }","lang":"csharp"},"strapline":""},{"title":"","body":"<p><strong>Adding Contact controller</strong></p>\n<ol>\n  <li>Create a <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/ContactController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ContactController</em></a> class in the Medio Clinic's <em>Controllers</em> folder. Make it inherit from the <em>base controller</em>.</li>\n  <li>Create a constructor that takes the business dependencies, your new contact section repository, and the map repository youve just created. Pass the business dependencies onto the base controllers constructor, while storing the other arguments into properties of your new controller.</li>\n  <li>In your Index action result method, declare a <em>contactSection</em> variable and populate it with data by calling <em>ContactSectionRepository.GetContactSection().</em></li>\n  <li>As usual, check <em>contactSection</em> for being <em>null</em>, and return <em>HttpNotFound()</em> eventually<em>.</em></li>\n  <li>Create a <em>model</em> object by calling the <em>GetPageViewModel </em>method with a newly constructed <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/Contact/ContactViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ContactViewModel</em></a> object as an argument. Using the initializer syntax, populate the view model in the following way:\n    <ol>\n      <li>Map the <em>contact section data </em>and <em>data for office locations</em> (by calling <em>MapRepository.GetOfficeLocations()) </em>to the respective rpoperties of the new <em>ContactViewModel </em>object.</li>\n      <li>Use the <em>contact section</em>'s <em>header</em> property for the browser <em>title.</em></li>\n    </ol>\n  </li>\n  <li>Return the conventional <em>Index </em>view.</li>\n</ol>\n<p>See the snippet on the left for the implementation, or the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/ContactController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ContactController</em></a> on GitHub to see the bigger picture. (Please note that the linked code sample already contains mapped data to display images from the media library which is covered later in this demo.)</p>","code":{"src":"(...)\nnamespace MedioClinic.Controllers\n{\n    public class ContactController : BaseController\n    {\n        private IContactSectionRepository ContactSectionRepository { get; }\n        private IMapRepository MapRepository { get; }\n\n        public ContactController(\n            IBusinessDependencies dependencies, \n            IContactSectionRepository contactSectionRepository,\n            IMapRepository mapRepository\n           (...)\n            ) : base(dependencies)\n        {\n            ContactSectionRepository = contactSectionRepository;\n            MapRepository = mapRepository;\n        }\n\n        public ActionResult Index()\n        {\n            var contactSection = ContactSectionRepository.GetContactSection();\n\n            if (contactSection == null)\n            {\n                return HttpNotFound();\n            }\n\n            var model = GetPageViewModel(new ContactViewModel()\n            {\n                ContactSection = contactSection,\n                OfficeLocations = MapRepository.GetOfficeLocations()\n               (...)\n            }, contactSection.Header);\n\n            return View(model);\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p><strong>Adding the Contact's Index view</strong></p>\n<ol>\n  <li>Create a new <em>Contact</em> folder in the Medio Clinic's <em>Views</em> folder.</li>\n  <li>Add a new <em>Index</em> view strongly-typed against the <em>ContactViewModel.</em></li>\n  <li>Use the HTML markup in <em>contact.html</em> in the Medio Clinic's assets and replace the hard-coded values with view model data.</li>\n  <li>To display the map, you can use &nbsp;<a href=\"https://developers.google.com/maps/documentation/javascript/tutorial\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Google Maps JavaScript API</em></a>. Use Kentico data and display markers and windows per each of the Medio Clinic's locations.</li>\n</ol>\n<p>See the code snippet for details about the implementation.</p>","code":{"src":"@model MedioClinic.Models.PageViewModel<ContactViewModel>\n\n@section scripts {\n\n    <script type=\"text/javascript\">\n        /* Google map callback */\n        function initMap() {\n\n            var mapOptions = {\n                zoom: 3,\n                center: { lat: 0, lng: 0 },\n                mapTypeId: google.maps.MapTypeId.HYBRID\n            };\n\n            var map = new google.maps.Map(document.getElementById(\"map\"), mapOptions);\n\n            /* Loops through the OfficeLocations collection and generates a map marker per each location */\n            @foreach (var location in Model.Data.OfficeLocations)\n            {\n                <text>\n                    var marker = new google.maps.Marker({\n                        position: {\n                            /* Defines map marker location using location values stored in Kentico */\n                            lat: @location.Latitude.ToString(CultureInfo.InvariantCulture),\n                            lng: @location.Longitude.ToString(CultureInfo.InvariantCulture) },\n                    map: map\n            });\n\n            marker.setMap(map);\n\n            var infoWindow = new google.maps.InfoWindow({\n                 /* Passes the value of the Tooltip property into the map's InfoWindow overlay */\n                content: \"@location.Tooltip\"\n             });\n\n              infoWindow.open(map, marker);\n                </text>\n            }\n        }\n    </script>\n\n    @Scripts.Render(\"https://maps.googleapis.com/maps/api/js?key=AIzaSyBqj371OzjrUb_iYNf4N-sUF_Y1JG8ePGc&callback=initMap\")\n\n}\n<!-- Contact header -->\n<div class=\"section kn-section-top\">\n    <div class=\"container\">\n        <div class=\"row\">\n            <div class=\"col s12 m12\">\n                <!-- Resolves the value of the Contact section's header; if null, no information is displayed. -->\n                <h1 class=\"header \">@(Model.Data.ContactSection?.Header)</h1>\n            </div>\n        </div>\n        <div class=\"row\">\n            <div class=\"col l8 m12 s12\">\n                <!-- Resolves the value of the Contact section's subtitle; if null, no information is displayed. -->\n                <h4 class=\"contact-header\">@(Model.Data.ContactSection?.Subheader)</h4>\n                <p>\n                    <!-- Resolves the value of the Medio Clinic\"s description; if null, no information is displayed. -->\n                    @(Model.Data.ContactSection?.Text)\n                </p>\n            </div>\n            <div class=\"col l3 m12 s12 offset-l1 offset-m0 offset-s0 kn-contact-us-box\">\n                <div class=\"kn-contact-box-header\">\n                    <h5>Contact</h5>\n                </div>\n                <div class=\"kn-contact-content\">\n                    <!-- Displays Medio clinic's address using values stored in the CompanyDto -->\n                    @(Model.Company.Street)\n                    <br>@Model.Company.City\n                    <br>@Model.Company.Country @Model.Company.State\n                    <br>@Model.Company.PhoneNumber\n                    <br>@Model.Company.Email\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n<!-- Contact map --> \n<div class=\"container\">\n    <div class=\"section\">\n        <div class=\"row\">\n            <div class=\"col s12 m12\">\n                <div id=\"map\" class=\"kn-map\">\n                </div>\n            </div>\n        </div>\n    </div>\n</div>","lang":"html"},"strapline":""},{"title":"","body":"<p>The next step is to get images for the second half of the <em>Contact us </em>page.</p>\n<p>You can use similar approach to what you did with data for pages. Retrieve the content of the <em>Medical Centers</em> media library using a custom <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/MediaLibrary/MediaLibraryService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>MediaLibraryService</em></a> (that wraps Kentico API) and map them to a DTO's properties.</p>\n<ol>\n  <li>In the <em>Business</em> project &gt; <em>Dto</em> folder, create a new <em>MediaLibrary</em> subfolder. Add a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/MediaLibrary/MediaLibraryFileDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>MediaLibraryFileDto</em></a> with <em>Title</em>, <em>DirectUrl</em>, <em>PermanentUrl</em>, and <em>Extension</em> properties. (Make the new DTO implement the empty <em>IDto</em> for consistency.)</li>\n  <li>In the <em>Business</em> project &gt; <em>Services</em> folder, create a new <em>MediaLibrary</em> folder. Add a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/MediaLibrary/IMediaLibraryService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>IMediaLibraryService</em></a> interface and define <em>GetMediaLibraryFiles()</em> method. (Make the new <em>interface</em> implement the empty <em>IService</em> interface for consistency.)</li>\n  <li>The method will accept code names of the <em>folder</em>, <em>site name</em> and <em>extensions</em> and it will create a sequence of <em>MediaLibraryFileDto </em>objects.</li>\n</ol>\n<p>See the code snippet for details.</p>","code":{"src":"(...)\nnamespace Business.Services.MediaLibrary\n{\n    public interface IMediaLibraryService\n    {\n        /// <summary>\n        /// Wrapper around Kentico API for retrieving media stored in media libraries. \n        /// Fetches files from the given folder.\n        /// </summary>\n        /// <param name=\"folder\">Codename of the folder</param>\n        /// <param name=\"sitename\">Sitename</param>\n        /// <param name=\"extensions\">Allowed extensions (e.g. '.png', '.jpg')</param>\n        /// <returns></returns>\n        IEnumerable<MediaLibraryFileDto> GetMediaLibraryFiles(string folder, string sitename, params string[] extensions);\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p><strong>Implement the media library service interface</strong></p>\n<p>The implementation of the&nbsp;<em>MediaLibraryService&nbsp;</em>class resembles the repositories that you've implemented earlier. As with the repositories, the class is responsible of returning DTOs. However, this time, you won't want to use your&nbsp;<em>DocumentQueryService</em>&nbsp;class. You'll call directly into&nbsp;<em>CMS.MediaLibrary.MediaLibraryInfoProvider.GetMediaLibraryInfo()</em>&nbsp;instead.</p>\n<ol>\n  <li>In the <em>Business</em> project's <em>Services</em> &gt; <em>MediaLibrary</em> folder, create a new <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/MediaLibrary/MediaLibraryService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>MedialLibraryService</em></a> class.</li>\n  <li>Implement the <em>GetMediaLibraryFiles</em> method to return a sequence of <em>MediaLibraryFileDto </em>objects.</li>\n  <li>Declare a <em>mediaLibrary</em> variable, and call <em>MediaLibraryInfoProvider.GetMediaLibraryInfo(folder, sitename)</em> to get the instance of the media library for the current site.</li>\n  <li>Call <em>MediaFileInfoProvider.GetMediaFiles()</em>, and from the <em>media file objects</em> in Kentico\n    <ol>\n      <li>Limit the query to an ID of the media library you've retrieved above, by passing it into <em>WhereEquals()</em>,</li>\n      <li>Limit the query to specified file-type extensions by calling <em>WhereIn()</em>, and</li>\n      <li>Map the retrieved values to <em>MediaLibraryFileDto's</em> properties. To generate media file URLs of files, call <em>MediaLibraryHelper.GetDirectUrl()</em> and <em>MediaLibraryHelper.GetPermanentUrl()</em>. (The <em>MediaLibraryHelper</em> class is available in the <em>CMS.MediaLibrary</em> namespace.) Just remember, both methods return relative URLs and you need to process them in your views to get the file's final URL.</li>\n    </ol>\n  </li>\n  <li>Pass the collection of <em>media library file data objects</em> with the mapped values to the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Models/Contact/ContactViewModel.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ContactViewModel</em></a>.&nbsp;</li>\n</ol>\n<p>Please see the code sample for detailed information about the custom media library service.&nbsp;</p>","code":{"src":"namespace Business.Services.MediaLibrary\n{\n    public class MediaLibraryService : BaseService, IMediaLibraryService\n    {\n        public IEnumerable<MediaLibraryFileDto> GetMediaLibraryFiles(string folder, string sitename, params string[] extensions)\n        {\n            // Gets an instance of the media library for the current site\n            var mediaLibrary = MediaLibraryInfoProvider.GetMediaLibraryInfo(folder, sitename);\n\n            // Gets a collection of media files and their extensions from the media library\n            return MediaFileInfoProvider.GetMediaFiles()\n                .WhereEquals(\"FileLibraryID\", mediaLibrary.LibraryID) \n                .WhereIn(\"FileExtension\", extensions)\n                .ToList()\n                .Select(m => new MediaLibraryFileDto()\n                {\n                    Title = m.FileTitle,\n                    Extension = m.FileExtension,\n                    DirectUrl = MediaLibraryHelper.GetDirectUrl(m),  // Returns media file direct URL \n                    PermanentUrl = MediaLibraryHelper.GetPermanentUrl(m)  // Returns medial file permanent URL\n                });\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p><strong>Updating the ContactController</strong></p>\n<ol>\n  <li>To display images on the live site, you should first let the IoC controller inject the <em>MediaLibraryService</em> to your <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/ContactController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ContactController</em></a>.</li>\n  <li>Update the statement that invokes the <em>GetPageViewModel</em> method. More specifically, update the inner <em>ContactViewModel</em> initializer to also populate the <em>MedicalCenterImages </em>property.\n    <ol>\n      <li>Call your custom <em>MediaLibraryService.GetMediaLibraryFiles()</em> and pass the following arguments:\n        <ol>\n          <li><em>MedicalCenters</em> for the library name,</li>\n          <li>Add the <em>site name</em> property of the <em>site context service</em>, and</li>\n          <li>Specify a set of file name extensions to filter by, through the last params parameter.</li>\n        </ol>\n      </li>\n      <li>Use the contact section's <em>header</em> property for the page's <em>title</em>.</li>\n    </ol>\n  </li>\n</ol>\n<p><strong>Adding the library to the Contact view</strong></p>\n<ol>\n  <li>Use the <em>Media centers media library </em>section markup from the <em>Contact.html</em> sample code and add it to the Contact's <em>Index.cshtml</em> view.</li>\n  <li>Replace the hard-coded values to display the images dynamically. Use <em>foreach</em> to loop through the collection of the medical center images and pass their properties (the <em>DirectUrl</em> and <em>Title</em>) to the HTML markup. Remember that the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/MediaLibrary/MediaLibraryFileDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>MediaLibraryFileDto</em></a> object maps a server-relative URL of the image, so you need to resolve the file's final URL path by using the custom <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Extensions/UrlExtensions.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>KenticoImageUrl</em></a> method.</li>\n</ol>\n<p>(The code snippet displays markup that retrieves the images from media library to the live site. &nbsp;You can see the finalized markup of the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Contact/Index.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Contact Index.cshtml view</em></a> in the GitHub repository.)</p>","code":{"src":"// The updated ContactController\nvar model = GetPageViewModel(new ContactViewModel()\n{\n    ContactSection = contactSection,\n    OfficeLocations = MapRepository.GetOfficeLocations(),\n    MedicalCenterImages = MediaLibraryService.GetMediaLibraryFiles(\"MedicalCenters\", Dependencies.SiteContextService.SiteName, \".jpg\", \".png\")\n}, contactSection.Header);\n(...)\n// The Contact view\n<!-- Adds section which displays images from the media library to the view  -->\n<div class=\"container\">\n    <div class=\"section\">\n        <div class=\"row\">\n            <div class=\"col s12 m12\">\n                <h3>Our medical centers</h3>\n            </div>\n        </div>\n        <div class=\"row\">\n            @*Loops through the images in the Medial Center library and generates direct urls for each image stored in the library.*@\n            @foreach (var medicalCenterImage in Model.Data.MedicalCenterImages)\n            {\n                <div class=\"col l4 m6 m12\">\n                    <div class=\"kn-medcenter\">\n                        @*System returns relative ULR of the image which is processsed in the custom KenticoImageUrl helper method and the image's source parameter. Image's Title property is passed to the alt-tag. *@\n                        <img src=\"@Url.KenticoImageUrl(medicalCenterImage.DirectUrl)\" alt=\"@medicalCenterImage.Title\">\n                    </div>\n                </div>\n            }\n        </div>\n    </div>\n</div>","lang":"html"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrativeCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"dca1ba52-69fe-4909-8db1-bf561348d2bd","_parentId":"42f3af85-7039-4cf6-bc5e-f66823f05e4c","_type":"component","title":"Demo: Displaying the media library","displayTitle":"Demo: Displaying the media library"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Select the correct statement about the limitations of media libraries.</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"text":"<p>To prevent performance issues of the admin application, Kentico recommends storing at most 100 files within one single media library folder. This rule applies for any kind of storage, either external, such as Azure Blob Storage, or in the web application's file system.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. Kentico recommends limiting number of files to 100 in a media library folder only for projects which use external storage providers. The rule doesn't apply for projects which store files in the file system.</p>"},{"text":"<p>To prevent performance issues of the admin application, Kentico recommends storing at most 100 files within one single media library folder. If you need to store more than 100 files, you need to structure them into folder hierarchy. This recommendation applies only for projects which use external storage providers, such as Azure Blob Storage.</p>","_shouldBeSelected":true,"feedback":""},{"text":"<p>To prevent performance issues of the admin application, Kentico recommends storing at most 100 files within one single media library if your project uses external storage providers, such as Azure Blob Storage.</p>","_shouldBeSelected":false,"feedback":"<p>Wrong. For projects that use external storage providers, Kentico recommends storing at most 100 files within one single folder, not the whole media library. You can store any number of files within a media library provided that it is structured into hierarchy, and the 100-file rule per folder is withheld.</p>"}],"_feedback":{"title":"","correct":"<p>Correct. The 100-files per folder recommendation applies for projects which use external storage providers.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"mcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"33b641c4-52cb-4cd8-b771-f321d8a79822","_parentId":"da446e4f-5bf4-42b6-a14a-185b997c6cd7","_type":"component","title":"Progress-check: Media libraries limitations","displayTitle":"Progress-check: Media libraries limitations"},{"_canShowModelAnswer":true,"_isRandom":true,"_shouldDisplayAttempts":true,"_allowsPunctuation":true,"body":"<p>Your project displays files from the media library on the live site to any visitor (meaning you don't need to apply access permissions to viewing and updating the file). Which of the following methods to retrieve the file's URL exposed in Kentico API will you use to get the best performance?</p>","_attempts":3,"_questionWeight":1,"_selectable":1,"_items":[{"title":"","code":{"src":"GetPermanentUrl() method","lang":"csharp"},"feedback":"<p>Wrong. The <em>PermanentURL</em> property provides you with additional options, such as defining access permissions for viewing and retrieving files. As a result, the performance will be slower when compared to files retrieved via <em>GetDirectURL</em> method.</p>","_shouldBeSelected":false},{"title":"","code":{"src":"GetDirectUrl() method","lang":"csharp"},"feedback":"","_shouldBeSelected":true},{"title":"","code":{"src":"GetMediaFileUrl() method","lang":"csharp"},"feedback":"<p>Wrong. Kentico API doesn't expose such a method to retrieve files.</p>","_shouldBeSelected":false}],"_feedback":{"title":"","correct":"<p>Correct. The files retrieved via their <em>direct URL</em> property provide, in general, better performance than files retrieved via their <em>permanent URL</em> property.</p>","_partlyCorrect":{"final":""},"_incorrect":{"final":""}},"instruction":"","_layout":"full","_component":"cmcq","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"89efe0c7-9c59-4278-8833-95ed216bd9cd","_parentId":"da446e4f-5bf4-42b6-a14a-185b997c6cd7","_type":"component","title":"Progress-check: Retrieving files Kentico API","displayTitle":"Progress-check: Retrieving files Kentico API"},{"body":"<p>Congratulations on completing another part of the course!</p>\n<p>You now know how you can create and use media libraries to store physical files on your website. You know what settings you can configure so it fits better your project, and how you can use the Kentico security model to set up permissions to access the individual media libraries and its files. You learned about the recommended practice to use when displaying media library files on the live site. And you have built a <em>Contact us </em>page which - besides media library files - contains a map with markers that show office locations.</p>\n<p>Hurry up and find out how you can set up a custom friendly error page in the next part of the course!</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"9612bcd8-60df-4213-8773-44a7df0afcd3","_parentId":"95d72303-2400-4f38-a2ee-f8b6b4232906","_type":"component","title":"Conclusion","displayTitle":"Conclusion"},{"body":"<p>What you will learn in this section</p>\n<ul>\n  <li>How you can <strong>handle 404 errors</strong> in MVC applications</li>\n  <li>What is <strong>the recommended practice for handling errors</strong> on websites built with MVC&nbsp;</li>\n</ul>\n<p>You will work on:</p>\n<ul>\n  <li>Creating a user friendly error page</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"fb5e5865-d06a-4278-acc8-bb6d0fc87e03","_parentId":"bc8b4aa0-ba0a-45de-98c5-1e995935c56a","_type":"component","title":"Introduction","displayTitle":"Introduction"},{"body":"<p>The&nbsp;<em>Page not found</em>&nbsp;error (404 HTTP status code) is one of the most common issues that visitors meet when browsing the websites.&nbsp;</p>\n<p>MVC applications typically execute user actions. Even when a user performs a request which the application doesn't support, it's unacceptable for any professional application to return a user-unfriendly error message, such as an HTTP status code or even worse, the YSOD (<em>Yellow-Screen-Of-Death</em> which IIS returns by default).</p>\n<p>The status code is too technical for website visitors, and they won't understand what's happening and what they should do differently. Moreover, the YSOD may contain a stack trace which can present a potential vulnerability - and introduce a security issue. That's why a user-friendly error page is a must.</p>\n<h2>Errors in MVC websites</h2>\n<p>In general, there are two types of errors in ASP.NET MVC websites, and they are raised either by the MVC application itself or by the IIS.</p>\n<p>The following errors are typically raised by an MVC application:</p>\n<ul>\n  <li>The URL requested by the user doesn't match any route on the website.</li>\n  <li>The URL matches a route, but a specific controller or controller action isn't found.</li>\n  <li>Controller action explicitly returns <em>System.Web.Mvc.HttpNotFoundResult</em> by, e.g., calling the <em>HttpNotFound</em> method.</li>\n</ul>\n<p>IIS can raise the following errors:</p>\n<ul>\n  <li>The file that the user requested doesn't exist.</li>\n  <li>There is no binding for the requested extension, e.g, <em>jpg1</em>.</li>\n  <li>The static file handler doesn't find the file on the disk.</li>\n</ul>\n<h2>Handling the 404 error</h2>\n<p>Any suitable response to a 404 error in a modern MVC application should ensure the following:</p>\n<ul>\n  <li>It preserves the original request URL.</li>\n  <li>It doesn't respond with a 302 redirect.</li>\n  <li>It returns correct 404 HTTP status code.</li>\n</ul>\n<h2>Implementing the error page</h2>\n<p>In the ASP.NET framework,&nbsp;there is a number of approaches you can take to implement how your website deals with error pages.</p>\n<p>We recommend handling errors on the IIS level by creating a custom friendly error MVC page or a static&nbsp;<em>.html</em>&nbsp;page and specify the path to the error page in the application's <em>Web.config</em> using the&nbsp;<em>httpErrors</em>&nbsp;element. The reason is that the <em>httpErrors </em>approach allows you to handle both IIS-level and ASP.NET-level errors in one go.</p>\n<p>Regarding the content of the error page, you can implement any of the following scenarios:</p>\n<ul>\n  <li>Create a static <em>.html </em>page with a hard-coded content to display as an error message.</li>\n  <li>Create a general MVC page which contains user-friendly error message&nbsp;hard-coded in the view's markup (for details see how we developed the Medio Clinic's error page).</li>\n  <li>Give a full control over the content of the error page to editors. You can create a <em>NotFound</em> page type with a suitable URL pattern and provide editors with means, e.g., suitable form controls, to populate the page with content they want to link or promote to their customers. The editors will then use the page type and create a Not found error page in the content tree. (Using this approach, you'll also need to implement the features to retrieve the content of the page to the live site. The implemented custom error page will be just another item in the content tree, and you can follow the same steps you took to display, e.g., the <em>Home</em> and other pages on the Medio Clinic live site.)</li>\n</ul>\n<h2>Handling 404 HTTP exceptions on the ASP.NET level</h2>\n<p>If you decide to use any of the three approaches, you need to configure the behavior of your application when an error occurs. You can do so in the Global.asax.cs file.&nbsp;</p>\n<pre><code class=\"language-csharp\">protected void Application_Error()\n{\n    // Sets 404 HTTP exceptions to be handled via IIS (behavior is specified in the \"httpErrors\" section in the Web.config file)\n    var error = Server.GetLastError();\n    if ((error as HttpException)?.GetHttpCode() == 404)\n    {\n        Server.ClearError();\n        Response.StatusCode = 404;\n    }\n}</code></pre>\n<p>The above method is an event handler that may accept the references to the sender and event arguments. It is being triggered by all ASP.NET exceptions. Here you may want to set the <em>StatusCode </em>property of the Response object.</p>\n<div class=\"infobox warning\"><p>Please note that the Application_Error method is purely convention-based. It isn't defined in any interface, abstract class or an overridden method. Therefore, to make that method work, you should pay attention to spelling the signature of that method correctly.</p></div>\n<p>While the Application_Error method handles all ASP.NET exceptions that may occur, it won't be able to catch missed routes. You'll therefore want to also configure the <em>httpErrors </em>element in your Web. config file. The configuration depends on whether you want to have a static error page or an MVC error controller.</p>\n<h2>Creating a static HTML error page</h2>\n<p>Having a static .html page is arguably the safest possible approach. In some cases, it can be easier to develop, but it requires that you hard-code the styling of the page to match your website's layout and provide the user with a consistent experience.</p>\n<p>On the other hand, if there is any change to the basic site's layout, such as if there are new items in the websites' navigation, you need to update also the code of your static error page to match the experience which brings unnecessary expenses.</p>\n<p>The following code snippet shows how to reference your error page in the Web.config's <em>system.WebServer</em> node.</p>\n<pre><code class=\"language-html\">&lt;system.webServer&gt;\n    (...)\n    &lt;httpErrors errorMode=\"Custom\" existingResponse=\"Auto\"&gt;\n        &lt;remove statusCode=\"404\" subStatusCode=\"-1\" /&gt;\n        &lt;error statusCode=\"404\" path=\"/HttpErrors/404.html\" responseMode=\"File\"/&gt;\n    &lt;/httpErrors&gt;\n    (...)\n&lt;/system.webServer&gt;</code></pre>\n<div class=\"infobox note\"><p>Please note that the value of the <em>path</em> attribute needs to reflect the full relative URL path of the 404 page. If you hosted your app in an IIS <em>application </em>(e.g. \"http://localhost/iis-application/\"), the <em>path </em>value would have to also contain the URL path of that application (path=\"/iis-application/httperrors/404.html\").</p></div>\n<h2>Creating an MVC error controller and view</h2>\n<p>To use all MVC features, such as already defined webiste's layout or dynamically resolved navigation menu, you can create a custom <em>NotFound </em>controller with actions that handle the errors you need and return suitable views with hard coded markup. The <em>httpErrors </em>element would differ from the previous example only in the value of the <em>path </em>attribute. But this time around, the path points to the controller action, as required by your routing configuration.</p>\n<p>To use all MVC features, such as already defined website's layout or dynamically resolved navigation menu, you can create a custom <em>NotFound</em> controller with actions that handle the errors you need and return suitable views. Again, you need to reference the path to the respective controller action in the <em>Web.config</em>. You can see this approach in use on the Medio Clinic website.</p>\n<pre><code class=\"language-html\">&lt;system.webServer&gt;\n    ...\n    &lt;httpErrors errorMode=\"Custom\" existingResponse=\"Auto\"&gt;\n        &lt;remove statusCode=\"404\" subStatusCode=\"-1\" /&gt;\n        &lt;error statusCode=\"404\" path=\"/notfound\" responseMode=\"File\"/&gt;\n    &lt;/httpErrors&gt;\n    ...\n&lt;/system.webServer&gt;</code></pre>\n<p>This is exactly what Medio Clinic website uses.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":false},"_isOptional":false,"_classes":"","_id":"24e4bdef-30a2-4085-81cf-a91e206c937d","_parentId":"6fda4dcd-57da-4fd0-9d06-04852e70be60","_type":"component","title":"404 error pages in Kentico MVC","displayTitle":"404 error pages in Kentico MVC"},{"body":"<p>Long story short, the Medio Clinic implementation comprises of three pillars: the <em>Application_Error </em>method, the <em>httpErrors </em>element in the <em>Web.config </em>file and the controller-view pair.</p>\n<p>The site's Application_Error method (in <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Global.asax.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Global.asax.cs</em></a><em>) </em>handles ASP.NET exceptions by setting a proper <em>Response.StatusCode</em> value<em>. </em>Then, the site's <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Web.config\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Web.config</em></a> file takes care of missed routes with the <em>&lt;httpErrors&gt;</em> element added to the <em>web.webServer</em> section.</p>\n<p>The <em>\"/notfound\"</em> &nbsp;path's attribute of the <em>&lt;error&gt;</em> element matches the <em>NotFound </em>route in the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/RouteConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>RouteConfig.cs</em></a> file. The route invokes the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/NotFoundController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>NotFoundController's</em> <em>Index </em>action</a>. The <em>NotFoundController </em>inherits from&nbsp;<a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/BaseController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BaseController</em></a>,<em> </em>sets the page's response to the 404 status code and creates a <em>PageViewModel</em> object with \"<em>Not found</em>\" the future page title. Besides the title, the <em>PageViewModel</em> object contains basic Medio Clinic data, such as data for the page menu, company information or links to social media.</p>\n<p>The model is passed to the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/NotFound/index.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>NotFound </em>view</a> which contains the user friendly error message hard-coded in the HTML markup. (The image for the 404 page is stored in the Medio Clinic project and isn't synced to the administration interface.)</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"e2630382-a7b7-4fdc-93d0-30054183a350","_parentId":"6fda4dcd-57da-4fd0-9d06-04852e70be60","_type":"component","title":"Implementation of 404 on Medio Clinic","displayTitle":"Implementation of 404 on Medio Clinic"},{"body":"<p>To complete this exercise, build a custom user friendly error page that responds to 404 HTTP status code. You can take any approach you want, however, your error page needs to pass the following criteria:</p>\n<ul>\n  <li>The \"<em>Page not found</em>\" exceptions are handled globally on the ASP.NET level. (Approach recommend for websites built with Kentico MVC development model.)</li>\n  <li>The error page contains a message and an image. (You can use the <em>notfound.jpg</em> image in the course resources.)</li>\n  <li>The error page returns 404 HTTP status code.</li>\n  <li>It preserves the original request URL.</li>\n  <li>It doesn't respond with a 302 redirect.</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":false},"_isOptional":false,"_classes":"","_id":"4a5b049e-3663-43d0-a1cb-16c0697d65e1","_parentId":"50df62e6-cd6e-4bfc-a9ee-4dc82ace3b5d","_type":"component","title":"Task: Handling Page not found errors","displayTitle":"Task: Handling Page not found errors"},{"body":"<p>The following demo shows you how to implement feature which handles requests for non-existent pages. Feel free to code along!</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>First, you need to set up an error handler for all ASP.NET exceptions with the 404 HTTP status code.</p>\n<ol>\n  <li>Edit the <em>Global.asax.cs</em> code file in your <em>MedioClinic</em> project, and add an <em>Application_Error</em> method to the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Global.asax.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>MvcApplication</em></a> class.</li>\n</ol>","code":{"src":"protected void Application_Error()\n        {\n            // Sets 404 HTTP exceptions to be handled via IIS (behavior is specified in the \"httpErrors\" section in the MedioClinic.config file)\n            var error = Server.GetLastError();\n            if ((error as HttpException)?.GetHttpCode() == 404)\n            {\n                Server.ClearError();\n                Response.StatusCode = 404;\n            }\n        }","lang":"csharp"},"strapline":""},{"title":"","body":"<p>As the next step, you need to create a custom user-friendly error page. You will create a standard MVC controller to respond with <em>404</em> status code and pass a <em>page view model </em>to a custom <em>view</em>.</p>\n<ol>\n  <li>Create a new <em>NotFoundController</em> that inherits from the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/BaseController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BaseController </em></a>class</li>\n  <li>Call base controller's constructor to get &nbsp;data for the <em>navigation menu</em>, <em>page metadata</em>, Medio Clinic's <em>contact details</em>, <em>links</em> to its social media and <em>the site's cultures</em>.</li>\n  <li>Implement the <em>Index</em> action result method so that it creates a <em>page view model</em> with a<em> \"Not found\"</em> string as the argument of the <em>GetPageViewModel</em> method call.</li>\n  <li>Set the page's response to 404 status code, and pass the <em>model</em> to a conventional view.</li>\n</ol>","code":{"src":"using System.Web.Mvc;\nusing Business.DependencyInjection;\n\nnamespace MedioClinic.Controllers\n{\n    public class NotFoundController : BaseController\n    {\n\n        public NotFoundController(IBusinessDependencies dependencies) : base(dependencies)\n        {\n        }\n\n        public ActionResult Index()\n        {\n            Response.StatusCode = 404;\n\n            var model = GetPageViewModel(\"Not found\");\n\n            return View(model);\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>To display a custom error page, you need to add a <em>NotFound</em> Index view.</p>\n<ol>\n  <li>In the <em>Views </em>folder, create a new <em>NotFound</em> folder and add a new <em>Index</em> view, strongly-typed against <em>PageViewModel</em>.</li>\n  <li>Copy-paste the respective part of the static markup from the <em>404.html</em> page in the course assets.</li>\n  <li>Update the \"<em>notfound.jpg</em>\" image's <em>source</em> to match your solution.&nbsp;</li>\n</ol>\n<p>In the end, your <em>Not found</em> <em>Index</em> view might look like the code snippet on the left.</p>","code":{"src":"@model MedioClinic.Models.PageViewModel\n\n<div class=\"section\">\n    <div class=\"container\">\n        <div class=\"row\">\n            <div class=\"col s12 m12\">\n                <h1>404 Page not found</h1>\n            </div>\n            <div class=\"col l8 m12 s12\">\n                <p>\n                    Sorry, but the page you are looking for can't be found. Please go back to the\n                    <a href=\"/\">home page</a>.\n                </p>\n                <img class=\"responsive-img\" src=\"~/Content/Images/notfound.jpg\" alt=\"not found img\">\n            </div>\n        </div>\n    </div>\n</div>","lang":"html"},"strapline":""},{"title":"","body":"<p><strong>Map the NotFound route</strong></p>\n<p>To resolve the request URLs that return the 404 status, map the <em>NotFound</em> route to the <em>NotFoundController</em>'s <em>Index</em> action in the Medio Clinic's <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/RouteConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>RouteConfig.cs</em></a>. The route needs to be registered separately to allow <em>culture-less</em> URLs.</p>\n<p><strong>Add the httpErrors element to handle 404 status code</strong></p>\n<ol>\n  <li>Modify the <em>MedioClinic</em> project's <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Web.config\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Web.config</em></a> file and add 404 handling under the <em>system.webServer</em> node.</li>\n  <li>Use a <em>&lt;remove&gt;</em> element to first clear any potentially inherited IIS setting to resolve 404 status code.</li>\n  <li>Add an <em>&lt;error&gt;</em> element and map the 404 status code attribute to point to the<em> /notfound</em> relative URL path on the website.</li>\n</ol>\n<p>The snippet of the left shows what your <em>Web.cofing</em> setting can look like. Note that the <em>subStatusCode</em> attribute in the <em>&lt;remove&gt;</em> element uses <a href=\"https://docs.microsoft.com/en-us/iis/configuration/system.webserver/httperrors/error\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">its default value</a> and is intentionally declared for the purpose of this training website.&nbsp;</p>\n<p><strong>The \"path\" attribute</strong></p>\n<p>There are two ways you can run your Medio Clinic application to test the error page functionality - the <strong>IISExpress</strong> built in the Visual Studio debug mode, or the <strong>IIS</strong> installed locally. The application you select to test the page determines what the <em>&lt;httpErrors&gt;</em>&nbsp;page's path&nbsp;attribute will look like, e.g.,</p>\n<ul>\n  <li>IISExpress: <em>path = \"notfound\"</em></li>\n  <li>IIS: - <em>path = \"kentico12_medioclinic/notfound\"</em></li>\n</ul>\n<p>If you decide to test your website using the <em>IIS</em>, make sure you have enabled the <em>HTTPErrors </em>module in the <em>Internet Information Services</em>. (You can enable it in the<em>&nbsp;Turn windows features on or off </em>&gt; <em>Internet Information Services</em> &gt;<em> World Wide Web Services </em>&gt;<em> Common HTTP Features </em>&gt; <em>HTTP Errors (enabled)</em>.</p>","code":{"src":"(...)\n        // Maps the Not found route (the route needs to be registered separately to allow culture-less url)\n            routes.MapRoute(\n                \"NotFound\",\n                \"notfound\",\n                new { controller = \"NotFound\", action = \"Index\" }\n            );\n(...)\n\n(...)\n<system.webServer>\n    <httpErrors errorMode=\"Custom\" existingResponse=\"Auto\">\n      <remove statusCode=\"404\" subStatusCode=\"-1\" />\n      <error statusCode=\"404\" path=\"/notfound\" responseMode=\"ExecuteURL\" />\n    </httpErrors>\n(...)","lang":"html"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrativeCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"06d83317-c812-4b66-8ba0-cf7544f586e7","_parentId":"1050fa73-02f4-45da-b10f-0c239eb4da1a","_type":"component","title":"Demo: Adding the Page not found feature","displayTitle":"Demo: Adding the Page not found feature"},{"body":"<p>Congrats on completing another part of the course. You now know what options you have to create a user-friendly error page, and you have built one on your training website.</p>\n<p>Hurry up to the next part of the training where you will learn how you can optimize the performance of your website.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"00b405e8-ed9d-4921-8a20-60a8b0ac0be9","_parentId":"542c406e-dd1a-44c3-af23-f4659e5d48a1","_type":"component","title":"Conclusion","displayTitle":"Conclusion"},{"body":"<p>What you will learn in this section:</p>\n<ul>\n  <li>What options to identify issues and improve performance Kentico provides</li>\n  <li>How to effectively use caching in Kentico MVC</li>\n  <li>What are cache dependencies</li>\n  <li>How to deploy a Kentico website built in MVC development model</li>\n</ul>\n<p>You will work on:</p>\n<ul>\n  <li>Bundling and minification of CSS and JavaScript files</li>\n  <li>Building a custom cache service using Kentico API</li>\n  <li>Adding data caching to a controller action</li>\n  <li>Setting output caching on a controller action</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"bc78e875-a223-4d11-a3af-c112ea872f5b","_parentId":"5d86cae0-1714-4261-987f-54dbda90ff76","_type":"component","title":"Introduction","displayTitle":"Introduction"},{"body":"<p>The performance of a website built with Kentico MVC development model depends on many factors. Besides the number of pages or the quality of code, there are factors related to hardware and environment on which both applications and the shared database are running or the available resources if the server is shared with other applications. It's better to optimize the application before it's deployed live - and runs into number of issues.</p>\n<p>The following list gives you some ideas about what to consider when you build a website in Kentico MVC development model - or when your live application runs into any performance issues.</p>","_items":[{"body":"<p>Website editors can store content in content-only pages, custom tables, or media libraries. Each storage option is designed for a different type of data.</p>\n<p>Find out as much as you can about the client's business requirements so you can organize the content the best possible way. You have already learned about their limitations, however, if you get stuck with defining the optimal website content structure, feel free to refresh your knowledge in <a href=\"https://docs.kentico.com/k12/developing-websites/defining-website-content-structure\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico documentation</a> or gain more insights in the <a href=\"https://devnet.kentico.com/articles/planning-your-data-structure\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Planning Your Site Data Structure</a> article.</p>","title":"Organize website content in the most effective way","_graphic":null},{"body":"<p>The performance problems are often caused by small things which grow into massive issues.</p>\n<p>Besides not using caching (see more about caching later), many of the performance issues are caused by inefficient <strong>SQL queries</strong>.</p>\n<p>One of the most common issues with slow SQL queries comes from cascading the SQL queries into a series of subsequent calls to SQL server.</p>\n<p>For example, when retrieving data for menus, developers tend to get the menu items in the first SQL query. Then they run a second query to return data for their second-level menu items. And to complement data from the second query, they add a third query. As a result, the number of queries grows exponentially - and the database suddenly struggles to answer 1000+ requests.&nbsp;</p>\n<p>Instead of flooding the database with short queries, try joining multiple queries to get data at once into one efficient. The performance of your website will improve.</p>\n<p>Another performance issue is caused by developers who dont limit <strong>the amount of data</strong> they get from the database. Specify the source of the data with hard-coded values, limit the number of rows you retrieve by calling the <em>TopN</em> method.</p>\n<h2>Finding sources of issues</h2>\n<h3>Check the system log</h3>\n<p>The <strong>Event log</strong> application <a href=\"https://docs.kentico.com/k12/developing-websites/troubleshooting-websites/working-with-the-system-event-log\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">logs information about all the events</a> that occur in the Kentico admin interface and the MVC application. You can use the information to identify an unwanted behavior that occurred in the system and get insights to where the problem originated or give you additional details.</p>\n<h3>Use debugging tools in Kentico and the MVC application</h3>\n<p>To debug your SQL queries requested from the live site MVC application, you can use the open-source <a href=\"https://docs.microsoft.com/en-us/aspnet/mvc/overview/performance/profile-and-debug-your-aspnet-mvc-app-with-glimpse\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Glimpse</a> diagnostic tool. To use Glimpse in a Kentico MVC project, you need to install the related NuGet packages (<a href=\"https://www.nuget.org/packages/Kentico.Glimpse/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico.Glimpse</a> and <a href=\"https://www.nuget.org/packages/Glimpse.Mvc5/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Glimpse.Mvc5</a>) and turn <em>Glimpse</em> on. To see information on Glimpse's <em>Kentico SQL</em> tab, you need to <strong>Enable SQL query debug</strong> in the Kentico <strong>Settings</strong> application.</p>\n<p>Find out more about <a href=\"https://docs.kentico.com/k12/developing-websites/troubleshooting-websites/debugging-sql-queries-with-glimpse-on-mvc-sites\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">using Glimpse to debug SQL queries</a> in our documentation. If you are new to Glimpse, you might find Kentico MVP Brian McKeiver's article <a href=\"https://www.mcbeev.com/Blog/January-2018/Why-Kentico-Glimpse-is-a-Must-Have-Tool-for-Kentico-MVC-Developers\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Why Kentico.Glimpse is a Must Have Tool for Kentico MVC Developers</a> useful - or you can check official <a href=\"https://docs.microsoft.com/en-us/aspnet/mvc/overview/performance/profile-and-debug-your-aspnet-mvc-app-with-glimpse\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Microsoft MVC documentation</a>.</p>\n<p><a href=\"https://docs.microsoft.com/en-us/sql/tools/sql-server-profiler/sql-server-profiler?view=sql-server-2017\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">SQL Server Profiler</a> is another option you can use to see a number of executed queries, what the queries looked like, how much time it took to execute the queries - and what other queries were called within the context of the request. However, to get the optimal information, you'd have to filter system queries ran by Kentico API.</p>","title":" Check your code in the MVC application","_graphic":null},{"body":"<p>Loading files from the database is a demanding operation. If your site stores a large number of files, we recommend storing the files in the file system.&nbsp;</p>\n<p>To improve loading time for <a href=\"https://docs.kentico.com/k12/developing-websites/retrieving-content-in-mvc-applications/displaying-content-from-media-libraries#Displayingcontentfrommedialibraries-GettingmedialibraryfileURLs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">files stored in the media libraries</a>, use the <em>DirectUrl</em> property. However, if the project's business requirements demand that the system needs to check permissions before it displays the file to the user, you need to use the <em>PermanentUrl</em> property to get the file's URL.</p>","title":"Configure the file storage","_graphic":null},{"body":"<p>Scheduled tasks run in the .NET application domain that hosts the administration UI (unless you use the Windows service for select tasks), and you can use the <a href=\"https://docs.kentico.com/k12/configuring-kentico/scheduling-tasks\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Scheduled tasks</a> application to configure how to the system executes automatic tasks. If you run both the administration interface and the MVC application on one machine, you can slightly improve the website's performance by disabling all unnecessary tasks or increasing their execution interval.</p>","title":"Limit scheduled tasks","_graphic":null},{"body":"<p>Caching allows you to store previously requested data in the memory and serve a copy of this data to other users' requests. When set correctly, caching can significantly improve the performance of your website.</p>\n<p>Cached data load more quickly because the memory which stores the cache tends to be faster than other storage spaces, such as database or file system. Also, caching reduces the number of page processing operations, such as retrieving data from the database or performing of various calculations.</p>\n<h2>Cache keys</h2>\n<p>Kentico built-in caching mechanism works primarily on the server side. The system saves cache items into the cache in the form of <strong>cache keys</strong>.</p>\n<p><em>Cache keys</em> have unique names which exactly identify the cached content. Each key stores the cached data and other information, such as the expiration time or <em>dependencies</em>.</p>\n<h2>Cache dependencies</h2>\n<p>By default, the cache is saved for the set interval. The system flushes the cache when the given interval expires.</p>\n<p>In Kentico, you can set relationships between the cache items to instruct the system to delete them together. Cache dependencies allow your application to automatically clear cached data when related objects in the admin interface or the MVC application are modified.&nbsp;</p>\n<p>To create dependencies between objects, Kentico uses <strong>dummy cache keys</strong>. The <em>dummy keys</em> are cache object items without any data. They serve to establish relationships between objects (or group of objects). When an object is modified in the database, the system uses the corresponding dummy keys to find relations. As a result, the system clears all cache items which are defined as related to the modified object.</p>\n<p>For example, your MVC website lists news articles on the website. The dummy key <em>\"nodes|MySite|MySite.Article|all\"</em> is used any time editors add, update or delete any of the site's articles. The example uses minimal cache dependencies, see how you can <a href=\"https://docs.kentico.com/k12/configuring-kentico/configuring-caching/setting-cache-dependencies\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">configure more complex cache dependencies</a> in Kentico documentation.</p>\n<p>Find out more on how to improve the performance of the MVC site using data caching and caching controller actions below.</p>","title":"Configure caching","_graphic":null},{"body":"<p>If there are longer periods of inactivity on your website, your users may experience longer delays when they first open the site. Consider setting up the <strong>Idle time-out</strong> property of your IIS application pool to higher values.</p>","title":"Increase the application pool Idle Time-out","_graphic":null},{"body":"<p>When the performance of your website is still unsatisfactory after you have taken every possible step, consider upgrading the hosting environment. You can either <strong>scale out</strong> and add more servers that will host the same content into your web farm, or <strong>scale up</strong> and upgrade your hardware.</p>","title":"Scale the hosting environment","_graphic":null}],"instruction":"","_layout":"full","_component":"accordion","_pageLevelProgress":{"_isEnabled":false},"_isOptional":true,"_classes":"","_id":"d3a2d667-938d-4cff-8e32-fa862190080e","_parentId":"c25cc366-6b14-4787-98cf-bffc078925a8","_type":"component","title":"Theory: Optimizing website performance","displayTitle":"Theory: Optimizing website performance"},{"body":"<p>The administration UI and the MVC live site run in a web farm environment which syncs cache contents between the instances. The web farm ensures that the MVC application invalidates cache items according to the content or setting changes made in the application and vice versa.</p>\n<p>To improve the performance of your website, we recommend that you cache data retrieved from the shared database as well as the output of the controller actions in your MVC application.</p>\n<h2>Caching data in MVC applications</h2>\n<p>We recommend you to cache data queried from the database, namely if the data is frequently accessed. For example, you may want to cache data for individual pages, forms, and any other data stored in Kentico database.</p>\n<p>There are many approaches you can take to handle caching.</p>\n<p>For example, you can cache data in individual repositories that use the <a href=\"https://docs.kentico.com/k12/developing-websites/generating-classes-for-kentico-objects\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">providers</a> you generated for your content-only pages. To cache data in your code, you can use the <strong>CacheHelper.Cache</strong> method and make use of <a href=\"https://docs.kentico.com/k12/configuring-kentico/configuring-caching/setting-cache-dependencies\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">cache dependencies</a>.</p>\n<p>We recommend you to always generate cache keys with names that include all the parameters you used to retrieve the data from the database to ensure consistent browsing experience.&nbsp;</p>\n<p>For example, when the visitor switches to a new culture, you don't want them to see cached articles in the old culture. To prevent the inconsistency, you can include a culture code variable in the cache key for the page data.</p>\n<pre><code class=\"language-csharp\">using System;\nusing System.Linq;\n\nusing CMS.Helpers;\nusing CMS.SiteProvider;\n\n(...)\n\npublic Article GetArticle(int nodeGUID)\n{\n    // Defines site culture and site name\n    string culture = \"en-us\";\n    string siteName = SiteContext.CurrentSiteName;\n    \n    // Loads the data for the article in the specified culture on the specified site\n    Func&lt;Article&gt; dataLoadMethod = () =&gt; ArticleProvider.GetArticle(nodeGUID, culture, siteName)\n                                                        .TopN(1)\n                                                        .FirstOrDefault();\n    // Creates a new instance of the CacheSettings object with the 10-minute expiry limit for the given article\n    var cacheSettings = new CacheSettings(10, \"mysite|data|article\", nodeGUID, culture, siteName)\n    {\n        GetCacheDependency = () =&gt;\n        {\n            // Creates cache dependencies. The cache clears the data when any culture version of the specified article is modified in Kentico\n            string dependencyCacheKey = String.Format(\"nodeGUID|{0}|{1}\", siteName, nodeGUID);\n            return CacheHelper.GetCacheDependency(dependencyCacheKey);\n        }\n    };\n\n    return CacheHelper.Cache(dataLoadMethod, cacheSettings);\n}</code></pre>\n<p>To name another approach, you can abstract from the Kentico-generated classes and create a service to handle caching separately. You can see this approach used in the <em>MedioClinic</em> project. It is described below.</p>\n<p>Finally, you can introduce an even much higher level of abstraction, and decorate individual repositories with code that caches results of specified methods. You can see this approach used in our sample <strong>Dancing Goat </strong>MVC website that can be deployed to IIS via the Kentico installer.</p>\n<h2>Caching controller action output in MVC applications</h2>\n<p>Caching the output of repositories may significantly improve time spent on data retrieval. However, you may also save time thats spent with processing of other routines. Therefore, you can cache the entire output of individual controller actions using the standard&nbsp;<a href=\"https://docs.microsoft.com/en-us/aspnet/mvc/overview/older-versions-1/controllers-and-routing/improving-performance-with-output-caching-cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">ASP.NET output caching</a>. Output caching can significantly increase your website performance, especially if you cache the output of all possible controller actions, such as returned views that are frequently requested.</p>\n<p>Use the&nbsp;<a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.web.mvc.outputcacheattribute\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">OutputCache</a>&nbsp;attribute to mark the action result methods you want to cache. The <em>OutputCache</em> attribute allows you to set cache duration in seconds and adjust some additional properties.</p>\n<p>When storing the output cache on the server (the&nbsp;<em>OutputCache</em>&nbsp;attribute's&nbsp;<em>Location</em>&nbsp;property is set to&nbsp;<em>Server</em>), you can define cache dependencies to tailor your implementation to fit various scenarios that use both static and dynamic content. You can add the dependencies in individual action methods using the <strong>HttpContext.Response.AddCacheItemDependency</strong>&nbsp;method. Because controller actions can be called in situations in which the dummy cache items have not yet been created, ensure that the dummy cache items exist by calling <em>CacheHelper.EnsureDummyKey()</em>. The dependencies may span across both ASP.NET output data and Kentico data because both are stored in the same <em>System.Web.Caching.Cache </em>container object.</p>\n<p>In the following snippet, you can see an implementation of the <em>OutputCache</em> attribute that makes use of Kentico<em> dummy cache key items</em>. (The cache is flushed when any of the articles the method works with is modified, deleted or a new article is created. You can find more information on how to <a href=\"https://docs.kentico.com/k12/configuring-kentico/configuring-caching/setting-cache-dependencies\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">configure cache dependencies</a> for your scenarios in Kentico documentation.)</p>\n<pre><code class=\"language-csharp\">using System;\nusing System.Web.UI;\nusing System.Web.Mvc;\n\nusing CMS.Helpers;\n(...)\n\n// Sets the output cache to 600 seconds for all items and stores the cached data on server\n[OutputCache(Duration=600, VaryByParam=\"none\", Location = OutputCacheLocation.Server)]\npublic ActionResult Index()\n{\n    var articles = mArticleRepository.GetArticles();\n\n    // Sets cache dependencies. The system clears the cache when any article is modified in Kentico.\n    string dependencyCacheKey = String.Format(\"nodes|mvcsite|{0}|all\", Article.ClassName.ToLowerInvariant());\n\n    // Ensures that the dummy key exists\n    CacheHelper.EnsureDummyKey(dependencyCacheKey);\n\n   // Adds the cache dependency key \n    HttpContext.Response.AddCacheItemDependency(dependencyCacheKey);\n\n    return View(articles);\n}</code></pre>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"813a8de2-8fa4-4d30-ab14-c49d4b68516a","_parentId":"c25cc366-6b14-4787-98cf-bffc078925a8","_type":"component","title":"Caching in MVC sites","displayTitle":"Caching in MVC sites"},{"body":"<p>The <em>MedioClinic </em>project has examples of both data and controller action output caching. It abstracts from Kentico API and uses a custom <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/Cache/CacheService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CacheService</em></a><em> </em>class. The service has a <em>Cache</em> method which caches results using the <em>CMS.Helpers.CacheHelper </em>class.</p>\n<p>The service also has a <em>GetNodesCacheDependencyKey</em> method. The method returns dummy cache keys for collections of pages in the content tree. The <em>cache keys</em> always contain the site name retrieved via <em>SiteContextService.SiteName</em>, the class name of a given page type class and a dependency type flag.</p>\n<p>The second method <em>GetNodeCacheDependencyKey</em> returns a dummy key for a given single page identified by its <em>nodeGUID</em>.</p>\n<p>The <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/DoctorsController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorsController's Index action</em></a> then calls the <em>CacheService.Cache</em> method and passes the <em>GetDoctorSection</em> method delegate to fetch the data in case there isn't any in the cache. The <em>Cache</em> method also takes other parameters, e.g., the cache item key (a name) and the dependency key. The latter one is created by the <em>GetNodesCacheDependencyKey</em> method mentioned above.</p>\n<p>The <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/DoctorsController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorsController's Details action</em></a> shows how you can set the <em>OutputCache</em> for any page identified by its <em>nodeGUID</em>. The injected <em>CacheService.SetOutputCacheDependency</em> method sets cache dependency on a single page based on its <em>nodeGUID</em>.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"96336405-75b6-47b5-9e89-e2f6b570bd33","_parentId":"c25cc366-6b14-4787-98cf-bffc078925a8","_type":"component","title":"Caching on the Medio Clinic website","displayTitle":"Caching on the Medio Clinic website"},{"body":"<p>Many modern websites achieve their stunning design and smooth behavior by applying advanced CSS styles and running many scripts. The design-related instructions are stored in CSS and JavaScript files which - depending on the complexity of the behavior - can grow into large numbers of files of significant sizes. However, the size and number of resources requested by client browsers directly influence performance when rendering the website's pages.</p>\n<p>We recommend that you use <a href=\"https://docs.microsoft.com/en-us/aspnet/mvc/overview/performance/bundling-and-minification\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">bundling and minification</a> in your MVC application which will help improve request load time.&nbsp;</p>\n<p>In short, <strong>bundling</strong> combines multiple files of the same type, e.g., <em>.css</em> or <em>.js</em>, into a bundle which the client's browser requests as one file. <strong>Minification</strong> removes white spaces, comments and renames variables to their shortest possible name in text-based files. The process removes all the excess characters which reduces the size of the files and improves their load time while keeping the functionality untouched. Both features are built into the ASP.NET MVC 5 framework and require almost-to-none effort to implement.</p>\n<p>You can see a sample implementation of both of the features on the training website.&nbsp;</p>\n<p>The <em>MedioClinic </em>project bundles both the CSS and the JS files. The CSS files are stored in <a href=\"https://github.com/Kentico/training-kentico-k12/tree/master/MedioClinic/Content/Css/Master\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Content/Css/Master folders</em></a> and they are being reference from the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Views/Shared/_Layout.cshtml\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Layout view</em></a> by the <em>@Styles.Render(\"~/bundles/master-css\") </em>statement in the <em>head</em> tag. The scripts are stored in the <a href=\"https://github.com/Kentico/training-kentico-k12/tree/master/MedioClinic/Scripts/Master\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Scripts/Master folders</em></a> and invoked using <em>@Scripts.Render(\"~/bundles/master-scripts\") </em>at the end of the layout's HTML markup (which is a recommended location for scripts). For the demo purpose, only the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Content/Css/Master/materialize.min.css\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>materialize.min.css</em></a> and <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Scripts/Master/materialize.min.js\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>materialize.min.js</em></a> files are minified. The <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/App_Start/BundleConfig.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>BundleConfig</em></a> class defines directories of the resources and is registered in the Medio Clinic's <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Global.asax.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Application_Start method</em></a>.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"8250e8d2-5837-4bd7-85b0-27e12d6c3d1b","_parentId":"c25cc366-6b14-4787-98cf-bffc078925a8","_type":"component","title":"Bundling and minification on Medio Clinic","displayTitle":"Bundling and minification on Medio Clinic"},{"body":"<p>When you finish developing and optimizing your MVC website, you will deploy both the admin UI and the MVC application to a production environment.</p>\n<h2>Deploying the project files</h2>\n<p>There are several possible ways of deploying the project files from your local environment to the production server. You can use the Visual Studio Publish function, or you can copy the project files directly to the hosting server over FTP.</p>\n<p>No matter how you deploy the website, make sure that both applications are correctly configured in the hosting server's IIS. You can find more information about <a href=\"https://docs.kentico.com/k12/installation/manually-configuring-kentico-applications-in-iis\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">configuring Kentico application in IIS</a> in Kentico documentation.&nbsp;</p>\n<h2>Deploying the database</h2>\n<p>To deploy the database, there are two ways you can take.&nbsp;</p>\n<p>You can restore the database backup on the hosting SQL server (and update the connection strings for both projects in the Web.config file). Or, you can install a fresh database on your hosting SQL server and use Kentico <em>Export/Import</em> feature to transfer the site. You can find a <a href=\"https://docs.kentico.com/k12/deploying-websites/deploying-mvc-sites\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">detailed description of how to transfer the website</a> in the Kentico documentation.</p>\n<p>To prevent any future issues, you might want to check the Sites application and make sure the domain, presentation URL and any domain aliases are configured correctly for the production domain.</p>\n<h2>Running MVC website on Microsoft Azure</h2>\n<p>Both the administration interface and the MVC application can run in Azure. We recommend that you deploy the application to Azure Web Apps using two different Azure App Service hosting plans - one for the MVC application, and another for the administration application.</p>\n<p>There are two reasons why we recommend running the MVC site on two services.</p>\n<ol>\n  <li>Two hosting services are required for the web farm synchronization to run correctly by default. (You can <a href=\"https://docs.kentico.com/k12/configuring-kentico/setting-up-web-farms/configuring-web-farm-servers#Configuringwebfarmservers-Configuringwebfarmsmanually\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">configure the web farm servers' names manually</a> if you decide to run the website in a shared hosting space.)</li>\n  <li>The two service plans allow you to scale applications independently. In most cases, the MVC live site will receive much higher traffic that the administration interface. Therefore, both sites will have different requirements for performance.</li>\n</ol>\n<p>To deploy both the admin interface and the MVC application, you can follow Kentico documentation:</p>\n<ol>\n  <li><a href=\"https://docs.kentico.com/k12/deploying-websites/running-kentico-on-microsoft-azure/running-kentico-in-azure-web-apps/deploying-existing-kentico-projects-to-azure-web-apps#DeployingexistingKenticoprojectstoAzureWebApps-Part2-CreatingAzureWebAppsfromVisualStudio\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Create an Azure Web App service from Visual Studio</a></li>\n  <li><a href=\"https://docs.kentico.com/k12/deploying-websites/running-kentico-on-microsoft-azure/running-kentico-in-azure-web-apps/deploying-existing-kentico-projects-to-azure-web-apps#DeployingexistingKenticoprojectstoAzureWebApps-Part3-DeployingprojectstoAzureWebApps\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Deploy the project to Azure Web Apps</a></li>\n</ol>\n<p>&nbsp;Don't forget to <a href=\"https://blogs.msdn.microsoft.com/tomholl/2015/04/06/changing-the-server-time-zone-on-azure-web-apps/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">configure both applications to the same server time zone</a>.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"1f6c51d3-78b6-40f9-a511-fa8b349fadf0","_parentId":"c25cc366-6b14-4787-98cf-bffc078925a8","_type":"component","title":"Deploying MVC sites","displayTitle":"Deploying MVC sites"},{"body":"<p>The Kentico staging feature allows you to easily transfer changes made to pages (or other objects) from a Kentico instance on a one server (dedicated solely to editing) to a Kentico instance on another server (production). Staging is particularly useful when you need to synchronize multiple environments during development, for example: <em>Development</em> -&gt; <em>Testing</em> -&gt; <em>Editing (staging)</em> -&gt; <em>Live (production).</em></p>\n<p>When using the Kentico MVC development model, every staging instance consists of the Kentico administration, the MVC application, and the shared database. For the given example of environments in, e.g., the <em>Editing </em>environment, you will be running an instance of Kentico administration, the MVC application, and the SQL Server database.</p>\n<p>You can find detailed information on how to configure the <a href=\"https://docs.kentico.com/k12/deploying-websites/content-staging/configuring-content-staging\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">one-directional</a> or <a href=\"https://docs.kentico.com/k12/deploying-websites/content-staging/bi-directional-content-staging\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">bi-directional</a> content staging service for your environment in Kentico documentation.</p>\n<div class=\"infobox note\"><h3>One-directional vs. bi-directional</h3>\n<p>While the <em>one-directional </em>setup consists of exclusive source- and target servers, the <em>bi-directional </em>configuration removes the exclusivity of the source server, and allows you to make changes also on the other servers. The changes are then transferred to the rest of the servers.</p></div>\n<h2>Staging large files</h2>\n<p>Kentico allows you to limit the size of files that are synchronized by staging. You can limit the size of pages attachments as well as files stored in the media libraries.</p>\n<p>Setting the size limit prevents the system from using too many resources when it synchronizes the large files. The system logs only staging tasks if editors change the files in the Kentico administration interface. If they make changes directly, e.g., using an FTP, Kentico doesnt log the tasks.</p>\n<p>Find out more about <a href=\"https://docs.kentico.com/k12/deploying-websites/content-staging/staging-large-files\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">limiting the size of the files for staging tasks</a> in Kentico documentation.</p>\n<h2>Authenticating user in staging</h2>\n<p>Kentico staging service provides you with two options of authentication - username and password authentication or authentication using <em>X.509</em> certificates. The X.509 setup is a bit slower and more difficult to configure, but on the other hand, it provides more security compared to the traditional user/password authentication. You can either use the sample private and client certificates in the Kentico application or generate and install your certificates. You can find out more about <a href=\"https://docs.kentico.com/k12/deploying-websites/content-staging/using-x-509-authentication\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">using the X.509 authentication</a> in Kentico documentation.&nbsp;</p>\n<h2>Access permissions in content staging</h2>\n<p>You can control access to staging actions by configuring user roles permissions within Kentico security model. The permission matrix allows you to grant the following permissions:</p>\n<ul>\n  <li><strong>Manage servers</strong>&nbsp; allows members of the roles to manage target server configurations on the&nbsp;<strong>Servers</strong> tab in the&nbsp;<strong>Staging</strong>&nbsp;application.</li>\n  <li><strong>Manage all tasks</strong>&nbsp; allows access to the&nbsp;<strong>All tasks</strong>&nbsp;tab of the&nbsp;<strong>Staging&nbsp;</strong>application, and synchronization/management of synchronization tasks.</li>\n  <li><strong>Manage page tasks</strong>&nbsp; allows access to the&nbsp;<strong>Pages</strong>&nbsp;tab of the&nbsp;<strong>Staging</strong>&nbsp;application, and synchronization/management of synchronization tasks.</li>\n  <li><strong>Manage object tasks</strong>&nbsp; allows access to the&nbsp;<strong>Objects </strong>tab of the&nbsp;<strong>Staging&nbsp;</strong>application, and synchronization/management of synchronization tasks.</li>\n  <li><strong>Manage data tasks</strong>&nbsp; allows access to the&nbsp;<strong>Data</strong>&nbsp;tab of the&nbsp;<strong>Staging</strong>&nbsp;application, and synchronization/management of synchronization tasks.</li>\n  <li><strong>Manage task groups</strong>&nbsp; allows members of the roles to create, edit, and delete&nbsp;<a href=\"https://docs.kentico.com/k12/deploying-websites/content-staging/synchronizing-the-content\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">staging task groups</a> (globally for all sites). The settings affects the&nbsp;<strong>Task</strong> <strong>groups&nbsp;</strong>tab of the&nbsp;<strong>Staging&nbsp;</strong>application and group creation via the dialog in the administration interface header. The&nbsp;<strong>Manage </strong>task <strong>groups&nbsp;</strong>permission is NOT required to switch to the context of existing task groups.</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"cb7a060f-7de5-4e4f-a62e-a12ecfbaa9e5","_parentId":"c25cc366-6b14-4787-98cf-bffc078925a8","_type":"component","title":"Content staging on MVC sites","displayTitle":"Content staging on MVC sites"},{"body":"<p>To improve the performance of your Medio Clinic website, make sure that your implementation matches the following criteria:</p>\n<ul>\n  <li>The website bundles both CSS and JS files using recommend MVC best practices for registering the file and defining a location of the resource files.</li>\n  <li>At least the <em>DoctorsController Index</em> action caches the data retrieved from the shared database. The implementation makes use of Kentico cache dependency feature which allows flushing the cache if there are any changes in an object with defined relationships.</li>\n  <li>At least the <em>DoctorsController Details</em> action caches the output of the controller action to the server memory for, e.g., 3600 seconds and depends on the object <em>nodeGUID</em>. A cache dependency ensures that the system invalidates the cache when a doctor page (or any other object in case of other controller actions) is deleted or edited.</li>\n</ul>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"47e1bb6f-3e15-4c17-8f4c-015584d1147c","_parentId":"b30760e9-cd69-4164-97b4-33bff3c49148","_type":"component","title":"Task: Improving performance of the website","displayTitle":"Task: Improving performance of the website"},{"body":"<p>The following demo overviews steps to implement bundling and minification to Medio Clinic website. Roll up your sleeves and code along!</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p><em>Bundle </em>is a group of physical files which load over one HTTP request.&nbsp;</p>\n<ol>\n  <li>If you haven't arranged them in one of the previous steps, organize your <em>.css</em> and <em>.js</em> files in a way that your system can bundle them together. Store them in <em>Content/Css/Master</em> and <em>Script/Master</em>.</li>\n</ol>\n<figure data-asset-id=\"033b9338-8481-4bbc-b1bf-020aa0ea7eb9\" data-image-id=\"033b9338-8481-4bbc-b1bf-020aa0ea7eb9\"><img src=\"https://assets-eu-01.kc-usercontent.com:443/63117da1-007f-01dd-86eb-23e8353ac375/318c3da2-987f-433f-a8df-6114876a1db3/mvc-content-design-resources.png\" data-asset-id=\"033b9338-8481-4bbc-b1bf-020aa0ea7eb9\" data-image-id=\"033b9338-8481-4bbc-b1bf-020aa0ea7eb9\" alt=\"\"></figure>\n<p><strong>Update your MVC application's code</strong></p>\n<ol>\n  <li>Add the <em>BundleConfig</em> configuration class to the <em>App_Start</em> <em>folder </em>and create <em>ScriptBundle</em> and &nbsp;<em>StyleBundle</em> objects. Don't forget to include locations of their source files, their properties.</li>\n  <li>Enable the <em>BundleTable.EnableOptimizations</em> property.</li>\n</ol>","code":{"src":"(...)\nnamespace MedioClinic\n{\n    public class BundleConfig\n    {\n        public static void RegisterBundles(BundleCollection bundles)\n        {\n            bundles.Add(new ScriptBundle(\"~/bundles/master-scripts\")\n                .IncludeDirectory(\"~/Scripts/Master\", \"*.js\", true)\n            );\n\n            bundles.Add(new StyleBundle(\"~/bundles/master-css\")\n                .IncludeDirectory(\"~/Content/Css/Master\", \"*.css\", true)\n            );\n\n            // Enables bundling and minification of bundle references\n            BundleTable.EnableOptimizations = true;\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<ol>\n  <li>Register the bundles in the <em>Application_Start</em> method and update references in the shared <em>Layout</em> view.</li>\n  <li>Call @Styles.Render and @Scripts.Render methods instead of the hard-coded values you copied from the index.html file.</li>\n</ol>","code":{"src":"(...)\n<!-- CSS  -->\n    <link href=\"https://fonts.googleapis.com/css?family=Roboto:300,400,500\" rel=\"stylesheet\">\n    <link rel=\"stylesheet\" href=\"https://use.fontawesome.com/releases/v5.1.0/css/all.css\" integrity=\"sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt\"\n          crossorigin=\"anonymous\">\n    @Styles.Render(\"~/bundles/master-css\")\n</head>\n\n(...)\n</footer>\n    <!-- Scripts -->\n    @Scripts.Render(\"~/bundles/master-scripts\")\n    <!-- Additional (view specific) scripts-->\n    @RenderSection(\"scripts\", false)\n</body>","lang":"html"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrativeCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"cf2bae5c-db26-4be5-8998-2efe00a6ace9","_parentId":"e8b847ae-1065-45e0-9c9e-f6e39ef65299","_type":"component","title":"Demo: Bundling and minification","displayTitle":"Demo: Bundling and minification"},{"body":"<p>The following demo shows how the <em>MedioClinic </em>project implements both data and output caching in basic scenarios which work with limited amounts of data. Feel free to use a different approach to complete the task for this part of the course - or saddle up and code along!</p>","_setCompletionOn":"inview","_hasNavigationInTextArea":false,"mobileInstruction":"Select the arrows followed by the plus icon to find out more.","_items":[{"title":"","body":"<p>The <em>MedioClinic </em>project uses services and repositories to separate Kentico code from the MVC application code. You want to cache all the data you retrieve for the top part of the <em>Doctors</em> listing page from the database (the <em>Header</em> property of <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Dto/Doctors/DoctorSectionDto.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorSectionDto</em></a>).</p>\n<p>To cache the data from the <em>Doctors</em> page in admin UI (and set the system to invalidate the cache any time the related objects are changed), you can create a service which defines the <em>Cache</em> method.</p>\n<p>The <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/Cache/CacheService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>CacheService</em></a><em> </em>inherits members from <em>BaseService</em> and implements <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/Cache/ICacheService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ICacheService</em></a> interface.</p>\n<p>The interface defines the <em>GetNodesCacheDependencyKey</em> method to get the cache dependency key using two parameters - the class name of the page type and <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/Cache/CacheDependencyType.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>a cache dependency type enum value</em></a>. Implementation of the <em>GetNodesCacheDependencyKey</em> method returns the <em>dependency key</em> (dummy cache item) with all the necessary parameters to ensure that the website provides consistent experience - its <em>name</em>, <em>site name</em>, <em>the object type</em>, and <em>its values</em>.</p>\n<p>For caching of data, the <em>ICacheService</em> interface defines the <em>Cache</em> method. The implementation of the method in the <em>CacheService</em> class wraps <a href=\"http://devnet.kentico.com/docs/12_0/api/html/M_CMS_Helpers_CacheHelper_Cache__1.htm\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">CMS.Helpers.CacheHelper.Cache method</a> in Kentico API. In one call, the custom method returns the <em>cacheSettings</em> with the passed parameters (the<em> type of the cached data</em>, <em>duration</em> of the cache and the <em>cache item name</em>) and the <em>dependency key item</em>.</p>","code":{"src":"(...)\nnamespace Business.Services.Cache\n{\n    public class CacheService : BaseService, ICacheService\n    {\n        public ISiteContextService SiteContextService { get; }\n\n        // Injects a service which holds the site name and current culture code name\n        public CacheService(ISiteContextService siteContextService)\n        {\n            SiteContextService = siteContextService;\n        }\n\n        // Returns a dummy cache key for pages (\"nodes\") in the content tree\n        // \"nodes|<site name>|<generated class name>|< type of cached data >\"\n        // which is touched when pages are modified\n        public string GetNodesCacheDependencyKey(string className, CacheDependencyType dependencyType)\n        {\n            return $\"nodes|{SiteContextService.SiteName}|{className}|{dependencyType}\".ToLowerInvariant();\n        }\n\n       (...)\n\n        public TData Cache<TData>(Func<TData> dataLoadMethod, int cacheForMinutes, string cacheItemName, string cacheDependencyKey) \n        {\n            var cacheSettings = new CacheSettings(cacheForMinutes, cacheItemName, SiteContextService.SiteName, SiteContextService.CurrentSiteCulture)\n            {\n                GetCacheDependency = () => CacheHelper.GetCacheDependency(cacheDependencyKey.ToLowerInvariant())\n            };\n            return CacheHelper.Cache(dataLoadMethod, cacheSettings);\n        }\n    }\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Call the custom <em>CacheService.Cache</em> method from the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/DoctorsController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorsController's</em></a><em> Index</em> action to retrieve the data into the <em>DoctorSectionDto, </em>cache it<em> </em>for 60 minutes, name the cache item, and set the cache dependency key.</p>","code":{"src":"(...)\npublic ActionResult Index()\n        {\n            var doctorSection = Dependencies.CacheService.Cache(\n                () => DoctorSectionRepository.GetDoctorSection(), // Gets data for the DoctorSection if there isn't any cached data (data was invalidated or cache expired)\n                60, // Sets caching of data to 60 minutes\n                $\"{nameof(DoctorsController)}|{nameof(Index)}|{nameof(DoctorSectionDto)}\", // cached data identifier\n                Dependencies.CacheService.GetNodesCacheDependencyKey(Doctor.CLASS_NAME, CacheDependencyType.All) // cache dependencies\n                );\n(...)\n}","lang":"csharp"},"strapline":""},{"title":"","body":"<p>You want to cache the results of the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/DoctorsController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorsController</em></a> <em>Details </em>action (the individual <em>Doctor </em>pages) in the server memory for 60 minutes. &nbsp;At the same time, you also want to flush the cache if editors modify any <em>Doctor</em> page in the content tree. As the contents of the detail page don't depend on that many factors, you want to use the ASP.NET output cache.</p>\n<ol>\n  <li>To set up the relationships, define and <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/Business/Services/Cache/CacheService.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>implement GetNodeCacheDependencyKey method</em></a> which returns the cache key with parameters like the site name or the <em>nodeGUID</em> of the given page.&nbsp;</li>\n  <li>Implement the <em>SetNodeCacheDependencyKey</em> method which takes the <em>nodeGUID</em> of the page in the content tree.</li>\n  <li>Then, create the <em>SetOutputCacheDependency </em>method that gets the dependency key, makes sure it exists in the cache (by calling <em>CacheHelper.EnsureDummyKey()</em>), and then sets the dependency of the current response accordingly.</li>\n</ol>\n<p>The implemented feature now flushes the cache whenever there is a change to an item in the content tree that matches the values specified in the dependency key.</p>","code":{"src":"(...)\n        public string GetNodeCacheDependencyKey(Guid nodeGuid)\n        {\n            return $\"nodeguid|{SiteContextService.SiteName}|{nodeGuid}\".ToLowerInvariant();\n        }\n\n        public void SetOutputCacheDependency(Guid nodeGuid)\n        {\n            var dependencyCacheKey = GetNodeCacheDependencyKey(nodeGuid);\n\n            // Ensures that the dummy key cache item exists\n            CacheHelper.EnsureDummyKey(dependencyCacheKey);\n\n            // Sets cache dependency to clear the cache when there is any change to node with given GUID in Kentico\n            HttpContext.Current.Response.AddCacheItemDependency(dependencyCacheKey);\n        }\n(...)","lang":"csharp"},"strapline":""},{"title":"","body":"<p>Decorate the <a href=\"https://github.com/Kentico/training-kentico-k12/blob/master/MedioClinic/Controllers/DoctorsController.cs\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\"><em>DoctorsController Detail action</em></a> with the <em>OutputCache</em> attribute.</p>\n<ol>\n  <li>Set the output cache duration to 3600 seconds, make separate cache items based on the <em>nodeGuid</em> argument, and store the cached output on the server.</li>\n  <li>To set the dependency on the cache item, call the <em>CacheService.SetOutputCacheDependency</em> method with the <em>nodeGuid</em> as the method's argument.</li>\n</ol>\n<p>The implemented feature now stores the controller output until the cache expires or until editors modify the doctor object.</p>","code":{"src":"[OutputCache(Duration = 3600, VaryByParam = \"nodeGuid\", Location = OutputCacheLocation.Server)]\n\n        public ActionResult Detail(Guid nodeGuid, string nodeAlias)\n        {\n            var doctor = DoctorRepository.GetDoctor(nodeGuid);\n\n            if (doctor == null)\n            {\n                return HttpNotFound();\n            }\n\n            // Sets cache dependency on single page based on NodeGUID\n            // System clears the cache when given doctor is deleted or edited in Kentico\n            Dependencies.CacheService.SetOutputCacheDependency(nodeGuid);\n\n            var model = GetPageViewModel(new DoctorDetailViewModel()\n            {\n                Doctor = doctor\n            }, doctor.FullName);\n\n            return View(model);\n        }\n    }","lang":"csharp"},"strapline":""}],"instruction":"","_layout":"full","_component":"narrativeCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"efd129e0-a31b-4f76-a20f-8d51472141fa","_parentId":"e8b847ae-1065-45e0-9c9e-f6e39ef65299","_type":"component","title":"Demo: Implementing caching","displayTitle":"Demo: Implementing caching"},{"body":"<p>Congratulations on completing last part of the <em>Kentico MVC - Essentials</em> module!</p>\n<p>You have learned about caching and other means you can use to improve the performance of Kentico website. You know which tools you can use to identify issues on your website. And you have learned a basic overview of what steps you need to take to deploy your site.</p>\n<p>Your training website is now caching outputs from the <em>Details</em> action and the retrieved data from the database. In the last part of this module, you will learn about where you can continue learning about Kentico MVC!</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"3127e566-21b9-4ae2-85bc-5c9fbc7f2da5","_parentId":"d55d0c5a-d22c-48dd-b2ae-61ef83c3c148","_type":"component","title":"Conclusion","displayTitle":"Conclusion"},{"body":"<p>Congratulations on passing the first module of the Kentico MVC for Developers!</p>\n<p>You will automatically receive a <em>Certificate of Course Completion</em> after you submit <a href=\"https://learn.with.kentico.com/unit/viewtestsurvey/id:4793,mode:survey\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">the course feedback</a>. Thank you for letting us know what you think about the training course!</p>\n<h2>What are the next steps?</h2>\n<p>There are many resources you can turn to if you need help with your Kentico MVC implementation.</p>\n<ol>\n  <li>Read the <a href=\"https://docs.kentico.com/k12\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico documentation</a> first.</li>\n  <li>Install and investigate the K12 Dancing Goat MVC sample site (or check the <a href=\"https://github.com/Kentico/Mvc\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">K11 Dancing Goat MVC sample site</a> on GitHub) to find out how to implement online marketing or e-commerce functionality to your website.</li>\n  <li>Search <a href=\"https://devnet.kentico.com/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico DevNet community</a> or <a href=\"https://stackoverflow.com/questions/tagged/kentico\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico StackOverflow</a> if you haven't found what you needed.</li>\n  <li>Contact <a href=\"https://www.kentico.com/support/technical-support\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico support</a>. (Kentico support will help you answer general questions or resolve problems regarding the core platform.)</li>\n  <li>Work with <a href=\"https://www.kentico.com/services/consulting/overview\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico consulting</a> if you have questions or problems regarding your customization.</li>\n</ol>\n<h2>Boost you Kentico developer skills</h2>\n<p>You can continue learning in the <a href=\"http://www.kentico.com/services/training/overview/developer/advanced-developer\">Kentico Advanced Developer</a> course where you can get more experience with extending Kentico administration platform.</p>\n<p>You will learn about development methods and processes such as creating a custom module, creating custom scheduled tasks or implement custom global events. After completing the <em>Kentico Customization for Developers</em> course, you will be entitled to one free shot at the <a href=\"http://www.kentico.com/services/training/developer-certification\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico Certified Developer Exam</a>.</p>\n<h2>Learn how to deliver projects with Kentico</h2>\n<p>The <a href=\"https://advantage.kentico.com/\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico Advantage</a> walks you through all phases of delivering a successful web project. This resource leverages the collective experience of Kentico solution architects who identified best practices as well as difficulties for every stage of the project.</p>\n<h2>Get certified</h2>\n<p><a href=\"https://www.kentico.com/services/training/developer-certification\" data-new-window=\"true\" target=\"_blank\" rel=\"noopener noreferrer\">Kentico Certified Developer Exam</a> is designed to validate your ability to work with the Kentico platform. Please note that our developer training courses do not fully prepare you for the exam. Passing the exam requires not only knowing products features and functionality in theory, but it also requires practical experience and a high-level familiarity with the product itself. Therefore we recommend completing a project on Kentico before taking the exam.</p>","instruction":"","_layout":"full","_component":"textWithCode","_pageLevelProgress":{"_isEnabled":true},"_isOptional":false,"_classes":"","_id":"73554f53-621e-4f71-9eb0-33eebc8eec32","_parentId":"7be7e47e-0981-4399-a60c-1e3c3adeeb3a","_type":"component","title":"Conclusion","displayTitle":"Conclusion"}]